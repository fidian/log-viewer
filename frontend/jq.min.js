var gr=Object.create;var le=Object.defineProperty;var br=Object.getOwnPropertyDescriptor;var vr=Object.getOwnPropertyNames;var wr=Object.getPrototypeOf,$r=Object.prototype.hasOwnProperty;var xr=(t,e)=>()=>(t&&(e=t(t=0)),e);var _=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),_r=(t,e)=>{for(var r in e)le(t,r,{get:e[r],enumerable:!0})},it=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of vr(e))!$r.call(t,i)&&i!==r&&le(t,i,{get:()=>e[i],enumerable:!(n=br(e,i))||n.enumerable});return t};var Er=(t,e,r)=>(r=t!=null?gr(wr(t)):{},it(e||!t||!t.__esModule?le(r,"default",{value:t,enumerable:!0}):r,t)),kr=t=>it(le({},"__esModule",{value:!0}),t);var Ot={};_r(Ot,{__addDisposableResource:()=>kt,__assign:()=>ue,__asyncDelegator:()=>gt,__asyncGenerator:()=>yt,__asyncValues:()=>bt,__await:()=>G,__awaiter:()=>ct,__classPrivateFieldGet:()=>xt,__classPrivateFieldIn:()=>Et,__classPrivateFieldSet:()=>_t,__createBinding:()=>pe,__decorate:()=>at,__disposeResources:()=>It,__esDecorate:()=>Ir,__exportStar:()=>ft,__extends:()=>st,__generator:()=>pt,__importDefault:()=>$t,__importStar:()=>wt,__makeTemplateObject:()=>vt,__metadata:()=>ut,__param:()=>lt,__propKey:()=>jr,__read:()=>Ce,__rest:()=>ot,__runInitializers:()=>Or,__setFunctionName:()=>Pr,__spread:()=>ht,__spreadArray:()=>mt,__spreadArrays:()=>dt,__values:()=>ce,default:()=>qr});function st(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");De(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}function ot(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function at(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var d=t.length-1;d>=0;d--)(o=t[d])&&(s=(i<3?o(s):i>3?o(e,r,s):o(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function lt(t,e){return function(r,n){e(r,n,t)}}function Ir(t,e,r,n,i,s){function o(V){if(V!==void 0&&typeof V!="function")throw new TypeError("Function expected");return V}for(var d=n.kind,w=d==="getter"?"get":d==="setter"?"set":"value",a=!e&&t?n.static?t:t.prototype:null,c=e||(a?Object.getOwnPropertyDescriptor(a,n.name):{}),f,h=!1,g=r.length-1;g>=0;g--){var v={};for(var b in n)v[b]=b==="access"?{}:n[b];for(var b in n.access)v.access[b]=n.access[b];v.addInitializer=function(V){if(h)throw new TypeError("Cannot add initializers after decoration has completed");s.push(o(V||null))};var k=(0,r[g])(d==="accessor"?{get:c.get,set:c.set}:c[w],v);if(d==="accessor"){if(k===void 0)continue;if(k===null||typeof k!="object")throw new TypeError("Object expected");(f=o(k.get))&&(c.get=f),(f=o(k.set))&&(c.set=f),(f=o(k.init))&&i.unshift(f)}else(f=o(k))&&(d==="field"?i.unshift(f):c[w]=f)}a&&Object.defineProperty(a,n.name,c),h=!0}function Or(t,e,r){for(var n=arguments.length>2,i=0;i<e.length;i++)r=n?e[i].call(t,r):e[i].call(t);return n?r:void 0}function jr(t){return typeof t=="symbol"?t:"".concat(t)}function Pr(t,e,r){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(t,"name",{configurable:!0,value:r?"".concat(r," ",e):e})}function ut(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function ct(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function d(c){try{a(n.next(c))}catch(f){o(f)}}function w(c){try{a(n.throw(c))}catch(f){o(f)}}function a(c){c.done?s(c.value):i(c.value).then(d,w)}a((n=n.apply(t,e||[])).next())})}function pt(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,o;return o={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function d(a){return function(c){return w([a,c])}}function w(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(r=0)),r;)try{if(n=1,i&&(s=a[0]&2?i.return:a[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,a[1])).done)return s;switch(i=0,s&&(a=[a[0]&2,s.value]),a[0]){case 0:case 1:s=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,i=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!s||a[1]>s[0]&&a[1]<s[3])){r.label=a[1];break}if(a[0]===6&&r.label<s[1]){r.label=s[1],s=a;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(a);break}s[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],i=0}finally{n=s=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}}function ft(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&pe(e,t,r)}function ce(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ce(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(d){o={error:d}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s}function ht(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Ce(arguments[e]));return t}function dt(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],o=0,d=s.length;o<d;o++,i++)n[i]=s[o];return n}function mt(t,e,r){if(r||arguments.length===2)for(var n=0,i=e.length,s;n<i;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))}function G(t){return this instanceof G?(this.v=t,this):new G(t)}function yt(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(h){n[h]&&(i[h]=function(g){return new Promise(function(v,b){s.push([h,g,v,b])>1||d(h,g)})})}function d(h,g){try{w(n[h](g))}catch(v){f(s[0][3],v)}}function w(h){h.value instanceof G?Promise.resolve(h.value.v).then(a,c):f(s[0][2],h)}function a(h){d("next",h)}function c(h){d("throw",h)}function f(h,g){h(g),s.shift(),s.length&&d(s[0][0],s[0][1])}}function gt(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(o){return(r=!r)?{value:G(t[i](o)),done:!1}:s?s(o):o}:s}}function bt(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof ce=="function"?ce(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(o){return new Promise(function(d,w){o=t[s](o),i(d,w,o.done,o.value)})}}function i(s,o,d,w){Promise.resolve(w).then(function(a){s({value:a,done:d})},o)}}function vt(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function wt(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&pe(e,t,r);return Sr(e,t),e}function $t(t){return t&&t.__esModule?t:{default:t}}function xt(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)}function _t(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r}function Et(t,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof t=="function"?e===t:t.has(e)}function kt(t,e,r){if(e!=null){if(typeof e!="object")throw new TypeError("Object expected.");var n;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=e[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=e[Symbol.dispose]}if(typeof n!="function")throw new TypeError("Object not disposable.");t.stack.push({value:e,dispose:n,async:r})}else r&&t.stack.push({async:!0});return e}function It(t){function e(n){t.error=t.hasError?new Tr(n,t.error,"An error was suppressed during disposal."):n,t.hasError=!0}function r(){for(;t.stack.length;){var n=t.stack.pop();try{var i=n.dispose&&n.dispose.call(n.value);if(n.async)return Promise.resolve(i).then(r,function(s){return e(s),r()})}catch(s){e(s)}}if(t.hasError)throw t.error}return r()}var De,ue,pe,Sr,Tr,qr,jt=xr(()=>{De=function(t,e){return De=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},De(t,e)};ue=function(){return ue=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},ue.apply(this,arguments)};pe=Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]};Sr=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e};Tr=typeof SuppressedError=="function"?SuppressedError:function(t,e,r){var n=new Error(r);return n.name="SuppressedError",n.error=t,n.suppressed=e,n};qr={__extends:st,__assign:ue,__rest:ot,__decorate:at,__param:lt,__metadata:ut,__awaiter:ct,__generator:pt,__createBinding:pe,__exportStar:ft,__values:ce,__read:Ce,__spread:ht,__spreadArrays:dt,__spreadArray:mt,__await:G,__asyncGenerator:yt,__asyncDelegator:gt,__asyncValues:bt,__makeTemplateObject:vt,__importStar:wt,__importDefault:$t,__classPrivateFieldGet:xt,__classPrivateFieldSet:_t,__classPrivateFieldIn:Et,__addDisposableResource:kt,__disposeResources:It}});var St=_(Pt=>{"use strict";Object.defineProperty(Pt,"__esModule",{value:!0})});var P=_(I=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0});I.NotImplementedError=I.JqArgumentError=I.JqEvaluateError=I.JqPrintError=I.JqParseError=I.JqError=void 0;var Z=class extends Error{};I.JqError=Z;var Fe=class extends Z{};I.JqParseError=Fe;var Me=class extends Z{};I.JqPrintError=Me;var ee=class extends Z{};I.JqEvaluateError=ee;var Be=class extends ee{};I.JqArgumentError=Be;var Ve=class extends ee{};I.NotImplementedError=Ve});var Tt=_(fe=>{"use strict";Object.defineProperty(fe,"__esModule",{value:!0});fe.Tokenizer=void 0;var J=class t{constructor(e){this.input=e,this.current=null,this.interpolationContexts=[]}next(){let e=this.current;return this.current=null,e||this.readNext()}peek(){return this.current||(this.current=this.readNext())}eof(){return this.peek()===null}croak(e){return this.input.restore(),this.input.croak(e)}toArray(){let e=[];for(;!this.eof();)e.push(this.next());return e}readNext(){if(this.readWhile(t.isWhitespace),this.input.snapshot(),this.input.eof())return null;let e=this.input.peek();if(this.interpolationContextJustExited())return this.interpolationContexts.pop(),this.readString();if(e==="#")return this.skipComment(),this.readNext();if(t.isDigit(e))return this.readNumber();if(e=='"')return this.input.next(),this.readString();if(t.isIdentStart(e))return this.readIdent();if(t.isPuncChar(e))return this.readPunc();if(t.isOpChar(e))return this.readOp();throw this.croak(`Can't handle character: ${e}`)}readWhile(e){let r="";for(;!this.input.eof()&&e(this.input.peek());)r+=this.input.next();return r}skipComment(){this.readWhile(e=>e!==`
`)}readIdent(){let e=this.readWhile(t.isIdentChar);return e==="null"?{type:"null",value:null}:e==="true"?{type:"bool",value:!0}:e==="false"?{type:"bool",value:!1}:{type:t.keywords.has(e)?"kw":e.charAt(0)==="@"?"format":e.charAt(0)==="$"?"var":"ident",value:e}}interpolationContextJustExited(){return this.interpolationContexts[this.interpolationContexts.length-1]===0}updateInterpolationContext(e){let r=this.interpolationContexts.length;r!==0&&(e==="("?this.interpolationContexts[r-1]++:e===")"&&this.interpolationContexts[r-1]--)}readPunc(){let e=this.input.next();if(e=="\\"){if(this.input.peek()!=="(")throw this.croak(`Can't handle character: ${this.input.peek()}`);e+=this.input.next(),this.interpolationContexts.push(1)}else this.updateInterpolationContext(e);return{type:"punc",value:e}}readOp(){let e=this.input.next();return t.operators.has(e+this.input.peek()+this.input.peek(1))?e+=this.input.next()+this.input.next():t.operators.has(e+this.input.peek())&&(e+=this.input.next()),{type:"op",value:e}}readString(){let e=!1,r="";for(;!this.input.eof()&&!(this.input.peek()=="\\"&&this.input.peek(1)==="(");){let n=this.input.next();if(e)r+=this.getEscaped(n);else if(n=="\\")e=!0;else{if(n=='"')break;r+=n}}return{type:"str",value:r}}readNumber(){let e=!1;return{type:"num",value:Number(this.readWhile(r=>r==="."?e?!1:(e=!0,!0):t.isDigit(r)))}}static isWhitespace(e){return` 	
`.indexOf(e)>=0}static isOpChar(e){return".=!|+-*/%?<>,".indexOf(e)>=0}static isPuncChar(e){return"()[]{}:;\\".indexOf(e)>=0}static isDigit(e){return/[0-9]/.test(e)}static isIdentStart(e){return/[a-zA-Z@$_]/.test(e)}static isIdentChar(e){return t.isIdentStart(e)||/[0-9]/.test(e)}getEscaped(e){let r=e;if(!t.escapeCharacters[r])throw this.croak(`Can't parse an escape character: ${e}`);return t.escapeCharacters[r]}static stringifyTokenType(e){return this.tokenTypeToString[e]}static stringifyToken(e){return e===null?"EOF":["null","bool","value"].includes(e.type)?`${this.tokenTypeToString[e.type]}: ${e.value}`:`${this.tokenTypeToString[e.type]}: "${e.value}"`}};fe.Tokenizer=J;J.tokenTypeToString={punc:"punctuation",op:"operator",ident:"identifier",kw:"keyword",format:"format",var:"variable",str:"string",null:"null",bool:"boolean",num:"number"};J.escapeCharacters={b:"\b",f:"\f",n:`
`,r:"\r",t:"	",v:"\v","'":"'",'"':'"',"\\":"\\"};J.keywords=new Set(["__loc__","and","as","break","catch","def","elif","else","end","foreach","if","import","include","label","module","modulemeta","not","or","reduce","then","try"]);J.operators=new Set(["!=","%","%=","*","*=","+","+=",",","-","-=",".","..","/","//","//=","/=","<","<=","=","==",">",">=","?","?//","|","|="])});var qt=_(he=>{"use strict";Object.defineProperty(he,"__esModule",{value:!0});he.InputStream=void 0;var Ar=P(),Je=class{constructor(e){this.input=e,this.state={pos:0,line:1,col:0,lineStart:0},this.prev={pos:0,line:1,col:0,lineStart:0}}next(){let e=this.input.charAt(this.state.pos++);return e==`
`?(this.state.line++,this.state.col=0,this.state.lineStart=this.state.pos):this.state.col++,e}peek(e=0){return this.input.charAt(this.state.pos+e)}eof(){return this.peek()==""}croak(e){return new Ar.JqParseError(`${e} (${this.state.line}:${this.state.col})

${this.getLine()}
${this.getErrorPointer()}`)}snapshot(){this.prev=Object.assign({},this.state)}restore(){this.state=Object.assign({},this.prev)}getLine(){let e=0;for(;![`
`,""].includes(this.input.charAt(this.state.pos+e));)e++;return this.input.substring(this.state.lineStart,this.state.pos+e)}getErrorPointer(){let e="";for(let r=0;r<this.state.col;r++)e+="-";return e+="^",e}};he.InputStream=Je});var K=_(X=>{"use strict";Object.defineProperty(X,"__esModule",{value:!0});X.parse=X.Parser=void 0;var te=Tt(),Nr=qt(),re=class t{constructor(e){this.input=e}static getPrecedence(e){return t.precedence[e]}static normalizeBinaryAst(e){return e.right.type==="binary"&&this.getPrecedence(e.operator)===this.getPrecedence(e.right.operator)?this.normalizeBinaryAst({type:"binary",left:this.normalizeBinaryAst({type:"binary",left:e.left,operator:e.operator,right:e.right.left}),operator:e.right.operator,right:e.right.right.type==="binary"?this.normalizeBinaryAst(e.right.right):e.right.right}):e}static getFilterName(e,r){return`${e}/${r}`}static getFilterIdent(e){return e.split("/")[0]}static getFilterArity(e){return Number(e.split("/")[1])}parse(){return this.parseTopLevel()}unexpected(){return this.input.croak(`Unexpected ${te.Tokenizer.stringifyToken(this.input.peek())}`)}expected(e,r){let n=this.input.peek();return this.input.croak(`Expected ${r?te.Tokenizer.stringifyToken({type:e,value:r}):te.Tokenizer.stringifyTokenType(e)}, received ${te.Tokenizer.stringifyToken(n)}`)}is(e,r){let n=this.input.peek();return(n&&n.type===e&&(!r||r===n.value)||null)&&n}skip(e,r){if(this.is(e,r))return this.input.next();throw this.expected(e,r)}isKw(e){return this.is("kw",e)}isVar(e){return this.is("var",e)}isIdent(e){return this.is("ident",e)}isFormat(e){return this.is("format",e)}isPunc(e){return this.is("punc",e)}isOp(e){return this.is("op",e)}isBool(e){return this.is("bool",e)}isStr(e){return this.is("str",e)}isNum(e){return this.is("num",e)}isNull(){return this.is("null")}skipPunc(e){return this.skip("punc",e)}skipKw(e){return this.skip("kw",e)}skipVar(e){return this.skip("var",e)}skipFormat(e){return this.skip("format",e)}skipIdent(e){return this.skip("ident",e)}skipOp(e){return this.skip("op",e)}skipBool(e){return this.skip("bool",e)}skipStr(e){return this.skip("str",e)}skipNum(e){return this.skip("num",e)}skipNull(){return this.skip("null")}parseTopLevel(){let e;if(this.input.eof()||(e=this.parseExpression()),!this.input.eof())throw this.unexpected();return{type:"root",expr:e}}parseDef(){this.skipKw("def");let e=this.skipIdent().value,r=this.isPunc("(")?this.delimited("(",")",";",()=>this.parseArgName()):[],n=t.getFilterName(e,r.length);this.skipPunc(":");let i=this.parseExpression();this.skipPunc(";");let s={type:"def",name:n,args:r,body:i};return this.input.eof()||(s.next=this.parseExpression()),s}delimited(e,r,n,i,s=0,o,d){this.skipPunc(e);let w=[],a=!0,c=0;for(;(c<s||!this.input.eof()&&!this.isPunc(r)&&(!o||c<o))&&(a||(typeof n=="string"?this.skipPunc(n):this.skipOp(n.value)),!(d&&this.isPunc(r)));)w.push(i()),a=!1,c++;return d&&(typeof n=="string"?this.isPunc(n)&&this.skipPunc(n):this.isOp(n.value)&&this.skipOp(n.value)),this.skipPunc(r),w}parseArgName(){let e=this.input.next();switch(e?.type){case"ident":return{type:"filterArg",name:t.getFilterName(e.value,0)};case"var":return{type:"varArg",name:e.value}}throw this.input.croak("Expecting argument name")}parseExpression(e){return this.maybeBinary(this.parseAtomOrControlStructure(),0,e)}maybeShortTry(e){let r=e();if(this.isOp("?")){this.skipOp("?");let n={type:"try",short:!0,body:r};return this.atomMaybe(()=>n)}return r}parseAtomOrControlStructure(){return this.isKw("label")?this.parseLabel():this.isKw("break")?this.parseBreak():this.isKw("try")?this.parseTry():this.isKw("if")?this.parseIf():this.isKw("reduce")?this.parseReduce():this.isKw("foreach")?this.parseForeach():this.parseAtom(!0)}parseAtom(e){if(this.isKw("def"))return this.parseDef();if(this.isOp("-"))return{type:"unary",operator:this.skipOp("-").value,expr:this.parseAtomOrControlStructure()};let r=()=>this.atomMaybe(()=>{if(this.isPunc("(")){this.input.next();let n=this.parseExpression();return this.skipPunc(")"),n}if(this.isOp("."))return this.parseIdentity();if(this.isOp(".."))return this.parseRecursiveDescent();if(this.isPunc("["))return this.parseArray();if(this.isPunc("{"))return this.parseObject();if(this.isVar())return this.parseVar();if(this.isIdent()||this.isKw("not"))return this.parseFilter();if(this.isFormat())return this.parseFormat();if(this.isStr())return this.parseStr();if(this.isNum()||this.isBool()||this.isNull())return this.input.next();throw this.unexpected()});return e?this.maybeVariable(r):r()}maybeBinary(e,r=0,n=[]){let i=this.isOp()||this.isKw("and")||this.isKw("or");if(i&&!n.includes(i.value)){let s=t.getPrecedence(i.value);if(s>r)return this.input.next(),this.maybeBinary(t.normalizeBinaryAst({type:"binary",operator:i.value,left:e,right:this.maybeBinary(this.parseAtomOrControlStructure(),s,n)}),r,n)}return e}parseIdentity(){return this.skipOp("."),{type:"identity"}}parseRecursiveDescent(){return this.skipOp(".."),{type:"recursiveDescent"}}atomMaybe(e){return this.maybeShortTry(()=>this.maybeBracketIndex(()=>this.maybeSimpleIndex(e)))}maybeVariable(e){let r=e();if(this.isKw("as")){this.skipKw("as");let n=[this.parseDestructuring()];for(;this.isOp("?//");)this.skipOp("?//"),n.push(this.parseDestructuring());this.skipOp("|");let i=this.parseExpression();return{type:"varDeclaration",expr:r,destructuring:n,next:i}}return r}parseDestructuring(){return this.isPunc("[")?this.parseArrayDestructuring():this.isPunc("{")?this.parseObjectDestructuring():this.parseVar()}parseArrayDestructuring(){return{type:"arrayDestructuring",destructuring:this.delimited("[","]",{type:"op",value:","},()=>this.parseDestructuring())}}parseObjectDestructuring(){return{type:"objectDestructuring",entries:this.delimited("{","}",{type:"op",value:","},()=>{if(this.isVar())return{key:this.parseVar()};let e;return this.isIdent()?e=this.skipIdent().value:this.isPunc("(")?(this.skipPunc("("),e=this.parseExpression(),this.skipPunc(")")):e=this.parseStr(),this.skipPunc(":"),{key:e,destructuring:this.parseDestructuring()}})}}maybeBracketIndex(e){let r=e();if(this.isPunc("[")){let n;if(this.skipPunc("["),this.isPunc("]"))n={type:"iterator",expr:r};else{let i=this.isPunc(":")?void 0:this.parseExpression();if(this.isPunc(":")){this.skipPunc(":");let s=this.isPunc("]")?void 0:this.parseExpression();n={type:"slice",expr:r,from:i,to:s}}else n={type:"index",expr:r,index:i}}return this.skipPunc("]"),this.atomMaybe(()=>n)}return r}maybeSimpleIndex(e){let r=e();if(r.type!=="identity"&&this.isOp(".")&&this.skipOp("."),this.isStr()||this.isIdent()){let n={type:"index",expr:r,index:this.isStr()?this.parseStr():this.skipIdent().value};return this.atomMaybe(()=>n)}return r}parseVar(){return{type:"var",name:this.skipVar().value}}parseFilter(){let e=this.isKw("not")?this.skipKw().value:this.skipIdent().value,r=this.isPunc("(")?this.delimited("(",")",";",()=>this.parseExpression()):[];return{type:"filter",name:t.getFilterName(e,r.length),args:r}}parseFormat(){let r={type:"format",name:this.skipFormat().value};return this.isStr()?this.parseStr(r):r}parseArray(){if(this.skipPunc("["),this.isPunc("]"))return this.skipPunc("]"),{type:"array"};let e=this.parseExpression();return this.skipPunc("]"),{type:"array",expr:e}}parseObject(){return{type:"object",entries:this.delimited("{","}",{type:"op",value:","},()=>this.parseEntry(),void 0,void 0,!0)}}parseEntry(){let e;if(this.isIdent()||this.isKw()){if(e=this.isIdent()?this.skipIdent().value:this.skipKw().value,!this.isPunc(":"))return{key:e}}else if(this.isPunc("("))this.skipPunc("("),e=this.parseExpression(),this.skipPunc(")");else if(this.isStr())e=this.parseStr();else throw this.unexpected();this.skipPunc(":");let r=this.parseExpression([","]);return{key:e,value:r}}parseStr(e){let r=this.skipStr(),n;if(this.isPunc("\\(")){let i=[r.value];for(;this.isPunc("\\(");)i.push(this.parseInterpolation()),i.push(this.skipStr().value);n={type:"str",interpolated:!0,parts:i.filter(s=>s!=="")}}else n={type:"str",interpolated:!1,value:r.value};return e&&(n.format=e),n}parseInterpolation(){this.skipPunc("\\(");let e=this.parseExpression();return this.skipPunc(")"),e}parseIf(){this.skipKw("if");let e=this.parseExpression();this.skipKw("then");let r=this.parseExpression(),n=[];for(;this.isKw("elif");){this.skipKw("elif");let s=this.parseExpression();this.skipKw("then");let o=this.parseExpression();n.push({cond:s,then:o})}let i;return this.isKw("else")&&(this.skipKw("else"),i=this.parseExpression()),this.skipKw("end"),{type:"if",cond:e,then:r,elifs:n.length>0?n:void 0,else:i}}parseTry(){this.skipKw("try");let e=this.parseExpression(),r;return this.isKw("catch")&&(this.skipKw("catch"),r=this.parseExpression()),{type:"try",short:!1,body:e,catch:r}}parseLabel(){this.skipKw("label");let e=this.skipVar().value;this.skipOp("|");let r=this.parseExpression();return{type:"label",value:e,next:r}}parseBreak(){return this.skipKw("break"),{type:"break",value:this.skipVar().value}}parseReduce(){this.skipKw("reduce");let e=this.parseAtom(!1);this.skipKw("as");let r=this.skipVar().value,n=this.delimited("(",")",";",()=>this.parseExpression(),2,2);return{type:"reduce",expr:e,var:r,init:n[0],update:n[1]}}parseForeach(){this.skipKw("foreach");let e=this.parseAtom(!1);this.skipKw("as");let r=this.skipVar().value,n=this.delimited("(",")",";",()=>this.parseExpression(),2,3);return{type:"foreach",expr:e,var:r,init:n[0],update:n[1],extract:n[2]}}};X.Parser=re;re.precedence={"|":1,",":2,"//":3,"=":4,"|=":4,"+=":4,"-=":4,"*=":4,"/=":4,"%=":4,"//=":4,or:5,and:6,"==":7,"!=":7,"<":7,">":7,"<=":7,">=":7,"+":8,"-":8,"*":9,"/":9,"%":9,"?//":10};function Dr(t){return new re(new te.Tokenizer(new Nr.InputStream(t))).parse()}X.parse=Dr});var Ke=_(me=>{"use strict";Object.defineProperty(me,"__esModule",{value:!0});me.print=void 0;var z=K(),Cr=P();function Fr(t){return new de().root(t)}me.print=Fr;var de=class t{constructor(){this.indent=0}root(e){return e.expr?this.expression(e.expr,!1):""}def(e){return`def ${z.Parser.getFilterIdent(e.name)}${e.args.length>0?this.delimited("(",")","; ",e.args,r=>this.arg(r),!1):""}: ${this.expression(e.body,!1)};${e.next?" "+this.expression(e.next,!1):""}`}filterArg(e){return z.Parser.getFilterIdent(e.name)}varArg(e){return e.name}identity(e){return"."}num(e){return JSON.stringify(e.value)}str(e){let r=e.format?this.format(e.format)+" ":"";return e.interpolated?r+'"'+e.parts.map(n=>{if(typeof n=="string"){let i=JSON.stringify(n);return i.substring(1,i.length-1)}else return`\\(${this.expression(n)})`}).join("")+'"':r+JSON.stringify(e.value)}bool(e){return JSON.stringify(e.value)}null(e){return JSON.stringify(e.value)}format(e){return e.name}filter(e){return`${z.Parser.getFilterIdent(e.name)}${e.args.length>0?this.delimited("(",")",";",e.args,r=>this.expression(r,!1)):""}`}if(e){var r;return`if ${this.expression(e.cond)}${this.tab()}then ${this.expression(e.then)}${((r=e.elifs)!==null&&r!==void 0?r:[]).map(n=>{let i=`${this.br()}elif ${this.expression(n.cond)}${this.tab()}then ${this.expression(n.then)}`;return this.shiftTab(),i}).join("")}${e.else?`${this.br()}else ${this.expression(e.else)}`:""}${this.shiftTab()}end`}try(e){return e.short?`${this.expression(e.body)}?`:`try ${this.expression(e.body)}${e.catch?` catch ${this.expression(e.catch)}`:""}`}label(e){return`label ${e.value} | ${this.expression(e.next,!1)}`}break(e){return`break ${e.value}`}reduce(e){return`reduce ${this.expression(e.expr)} as ${e.var} (${this.tab()}${this.expression(e.init,!1)};${this.br()}${this.expression(e.update,!1)}${this.shiftTab()})`}foreach(e){return`foreach ${this.expression(e.expr)} as ${e.var} (${this.tab()}${this.expression(e.init,!1)};${this.br()}${this.expression(e.update,!1)}${e.extract?`;${this.br()}`+this.expression(e.extract,!1):""}${this.shiftTab()})`}binary(e){let r=this.expression(e.left,e.left.type==="binary"?z.Parser.getPrecedence(e.left.operator)<z.Parser.getPrecedence(e.operator):this.needsBrackets(e.left)),n=this.expression(e.right,e.right.type==="binary"?z.Parser.getPrecedence(e.right.operator)<z.Parser.getPrecedence(e.operator):this.needsBrackets(e.right));return`${r}${e.operator===","?"":" "}${e.operator} ${n}`}unary(e){return`${e.operator}${e.expr.type!=="num"?" ":""}${this.expression(e.expr)}`}index(e){return`${this.expression(e.expr)}${typeof e.index=="string"?`${e.expr.type==="identity"?"":"."}${e.index}`:`[${this.expression(e.index,!1)}]`}`}slice(e){return`${this.expression(e.expr)}[${e.from?this.expression(e.from,!1):""}:${e.to?this.expression(e.to,!1):""}]`}iterator(e){return`${this.expression(e.expr)}[]`}array(e){return`[${e.expr?this.expression(e.expr,!1):""}]`}object(e){return e.entries.length===0?"{}":`{${this.tab()}${this.delimited("","",`,${this.br()}`,e.entries,r=>this.objectEntry(r))},${this.shiftTab()}}`}var(e){return`${e.name}`}varDeclaration(e){return`${this.expression(e.expr,this.varDeclarationNeedsBrackets(e.expr))} as ${e.destructuring.map(r=>this.destructuring(r)).join(" ?// ")} | ${this.expression(e.next,!1)}`}arrayDestructuring(e){return this.delimited("[ "," ]",", ",e.destructuring,r=>this.destructuring(r))}objectDestructuring(e){return this.delimited("{ "," }",", ",e.entries,r=>this.objectDestructuringEntry(r),!1)}recursiveDescent(e){return".."}expression(e,r=this.needsBrackets(e)){switch(e.type){case"binary":return this.brackets(this.binary(e),r);default:return this.brackets(this.atom(e),r)}}atom(e){switch(e.type){case"def":return this.def(e);case"identity":return this.identity(e);case"num":return this.num(e);case"str":return this.str(e);case"bool":return this.bool(e);case"null":return this.null(e);case"format":return this.format(e);case"filter":return this.filter(e);case"if":return this.if(e);case"try":return this.try(e);case"reduce":return this.reduce(e);case"var":return this.var(e);case"varDeclaration":return this.varDeclaration(e);case"foreach":return this.foreach(e);case"label":return this.label(e);case"break":return this.break(e);case"unary":return this.unary(e);case"index":return this.index(e);case"slice":return this.slice(e);case"iterator":return this.iterator(e);case"array":return this.array(e);case"object":return this.object(e);case"recursiveDescent":return this.recursiveDescent(e);default:throw new Cr.JqPrintError(`Unknown ast node: ${e.type}`)}}delimited(e,r,n,i,s,o){return`${e}${i.map(s).join(n)}${o&&i.length>0?n:""}${r}`}arg(e){switch(e.type){case"filterArg":return this.filterArg(e);case"varArg":return this.varArg(e)}}objectEntry(e){return`${this.objectEntryKey(e.key)}${e.value?`: ${this.expression(e.value,this.objectValueNeedsBrackets(e.value))}`:""}`}objectDestructuringEntry(e){return e.destructuring===void 0?this.var(e.key):`${this.objectEntryKey(e.key)}: ${this.destructuring(e.destructuring)}`}objectEntryKey(e){return typeof e=="string"?e:this.expression(e,e.type!=="str")}destructuring(e){switch(e.type){case"var":return this.var(e);case"arrayDestructuring":return this.arrayDestructuring(e);case"objectDestructuring":return this.objectDestructuring(e)}}brackets(e,r){return r?`(${e})`:e}needsBrackets(e){let r=["identity","num","str","bool","null","format","filter","var","index","slice","iterator","array","object","recursiveDescent","unary","label","break","if","reduce","foreach"];return!(e.type==="try"&&e.short||r.includes(e.type))}objectValueNeedsBrackets(e){let r=["identity","num","str","bool","null","format","filter","var","index","slice","iterator","array","object","recursiveDescent"];return!(e.type==="try"&&e.short||(e.type==="unary"?e.expr.type==="num":r.includes(e.type)))}varDeclarationNeedsBrackets(e){let r=["identity","num","str","bool","null","format","filter","var","index","slice","iterator","array","object","recursiveDescent"];return!(e.type==="try"&&e.short||r.includes(e.type))}br(){let e=`
`;for(let r=0;r<this.indent;r++)e+=t.INDENT;return e}tab(){return this.indent++,this.br()}shiftTab(){return this.indent--,this.br()}};de.INDENT="  "});var At=_(ye=>{"use strict";Object.defineProperty(ye,"__esModule",{value:!0});ye.format=void 0;var Mr=K(),Br=Ke(),Vr=t=>(0,Br.print)((0,Mr.parse)(t));ye.format=Vr});var ne=_(T=>{"use strict";Object.defineProperty(T,"__esModule",{value:!0});T.cannotSliceError=T.cannotIndexError=T.notImplementedError=T.notDefinedError=void 0;var ge=P(),ze=A();function Jr(t){return new ge.JqEvaluateError(`'${t}' is not defined`)}T.notDefinedError=Jr;function Kr(t){return new ge.NotImplementedError(`Feature '${t}' is not implemented`)}T.notImplementedError=Kr;function zr(t,e){return new ge.JqEvaluateError(`Cannot index ${(0,ze.typeOf)(t)} with ${(0,ze.typeOf)(e)}`)}T.cannotIndexError=zr;function Rr(t){return new ge.JqEvaluateError(`Cannot slice ${(0,ze.typeOf)(t)}`)}T.cannotSliceError=Rr});var we=_(ve=>{"use strict";Object.defineProperty(ve,"__esModule",{value:!0});ve.compare=void 0;var F=A(),Nt={null:0,boolean:1,number:2,string:3,array:4,object:5};function Wr(t,e){return Nt[t]-Nt[e]}function be(t,e){var r,n;let i=(0,F.typeOf)(t),s=Wr(i,(0,F.typeOf)(e));if(s!==0)return s;switch(i){case F.Type.null:return 0;case F.Type.boolean:case F.Type.number:return t-e;case F.Type.string:for(let f=0;f<Math.max(t.length,e.length);f++){let h=(r=t.codePointAt(f))!==null&&r!==void 0?r:-1,g=(n=e.codePointAt(f))!==null&&n!==void 0?n:-1,v=h-g;if(v!==0)return v}return 0;case F.Type.array:for(let f=0;f<Math.max(t.length,e.length);f++){if(t[f]===void 0)return-1;if(e[f]===void 0)return 1;let h=be(t[f],e[f]);if(h!==0)return h}return 0;case F.Type.object:let o=Object.keys(t).sort(),d=Object.keys(e).sort(),w=be(o,d);if(w!==0)return w;let a=o.map(f=>t[f]),c=d.map(f=>e[f]);return be(a,c)}}ve.compare=be});var A=_(u=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});u.transformRegExpMatch=u.sort=u.has=u.keys=u.assertString=u.assertNumber=u.range=u.delPaths=u.getChildPaths=u.shallowClone=u.deepClone=u.deepMerge=u.resolveNormalizedSliceAccessor=u.normalizeLeadingSliceAccessors=u.normalizeSliceAccessor=u.normalizeArrayIndex=u.access=u.indices=u.toString=u.recursiveDescent=u.repeatString=u.isTrue=u.isPaths=u.isPath=u.many=u.single=u.someOfType=u.typeIsOneOf=u.typesMatchCommutative=u.typesMatch=u.typesEqual=u.isAtom=u.typeOf=u.Type=u.collectValues=u.generatePaths=u.generateValues=u.generateItems=u.createItem=u.isSliceAccessor=u.createSliceAccessor=void 0;var W=P(),Re=ne(),Dt=we();function Lr(t,e){return{start:t,end:e}}u.createSliceAccessor=Lr;function N(t){return t&&(t.start===null||Number.isInteger(t.start))&&(t.end===null||Number.isInteger(t.end))}u.isSliceAccessor=N;function Ct(t,e=[]){return{value:t,path:e}}u.createItem=Ct;function*Ur(t){for(let e of t)yield Ct(e)}u.generateItems=Ur;function*Ft(t){for(let e of t)yield e.value}u.generateValues=Ft;function*Gr(t){for(let e of t)yield e.path}u.generatePaths=Gr;function Zr(t){return Array.from(Ft(t))}u.collectValues=Zr;var y;(function(t){t.null="null",t.boolean="boolean",t.number="number",t.string="string",t.array="array",t.object="object"})(y=u.Type||(u.Type={}));function E(t){return Array.isArray(t)?y.array:t===null?y.null:typeof t}u.typeOf=E;function Xr(t){let e=E(t);return e!=="array"&&e!=="object"}u.isAtom=Xr;function Hr(t,e){return E(t)===E(e)}u.typesEqual=Hr;function D(t,e,r,n=r){return E(t)===r&&E(e)===n}u.typesMatch=D;function Yr(t,e,r,n){return D(t,e,r,n)||D(t,e,n,r)}u.typesMatchCommutative=Yr;function ie(t,...e){return e.some(r=>E(t)===r)}u.typeIsOneOf=ie;function Qr(t,...e){return e.some(r=>E(r)===t)}u.someOfType=Qr;function*en(t){yield t}u.single=en;function*tn(t){yield*t}u.many=tn;function Mt(t){return Array.isArray(t)&&t.every(e=>{switch(typeof e){case"string":return!0;case"number":return Number.isInteger(e);case"object":return N(e);default:return!1}})}u.isPath=Mt;function rn(t){return Array.isArray(t)&&t.every(e=>Mt(e))}u.isPaths=rn;function nn(t){return t!==null&&t!==!1}u.isTrue=nn;function sn(t,e){if(e<=0)return null;let r="";for(let n=0;n<Math.floor(e);n++)r+=t;return r}u.repeatString=sn;function*We(t){if(yield t,E(t)==="object")for(let e of Object.values(t))yield*We(e);else if(E(t)==="array")for(let e of t)yield*We(e)}u.recursiveDescent=We;function on(t){switch(E(t)){case y.null:return"null";case y.boolean:case y.number:return t.toString();case y.string:return t;case y.array:case y.object:return JSON.stringify(t)}}u.toString=on;function Bt(t,e){let r=[];for(let n=0;n<t.length;n++)for(let i=0;i<e.length&&(0,Dt.compare)(t[n+i],e[i])===0;i++)i+1===e.length&&r.push(n);return r}u.indices=Bt;function Vt(t,e){var r,n,i,s;if(D(e,t,y.number,y.array))return(r=t[$e(t.length,e)])!==null&&r!==void 0?r:null;if(D(e,t,y.string,y.object))return(n=t[e])!==null&&n!==void 0?n:null;if(D(e,t,y.array,y.array))return Bt(t,e);if(E(t)===y.null&&(ie(e,y.number,y.string)||N(e)))return null;if(ie(t,y.array,y.string)&&N(e))return t.slice((i=e.start)!==null&&i!==void 0?i:void 0,(s=e.end)!==null&&s!==void 0?s:void 0);throw N(e)?(0,Re.cannotSliceError)(t):(0,Re.cannotIndexError)(t,e)}u.access=Vt;function $e(t,e){return e<0?t+e:e}u.normalizeArrayIndex=$e;function xe(t,e){let{start:r,end:n}=e,i=Math.max(0,Math.min($e(t,n??t),t));return{start:Math.max(0,Math.min($e(t,r??0),i)),end:i}}u.normalizeSliceAccessor=xe;function Jt(t,e){if(!N(e[0]))return e;let r=1,n=xe(t,e[0]);for(;N(e[r]);){t=n.end-n.start;let i=xe(t,e[r]);n={start:n.start+i.start,end:n.start+i.end},r++}if(r<e.length){let i=e[r];if(typeof i!="number")throw(0,Re.cannotIndexError)([],i);return[n.start+i,...e.slice(r+1)]}else return[n]}u.normalizeLeadingSliceAccessors=Jt;function Kt(t){let e=[];for(let r=t.start;r<t.end;r++)e.push(r);return e}u.resolveNormalizedSliceAccessor=Kt;function zt(t,e){if(D(t,e,y.object,y.object)){let r=new Set(Object.keys(t).concat(Object.keys(e))),n=[];for(let i of r)n.push([i,zt(t[i],e[i])]);return Object.fromEntries(n)}else return e===void 0?t:e}u.deepMerge=zt;function Le(t){switch(E(t)){case y.null:case y.boolean:case y.number:case y.string:return t;case y.array:return t.map(Le);case y.object:return Object.fromEntries(Object.entries(t).map(Le))}}u.deepClone=Le;function Rt(t){switch(E(t)){case y.null:case y.boolean:case y.number:case y.string:return t;case y.array:return[...t];case y.object:return Object.assign({},t)}}u.shallowClone=Rt;function Wt(t){let e={};for(let r of t.filter(n=>n.length>1)){let n=r[0];if(N(n))throw new W.JqEvaluateError("getChildPaths: Cannot handle paths that are longer than 1, and start in a slice accessor");n in e||(e[n]=[]),e[n].push(r.slice(1))}return e}u.getChildPaths=Wt;function Lt(t,e){if(e.length===0)return t;let r=E(t);if(ie(t,y.array,y.object)){let n=Rt(t),i=e.map(s=>Jt(E(t)===y.array?t.length:0,s));for(let s of i){if(s.length!==1)continue;let o=s[0];if(Vt(n,o),N(o)){let d=xe(t.length,o);for(let w of Kt(d))delete n[w]}else delete n[o]}r===y.array&&(n=n.filter(s=>s!==void 0));for(let[s,o]of Object.entries(Wt(i)))s in n&&(n[s]=Lt(n[s],o));return n}else throw new W.JqEvaluateError(`Cannot delete fields from ${r}`)}u.delPaths=Lt;function*Ut(t,e,r){let n,i,s;e!==void 0&&r!==void 0?(n=R(t),i=R(e),s=R(r)):e!==void 0?(n=R(t),i=R(e),s=1):(n=0,i=R(t),s=1);for(let o=n;o<i;o+=s)yield o}u.range=Ut;function R(t){if(E(t)!==y.number)throw new W.JqEvaluateError(`Got ${E(t)}, number expected`);return t}u.assertNumber=R;function an(t){if(E(t)!==y.string)throw new W.JqEvaluateError(`Got ${E(t)}, string expected`);return t}u.assertString=an;function ln(t){if(!ie(t,y.array,y.object))throw new W.JqEvaluateError(`${E(t)} has no keys`);return E(t)===y.array?Array.from(Ut(t.length)):Object.keys(t)}u.keys=ln;function un(t,e){if(!D(t,e,y.array,y.number)&&!D(t,e,y.object,y.string))throw new W.JqEvaluateError(`Cannot check whether ${E(t)} has a ${E(e)} key`);return e in t}u.has=un;function cn(t){return t.sort(Dt.compare)}u.sort=cn;function pn(t){let e=t.indices;if(t.index===void 0||e===void 0)throw new W.JqEvaluateError("RegExp match item transformation error");return{offset:t.index,length:t[0].length,string:t[0],captures:t.slice(1).map((n,i)=>({offset:e[i+1][0],length:n.length,string:n,name:null}))}}u.transformRegExpMatch=pn});var Ue=_(_e=>{"use strict";Object.defineProperty(_e,"__esModule",{value:!0});_e.setPath=void 0;var S=A(),Gt=P();function Zt(t,e,r){if(e.length===0)return r;let n=(0,S.typeOf)(t),i=(0,S.normalizeLeadingSliceAccessors)(n===S.Type.array?t.length:0,e),s=i[0],o=t==null?(0,S.typeOf)(s)===S.Type.string?{}:[]:(0,S.shallowClone)(t);if((0,S.access)(o,s),i.length===1)if((0,S.isSliceAccessor)(s)){if((0,S.typeOf)(r)!==S.Type.array)throw new Gt.JqEvaluateError("An array slice can only be assigned an array");o.splice(s.start,s.end-s.start,...r)}else o[s]=r;else{if((0,S.isSliceAccessor)(s))throw new Gt.JqEvaluateError("setPath: Leading slice accessors are not normalized");o[s]=Zt(o[s],i.slice(1),r)}return o}_e.setPath=Zt});var Ht=_(H=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0});H.combineIterators=H.nestedIterators=void 0;function*Xt(t,e){let r=!0,n=[];for(let i of t){let s=r?e:n;yield[i,function*(){for(let o of s)r&&n.push(o),yield o}()],r=!1}}H.nestedIterators=Xt;function*fn(t,e){for(let[r,n]of Xt(t,e))for(let i of n)yield[r,i]}H.combineIterators=fn});var Ge=_(Ee=>{"use strict";Object.defineProperty(Ee,"__esModule",{value:!0});Ee.getPath=void 0;var M=A(),hn=P();function Yt(t,e){var r;if(e.length===0)return t;let n=(0,M.typeOf)(t),i=(0,M.normalizeLeadingSliceAccessors)(n===M.Type.array?t.length:0,e),s=i[0];if(t==null&&(t=(0,M.typeOf)(s)===M.Type.string?{}:[]),(0,M.access)(t,s),i.length===1)return(0,M.isSliceAccessor)(s)?t.slice(s.start,s.end):(r=t[s])!==null&&r!==void 0?r:null;if((0,M.isSliceAccessor)(s))throw new hn.JqEvaluateError("getPath: Leading slice accessors are not normalized");return Yt(t[s],i.slice(1))}Ee.getPath=Yt});var Ze=_(C=>{"use strict";Object.defineProperty(C,"__esModule",{value:!0});C.isBinaryOperatorType=C.typeOfBinaryOperator=C.BinaryOperatorType=void 0;var x;(function(t){t[t.normal=0]="normal",t[t.assignment=1]="assignment",t[t.boolean=2]="boolean",t[t.pipe=3]="pipe",t[t.comma=4]="comma",t[t.alternative=5]="alternative",t[t.destructuringAlternative=6]="destructuringAlternative"})(x=C.BinaryOperatorType||(C.BinaryOperatorType={}));var dn={"|":x.pipe,",":x.comma,"//":x.alternative,"=":x.assignment,"|=":x.assignment,"+=":x.assignment,"-=":x.assignment,"*=":x.assignment,"/=":x.assignment,"%=":x.assignment,"//=":x.assignment,or:x.boolean,and:x.boolean,"==":x.normal,"!=":x.normal,"<":x.normal,">":x.normal,"<=":x.normal,">=":x.normal,"+":x.normal,"-":x.normal,"*":x.normal,"/":x.normal,"%":x.normal,"?//":x.destructuringAlternative};function Qt(t){return dn[t]}C.typeOfBinaryOperator=Qt;function mn(t,e){return Qt(t)===e}C.isBinaryOperatorType=mn});var nr=_(O=>{"use strict";Object.defineProperty(O,"__esModule",{value:!0});O.evaluateAlternativeOperator=O.evaluateNormalBinaryOperator=O.evaluateBooleanOperator=O.evaluateArithmeticUpdateAssignment=O.evaluateSimpleAssignment=O.applyNormalBinaryOperator=void 0;var m=A(),L=we(),ke=P(),rr=Ue(),Xe=Ht(),yn=Ge(),er=Ze();function U(t,e,r){return new ke.JqEvaluateError(`Operator ${t} cannot be applied to ${(0,m.typeOf)(e)} and ${(0,m.typeOf)(r)}`)}function gn(t){return new ke.JqEvaluateError(`applyBinary: Cannot apply operator '${t}'`)}function tr(){return new ke.JqEvaluateError("Division by zero")}function He(t,e,r){switch(t){case"==":return(0,L.compare)(e,r)===0;case"!=":return(0,L.compare)(e,r)!==0;case"<":return(0,L.compare)(e,r)<0;case">":return(0,L.compare)(e,r)>0;case"<=":return(0,L.compare)(e,r)<=0;case">=":return(0,L.compare)(e,r)>=0;case"+":if((0,m.someOfType)(m.Type.null,e,r))return(0,m.typeOf)(e)===m.Type.null?r:e;if(!(0,m.typesEqual)(e,r))throw U(t,e,r);switch((0,m.typeOf)(e)){case m.Type.string:case m.Type.number:return e+r;case m.Type.array:return[...e,...r];case m.Type.object:return Object.assign(Object.assign({},e),r);default:throw U(t,e,r)}case"-":if(!(0,m.typesEqual)(e,r))throw U(t,e,r);switch((0,m.typeOf)(e)){case m.Type.number:return e-r;case m.Type.array:return e.filter(n=>!r.some(i=>(0,L.compare)(n,i)===0));default:throw U(t,e,r)}case"*":if((0,m.typesMatch)(e,r,m.Type.number))return e*r;if((0,m.typesMatchCommutative)(e,r,m.Type.string,m.Type.number)){let n=(0,m.typeOf)(e)===m.Type.string?e:r,i=(0,m.typeOf)(e)===m.Type.number?e:r;return(0,m.repeatString)(n,i)}else if((0,m.typesMatch)(e,r,m.Type.object))return(0,m.deepMerge)(e,r);throw U(t,e,r);case"/":if((0,m.typesMatch)(e,r,m.Type.number)){if(r===0)throw tr();return e/r}else if((0,m.typesMatch)(e,r,m.Type.string))return e.split(r);throw U(t,e,r);case"%":if((0,m.typesMatch)(e,r,m.Type.number)){if(Math.floor(r)===0)throw tr();return Math.floor(e)%Math.floor(r)}throw U(t,e,r);default:throw gn(t)}}O.applyNormalBinaryOperator=He;function*bn(t,e,r){for(let[n,i]of(0,Xe.nestedIterators)((0,m.generateValues)(r),(0,m.generatePaths)(e))){let s=t.value;for(let o of i)s=(0,rr.setPath)(s,o,(0,m.deepClone)(n));yield(0,m.createItem)(s)}}O.evaluateSimpleAssignment=bn;function*vn(t,e,r,n){for(let[i,s]of(0,Xe.nestedIterators)((0,m.generateValues)(n),(0,m.generatePaths)(r))){let o=e.value;for(let d of s){let w=t.slice(0,-1),a=(0,yn.getPath)(o,d);o=(0,rr.setPath)(o,d,(0,er.isBinaryOperatorType)(w,er.BinaryOperatorType.alternative)?xn(a,i):He(w,a,i))}yield(0,m.createItem)(o)}}O.evaluateArithmeticUpdateAssignment=vn;function*wn(t,e,r){if(t!=="and"&&t!=="or")throw new ke.JqEvaluateError(`evaluateBooleanOperator: Unexpected operator '${t}'`);let n=!0,i=[];for(let s of e){let o=n?r:i;if(t==="and"&&!(0,m.isTrue)(s.value)){yield(0,m.createItem)(!1);continue}else if(t==="or"&&(0,m.isTrue)(s.value)){yield(0,m.createItem)(!0);continue}for(let d of o)n&&i.push(d),yield(0,m.createItem)((0,m.isTrue)(d.value));n=!1}}O.evaluateBooleanOperator=wn;function*$n(t,e,r){for(let[n,i]of(0,Xe.combineIterators)(r,e))yield(0,m.createItem)(He(t,i.value,n.value))}O.evaluateNormalBinaryOperator=$n;function xn(t,e){return(0,m.isTrue)(t)?t:e}function*_n(t,e){let r=!1;for(let n of t)(0,m.isTrue)(n.value)&&(yield n,r=!0);r||(yield*e)}O.evaluateAlternativeOperator=_n});var Ye=_(Ie=>{"use strict";Object.defineProperty(Ie,"__esModule",{value:!0});Ie.generateCombinations=void 0;function*En(t){let e=t.map(r=>0);do yield kn(t,e);while(In(t,e))}Ie.generateCombinations=En;function kn(t,e){return e.map((r,n)=>t[n][r])}function In(t,e){for(let r=e.length-1;r>=0;r--){if(e[r]++,e[r]<t[r].length)return!0;e[r]=0}return!1}});var ir=_(Oe=>{"use strict";Object.defineProperty(Oe,"__esModule",{value:!0});Oe.generateObjects=void 0;var On=Ye();function*jn(t){let e=t.flat();for(let r of(0,On.generateCombinations)(e))yield Pn(r)}Oe.generateObjects=jn;function Pn(t){let e=t.reduce((r,n,i)=>(i%2===0?r.push([n]):r[r.length-1].push(n),r),[]);return Object.fromEntries(e)}});var or=_(je=>{"use strict";Object.defineProperty(je,"__esModule",{value:!0});je.applyFormat=void 0;var B=ne(),sr={"@text"(t){throw(0,B.notImplementedError)("@text")},"@json"(t){throw(0,B.notImplementedError)("@json")},"@html"(t){throw(0,B.notImplementedError)("@html")},"@uri"(t){throw(0,B.notImplementedError)("@uri")},"@csv"(t){throw(0,B.notImplementedError)("@csv")},"@tsv"(t){throw(0,B.notImplementedError)("@tsv")},"@sh"(t){throw(0,B.notImplementedError)("@sh")},"@base64"(t){return btoa(t)},"@base64d"(t){return atob(t)}};function Sn(t,e){if(t===void 0)return e;if(!sr[t.name])throw(0,B.notDefinedError)(t.name);return sr[t.name](e)}je.applyFormat=Sn});var Qe=_(Y=>{"use strict";Object.defineProperty(Y,"__esModule",{value:!0});Y.isNativeFilter=Y.wrapBareNativeFilters=void 0;var ar=A();function Tn(t){return Object.fromEntries(Object.entries(t).map(([e,r])=>[e,(n,...i)=>(0,ar.generateItems)(r(n.value,...(0,ar.collectValues)(i)))]))}Y.wrapBareNativeFilters=Tn;function qn(t){return typeof t=="function"}Y.isNativeFilter=qn});var lr=_(Se=>{"use strict";Object.defineProperty(Se,"__esModule",{value:!0});Se.builtinNativeFilters=void 0;var $=A(),An=Qe(),l=ne(),Pe=we(),Nn=et();Se.builtinNativeFilters=Object.assign({*"path/1"(t,e){yield(0,$.createItem)(e.path)}},(0,An.wrapBareNativeFilters)({*"_group_by_impl/1"(t,e){let r=t.map((o,d)=>({value:o,ref:e[d]})).sort((o,d)=>(0,Pe.compare)(o.ref,d.ref)),n=-1,i=[],s=[];for(let o of r)(n===-1||(0,Pe.compare)(i[n],o.ref))&&(i.push(o.ref),s.push([]),n++),s[n].push(o.value);yield s},*"_match_impl/3"(t,e,r,n){let i=(0,$.assertString)(t),s=new RegExp(e,(r??"")+"d");if(r&&r.includes("g")){let o=Array.from(i.matchAll(s));n?yield o.length!==0:yield o.map($.transformRegExpMatch)}else{let o=i.match(s);n?yield!!o:o&&(yield[(0,$.transformRegExpMatch)(o)])}},*"_max_by_impl/1"(){throw(0,l.notImplementedError)("_max_by_impl/1")},*"_min_by_impl/1"(){throw(0,l.notImplementedError)("_min_by_impl/1")},*"_sort_by_impl/1"(t,e){yield t.map((r,n)=>({item:r,ref:e[n]})).sort(Pe.compare).map(({item:r})=>r)},*"_strindices/1"(t,e){yield(0,$.indices)(t,e)},*"acos/0"(){throw(0,l.notImplementedError)("acos/0")},*"acosh/0"(){throw(0,l.notImplementedError)("acosh/0")},*"asin/0"(){throw(0,l.notImplementedError)("asin/0")},*"asinh/0"(){throw(0,l.notImplementedError)("asinh/0")},*"atan/0"(){throw(0,l.notImplementedError)("atan/0")},*"atan2/2"(){throw(0,l.notImplementedError)("atan2/2")},*"atanh/0"(){throw(0,l.notImplementedError)("atanh/0")},*"builtins/0"(){throw(0,l.notImplementedError)("builtins/0")},*"cbrt/0"(){throw(0,l.notImplementedError)("cbrt/0")},*"ceil/0"(){throw(0,l.notImplementedError)("ceil/0")},*"contains/1"(){throw(0,l.notImplementedError)("contains/1")},*"copysign/2"(){throw(0,l.notImplementedError)("copysign/2")},*"cos/0"(){throw(0,l.notImplementedError)("cos/0")},*"cosh/0"(){throw(0,l.notImplementedError)("cosh/0")},*"debug/0"(){throw(0,l.notImplementedError)("debug/0")},*"delpaths/1"(t,e){if(!(0,$.isPaths)(e))throw new Nn.JqArgumentError("Expected an array of paths");yield(0,$.delPaths)(t,e)},*"drem/2"(){throw(0,l.notImplementedError)("drem/2")},*"empty/0"(){},*"endswith/1"(t,e){(0,$.assertString)(t),(0,$.assertString)(e),yield t.endsWith(e)},*"env/0"(){throw(0,l.notImplementedError)("env/0")},*"erf/0"(){throw(0,l.notImplementedError)("erf/0")},*"erfc/0"(){throw(0,l.notImplementedError)("erfc/0")},*"error/0"(){throw(0,l.notImplementedError)("error/0")},*"exp/0"(){throw(0,l.notImplementedError)("exp/0")},*"exp10/0"(){throw(0,l.notImplementedError)("exp10/0")},*"exp2/0"(){throw(0,l.notImplementedError)("exp2/0")},*"explode/0"(){throw(0,l.notImplementedError)("explode/0")},*"expm1/0"(){throw(0,l.notImplementedError)("expm1/0")},*"fabs/0"(){throw(0,l.notImplementedError)("fabs/0")},*"fdim/2"(){throw(0,l.notImplementedError)("fdim/2")},*"floor/0"(){throw(0,l.notImplementedError)("floor/0")},*"fma/3"(){throw(0,l.notImplementedError)("fma/3")},*"fmax/2"(){throw(0,l.notImplementedError)("fmax/2")},*"fmin/2"(){throw(0,l.notImplementedError)("fmin/2")},*"fmod/2"(){throw(0,l.notImplementedError)("fmod/2")},*"format/1"(){throw(0,l.notImplementedError)("format/1")},*"frexp/0"(){throw(0,l.notImplementedError)("frexp/0")},*"fromjson/0"(){throw(0,l.notImplementedError)("fromjson/0")},*"gamma/0"(){throw(0,l.notImplementedError)("gamma/0")},*"get_jq_origin/0"(){throw(0,l.notImplementedError)("get_jq_origin/0")},*"get_prog_origin/0"(){throw(0,l.notImplementedError)("get_prog_origin/0")},*"get_search_list/0"(){throw(0,l.notImplementedError)("get_search_list/0")},*"getpath/1"(){throw(0,l.notImplementedError)("getpath/1")},*"gmtime/0"(){throw(0,l.notImplementedError)("gmtime/0")},*"halt/0"(){throw(0,l.notImplementedError)("halt/0")},*"halt_error/1"(){throw(0,l.notImplementedError)("halt_error/1")},*"has/1"(t,e){yield(0,$.has)(t,e)},*"hypot/2"(){throw(0,l.notImplementedError)("hypot/2")},*"implode/0"(){throw(0,l.notImplementedError)("implode/0")},*"infinite/0"(){throw(0,l.notImplementedError)("infinite/0")},*"input/0"(){throw(0,l.notImplementedError)("input/0")},*"input_filename/0"(){throw(0,l.notImplementedError)("input_filename/0")},*"input_line_number/0"(){throw(0,l.notImplementedError)("input_line_number/0")},*"isinfinite/0"(){throw(0,l.notImplementedError)("isinfinite/0")},*"isnan/0"(){throw(0,l.notImplementedError)("isnan/0")},*"isnormal/0"(){throw(0,l.notImplementedError)("isnormal/0")},*"j0/0"(){throw(0,l.notImplementedError)("j0/0")},*"j1/0"(){throw(0,l.notImplementedError)("j1/0")},*"jn/2"(){throw(0,l.notImplementedError)("jn/2")},*"keys/0"(t){yield(0,$.sort)((0,$.keys)(t))},*"keys_unsorted/0"(t){yield(0,$.keys)(t)},*"ldexp/2"(){throw(0,l.notImplementedError)("ldexp/2")},*"length/0"(t){let e=(0,$.typeOf)(t);switch((0,$.typeOf)(t)){case $.Type.null:yield 0;break;case $.Type.string:case $.Type.array:yield t.length;break;case $.Type.object:yield Object.keys(t).length;break;case $.Type.boolean:case $.Type.number:default:throw Error(`${e} has no length`)}},*"lgamma/0"(){throw(0,l.notImplementedError)("lgamma/0")},*"lgamma_r/0"(){throw(0,l.notImplementedError)("lgamma_r/0")},*"localtime/0"(){throw(0,l.notImplementedError)("localtime/0")},*"log/0"(){throw(0,l.notImplementedError)("log/0")},*"log10/0"(){throw(0,l.notImplementedError)("log10/0")},*"log1p/0"(){throw(0,l.notImplementedError)("log1p/0")},*"log2/0"(){throw(0,l.notImplementedError)("log2/0")},*"logb/0"(){throw(0,l.notImplementedError)("logb/0")},*"ltrimstr/1"(){throw(0,l.notImplementedError)("ltrimstr/1")},*"max/0"(){throw(0,l.notImplementedError)("max/0")},*"min/0"(){throw(0,l.notImplementedError)("min/0")},*"mktime/0"(){throw(0,l.notImplementedError)("mktime/0")},*"modf/0"(){throw(0,l.notImplementedError)("modf/0")},*"modulemeta/0"(){throw(0,l.notImplementedError)("modulemeta/0")},*"nan/0"(){throw(0,l.notImplementedError)("nan/0")},*"nearbyint/0"(){throw(0,l.notImplementedError)("nearbyint/0")},*"nextafter/2"(){throw(0,l.notImplementedError)("nextafter/2")},*"nexttoward/2"(){throw(0,l.notImplementedError)("nexttoward/2")},*"not/0"(t){yield!(0,$.isTrue)(t)},*"now/0"(){throw(0,l.notImplementedError)("now/0")},*"pow/2"(){throw(0,l.notImplementedError)("pow/2")},*"pow10/0"(){throw(0,l.notImplementedError)("pow10/0")},*"range/2"(t,e,r){yield*(0,$.range)(e,r)},*"remainder/2"(){throw(0,l.notImplementedError)("remainder/2")},*"rint/0"(){throw(0,l.notImplementedError)("rint/0")},*"round/0"(t){yield Math.round((0,$.assertNumber)(t))},*"rtrimstr/1"(){throw(0,l.notImplementedError)("rtrimstr/1")},*"scalars_or_empty/0"(){throw(0,l.notImplementedError)("scalars_or_empty/0")},*"scalb/2"(){throw(0,l.notImplementedError)("scalb/2")},*"scalbln/2"(){throw(0,l.notImplementedError)("scalbln/2")},*"setpath/2"(){throw(0,l.notImplementedError)("setpath/2")},*"significand/0"(){throw(0,l.notImplementedError)("significand/0")},*"sin/0"(){throw(0,l.notImplementedError)("sin/0")},*"sinh/0"(){throw(0,l.notImplementedError)("sinh/0")},*"sort/0"(t){yield t.sort(Pe.compare)},*"split/1"(t,e){yield(0,$.assertString)(t).split((0,$.assertString)(e))},*"sqrt/0"(){throw(0,l.notImplementedError)("sqrt/0")},*"startswith/1"(t,e){(0,$.assertString)(t),(0,$.assertString)(e),yield t.startsWith(e)},*"stderr/0"(){throw(0,l.notImplementedError)("stderr/0")},*"strflocaltime/1"(){throw(0,l.notImplementedError)("strflocaltime/1")},*"strftime/1"(){throw(0,l.notImplementedError)("strftime/1")},*"strptime/1"(){throw(0,l.notImplementedError)("strptime/1")},*"tan/0"(){throw(0,l.notImplementedError)("tan/0")},*"tanh/0"(){throw(0,l.notImplementedError)("tanh/0")},*"tgamma/0"(){throw(0,l.notImplementedError)("tgamma/0")},*"tojson/0"(){throw(0,l.notImplementedError)("tojson/0")},*"tonumber/0"(){throw(0,l.notImplementedError)("tonumber/0")},*"tostring/0"(t){yield(0,$.toString)(t)},*"trunc/0"(){throw(0,l.notImplementedError)("trunc/0")},*"type/0"(t){yield(0,$.typeOf)(t)},*"utf8bytelength/0"(){throw(0,l.notImplementedError)("utf8bytelength/0")},*"y0/0"(){throw(0,l.notImplementedError)("y0/0")},*"y1/0"(){throw(0,l.notImplementedError)("y1/0")},*"yn/2"(){throw(0,l.notImplementedError)("yn/2")}}))});var ur=_(Te=>{"use strict";Object.defineProperty(Te,"__esModule",{value:!0});Te.parseBuiltinJqFilters=void 0;var Dn=K(),Cn=P();function Fn(t){let e={},r=(0,Dn.parse)(t).expr;for(;r;){if(r.type!=="def")throw new Cn.JqEvaluateError("Could not parse the built-in jq filters");e[r.name]=r,r=r.next}return e}Te.parseBuiltinJqFilters=Fn});var cr=_(qe=>{"use strict";Object.defineProperty(qe,"__esModule",{value:!0});qe.builtinJqFilters=void 0;var Mn=ur();qe.builtinJqFilters=(0,Mn.parseBuiltinJqFilters)(`
def halt_error: halt_error(5);
def error(msg): msg|error;
def map(f): [.[] | f];
def select(f): if f then . else empty end;
def sort_by(f): _sort_by_impl(map([f]));
def group_by(f): _group_by_impl(map([f]));
def unique: group_by(.) | map(.[0]);
def unique_by(f): group_by(f) | map(.[0]);
def max_by(f): _max_by_impl(map([f]));
def min_by(f): _min_by_impl(map([f]));
def add: reduce .[] as $x (null; . + $x);
def del(f): delpaths([path(f)]);
def _assign(paths; $value): reduce path(paths) as $p (.; setpath($p; $value));
def _modify(paths; update):
    reduce path(paths) as $p (.;
        . as $dot
      | null
      | label $out
      | ($dot | getpath($p)) as $v
      | (
          (   $v
            | update
            | (., break $out) as $v
            | $dot
            | setpath($p; $v)
          ),
          (
              $dot
            | delpaths([$p])
          )
        )
    );
def map_values(f): .[] |= f;

# recurse
def recurse(f): def r: ., (f | r); r;
def recurse(f; cond): def r: ., (f | select(cond) | r); r;
def recurse: recurse(.[]?);
def recurse_down: recurse;

def to_entries: [keys_unsorted[] as $k | {key: $k, value: .[$k]}];
def from_entries: map({(.key // .Key // .name // .Name): (if has("value") then .value else .Value end)}) | add | .//={};
def with_entries(f): to_entries | map(f) | from_entries;
def reverse: [.[length - 1 - range(0;length)]];
def indices($i): if type == "array" and ($i|type) == "array" then .[$i]
  elif type == "array" then .[[$i]]
  elif type == "string" and ($i|type) == "string" then _strindices($i)
  else .[$i] end;
def index($i):   indices($i) | .[0];       # TODO: optimize
def rindex($i):  indices($i) | .[-1:][0];  # TODO: optimize
def paths: path(recurse(if (type|. == "array" or . == "object") then .[] else empty end))|select(length > 0);
def paths(node_filter): . as $dot|paths|select(. as $p|$dot|getpath($p)|node_filter);
def isfinite: type == "number" and (isinfinite | not);
def arrays: select(type == "array");
def objects: select(type == "object");
def iterables: select(type|. == "array" or . == "object");
def booleans: select(type == "boolean");
def numbers: select(type == "number");
def normals: select(isnormal);
def finites: select(isfinite);
def strings: select(type == "string");
def nulls: select(. == null);
def values: select(. != null);
def scalars: select(type|. != "array" and . != "object");
def leaf_paths: paths(scalars);
def join($x): reduce .[] as $i (null;
            (if .==null then "" else .+$x end) +
            ($i | if type=="boolean" or type=="number" then tostring else .//"" end)
        ) // "";
def _flatten($x): reduce .[] as $i ([]; if $i | type == "array" and $x != 0 then . + ($i | _flatten($x-1)) else . + [$i] end);
def flatten($x): if $x < 0 then error("flatten depth must not be negative") else _flatten($x) end;
def flatten: _flatten(-1);
def range($x): range(0;$x);
def fromdateiso8601: strptime("%Y-%m-%dT%H:%M:%SZ")|mktime;
def todateiso8601: strftime("%Y-%m-%dT%H:%M:%SZ");
def fromdate: fromdateiso8601;
def todate: todateiso8601;
def match(re; mode): _match_impl(re; mode; false)|.[];
def match($val): ($val|type) as $vt | if $vt == "string" then match($val; null)
   elif $vt == "array" and ($val | length) > 1 then match($val[0]; $val[1])
   elif $vt == "array" and ($val | length) > 0 then match($val[0]; null)
   else error( $vt + " not a string or array") end;
def test(re; mode): _match_impl(re; mode; true);
def test($val): ($val|type) as $vt | if $vt == "string" then test($val; null)
   elif $vt == "array" and ($val | length) > 1 then test($val[0]; $val[1])
   elif $vt == "array" and ($val | length) > 0 then test($val[0]; null)
   else error( $vt + " not a string or array") end;
def capture(re; mods): match(re; mods) | reduce ( .captures | .[] | select(.name != null) | { (.name) : .string } ) as $pair ({}; . + $pair);
def capture($val): ($val|type) as $vt | if $vt == "string" then capture($val; null)
   elif $vt == "array" and ($val | length) > 1 then capture($val[0]; $val[1])
   elif $vt == "array" and ($val | length) > 0 then capture($val[0]; null)
   else error( $vt + " not a string or array") end;
def scan(re):
  match(re; "g")
  |  if (.captures|length > 0)
      then [ .captures | .[] | .string ]
      else .string
      end ;
#
# If input is an array, then emit a stream of successive subarrays of length n (or less),
# and similarly for strings.
def _nwise(a; $n): if a|length <= $n then a else a[0:$n] , _nwise(a[$n:]; $n) end;
def _nwise($n): _nwise(.; $n);
#
# splits/1 produces a stream; split/1 is retained for backward compatibility.
def splits($re; flags): . as $s
#  # multiple occurrences of "g" are acceptable
  | [ match($re; "g" + flags) | (.offset, .offset + .length) ]
  | [0] + . +[$s|length]
  | _nwise(2)
  | $s[.[0]:.[1] ] ;
def splits($re): splits($re; null);
#
# split emits an array for backward compatibility
def split($re; flags): [ splits($re; flags) ];
#
# If s contains capture variables, then create a capture object and pipe it to s
def sub($re; s):
  . as $in
  | [match($re)]
  | if length == 0 then $in
    else .[0]
    | . as $r
#  # create the "capture" object:
    | reduce ( $r | .captures | .[] | select(.name != null) | { (.name) : .string } ) as $pair
        ({}; . + $pair)
    | $in[0:$r.offset] + s + $in[$r.offset+$r.length:]
    end ;
#
# If s contains capture variables, then create a capture object and pipe it to s
def sub($re; s; flags):
  def subg: [explode[] | select(. != 103)] | implode;
  # "fla" should be flags with all occurrences of g removed; gs should be non-nil if flags has a g
  def sub1(fla; gs):
    def mysub:
      . as $in
      | [match($re; fla)]
      | if length == 0 then $in
        else .[0] as $edit
        | ($edit | .offset + .length) as $len
        # create the "capture" object:
        | reduce ( $edit | .captures | .[] | select(.name != null) | { (.name) : .string } ) as $pair
            ({}; . + $pair)
        | $in[0:$edit.offset]
          + s
          + ($in[$len:] | if length > 0 and gs then mysub else . end)
        end ;
    mysub ;
    (flags | index("g")) as $gs
    | (flags | if $gs then subg else . end) as $fla
    | sub1($fla; $gs);
#
def sub($re; s): sub($re; s; "");
# repeated substitution of re (which may contain named captures)
def gsub($re; s; flags): sub($re; s; flags + "g");
def gsub($re; s): sub($re; s; "g");

########################################################################
# generic iterator/generator
def while(cond; update):
     def _while:
         if cond then ., (update | _while) else empty end;
     _while;
def until(cond; next):
     def _until:
         if cond then . else (next|_until) end;
     _until;
def limit($n; exp):
    if $n > 0 then label $out | foreach exp as $item ($n; .-1; $item, if . <= 0 then break $out else empty end)
    elif $n == 0 then empty
    else exp end;
# range/3, with a \`by\` expression argument
def range($init; $upto; $by):
    if $by > 0 then $init|while(. < $upto; . + $by)
  elif $by < 0 then $init|while(. > $upto; . + $by)
  else empty end;
def first(g): label $out | g | ., break $out;
def isempty(g): first((g|false), true);
def all(generator; condition): isempty(generator|condition and empty);
def any(generator; condition): isempty(generator|condition or empty)|not;
def all(condition): all(.[]; condition);
def any(condition): any(.[]; condition);
def all: all(.[]; .);
def any: any(.[]; .);
def last(g): reduce g as $item (null; $item);
def nth($n; g): if $n < 0 then error("nth doesn't support negative indices") else last(limit($n + 1; g)) end;
def first: .[0];
def last: .[-1];
def nth($n): .[$n];
def combinations:
    if length == 0 then [] else
        .[0][] as $x
          | (.[1:] | combinations) as $y
          | [$x] + $y
    end;
def combinations(n):
    . as $dot
      | [range(n) | $dot]
      | combinations;
# transpose a possibly jagged matrix, quickly;
# rows are padded with nulls so the result is always rectangular.
def transpose:
  if . == [] then []
  else . as $in
  | (map(length) | max) as $max
  | length as $length
  | reduce range(0; $max) as $j
      ([]; . + [reduce range(0;$length) as $i ([]; . + [ $in[$i][$j] ] )] )
  end;
def in(xs): . as $x | xs | has($x);
def inside(xs): . as $x | xs | contains($x);
def repeat(exp):
     def _repeat:
         exp, _repeat;
     _repeat;
def inputs: try repeat(input) catch if .=="break" then empty else error end;
# like ruby's downcase - only characters A to Z are affected
def ascii_downcase:
  explode | map( if 65 <= . and . <= 90 then . + 32  else . end) | implode;
# like ruby's upcase - only characters a to z are affected
def ascii_upcase:
  explode | map( if 97 <= . and . <= 122 then . - 32  else . end) | implode;

# Streaming utilities
def truncate_stream(stream):
  . as $n | null | stream | . as $input | if (.[0]|length) > $n then setpath([0];$input[0][$n:]) else empty end;
def fromstream(i): {x: null, e: false} as $init |
  # .x = object being built; .e = emit and reset state
  foreach i as $i ($init
  ; if .e then $init else . end
  | if $i|length == 2
    then setpath(["e"]; $i[0]|length==0) | setpath(["x"]+$i[0]; $i[1])
    else setpath(["e"]; $i[0]|length==1) end
  ; if .e then .x else empty end);
def tostream:
  path(def r: (.[]?|r), .; r) as $p |
  getpath($p) |
  reduce path(.[]?) as $q ([$p, .]; [$p+$q]);


# Assuming the input array is sorted, bsearch/1 returns
# the index of the target if the target is in the input array; and otherwise
#  (-1 - ix), where ix is the insertion point that would leave the array sorted.
# If the input is not sorted, bsearch will terminate but with irrelevant results.
def bsearch($target):
  if length == 0 then -1
  elif length == 1 then
     if $target == .[0] then 0 elif $target < .[0] then -1 else -2 end
  else . as $in
    # state variable: [start, end, answer]
    # where start and end are the upper and lower offsets to use.
    | [0, length-1, null]
    | until( .[0] > .[1] ;
             if .[2] != null then (.[1] = -1)               # i.e. break
             else
               ( ( (.[1] + .[0]) / 2 ) | floor ) as $mid
               | $in[$mid] as $monkey
               | if $monkey == $target  then (.[2] = $mid)   # success
                 elif .[0] == .[1]     then (.[1] = -1)     # failure
                 elif $monkey < $target then (.[0] = ($mid + 1))
                 else (.[1] = ($mid - 1))
                 end
             end )
    | if .[2] == null then          # compute the insertion point
         if $in[ .[0] ] < $target then (-2 -.[0])
         else (-1 -.[0])
         end
      else .[2]
      end
  end;

# Apply f to composite entities recursively, and to atoms
def walk(f):
  . as $in
  | if type == "object" then
      reduce keys_unsorted[] as $key
        ( {}; . + { ($key):  ($in[$key] | walk(f)) } ) | f
  elif type == "array" then map( walk(f) ) | f
  else f
  end;

# SQL-ish operators here:
def INDEX(stream; idx_expr):
  reduce stream as $row ({}; .[$row|idx_expr|tostring] = $row);
def INDEX(idx_expr): INDEX(.[]; idx_expr);
def JOIN($idx; idx_expr):
  [.[] | [., $idx[idx_expr]]];
def JOIN($idx; stream; idx_expr):
  stream | [., $idx[idx_expr]];
def JOIN($idx; stream; idx_expr; join_expr):
  stream | [., $idx[idx_expr]] | join_expr;
def IN(s): any(s == .; .);
def IN(src; s): any(src == s; .);
`)});var nt=_(Ae=>{"use strict";Object.defineProperty(Ae,"__esModule",{value:!0});Ae.evaluate=void 0;var se=nr(),p=A(),Bn=ir(),oe=Ye(),Q=P(),pr=or(),fr=lr(),Vn=K(),Jn=Qe(),tt=ne(),hr=cr(),Kn=Ue(),q=Ze(),zn=Ge();function Rn(t){let e=(0,p.isAtom)(t)?` "${t}"`:"";return new Q.JqEvaluateError(`${(0,p.typeOf)(t)}${e} is not iterable`)}function dr(){return new Q.JqEvaluateError("Array slice indices must be numbers")}var ae=class extends Q.JqEvaluateError{constructor(e){super(`Label ${e} is not defined`),this.value=e}};function*Wn(t,e){let r=new rt;yield*(0,p.generateValues)(r.evaluate(t.expr,(0,p.generateItems)(e)))}Ae.evaluate=Wn;var rt=class t{constructor(e=null){this.parent=e,this.vars=Object.create(this.parent?this.parent.vars:null)}extend(){return new t(this)}getVar(e){if(e in this.vars)return this.vars[e];if(e in hr.builtinJqFilters)return{scope:null,value:hr.builtinJqFilters[e]};if(e in fr.builtinNativeFilters)return{scope:null,value:fr.builtinNativeFilters[e]};throw(0,tt.notDefinedError)(e)}setVar(e,r,n=this){this.vars[e]={scope:n,value:r}}getVarValue(e){return this.getVar(e).value}evaluateConditions(e,r){return Array.from(this.evaluate(e,r)).map(n=>(0,p.isTrue)(n.value))}*evaluateForeach(e,r,n=!1){for(let i of r){let s=!0,o=[];for(let d of this.evaluate(e.init,(0,p.single)(i))){let w=d,a=s?this.evaluate(e.expr,(0,p.single)(i)):o;for(let c of a){let f=this.extend();f.setVar(e.var,c.value);let h=!0;for(let g of f.evaluate(e.update,(0,p.single)(w)))h=!1,w=g,n||(e.extract?yield*f.evaluate(e.extract,(0,p.single)(g)):yield g);h&&(w=(0,p.createItem)(null)),s&&o.push(c)}s=!1,n&&(yield w)}}}*evaluate(e,r){var n,i,s,o;if(e===void 0){yield*r;return}switch(e.type){case"identity":yield*r;break;case"binary":if(e.type==="binary"&&e.operator==="|"){yield*this.evaluate(e.right,this.evaluate(e.left,r));break}for(let a of r){let c=this.evaluate(e.left,(0,p.single)(a)),f=this.evaluate(e.right,(0,p.single)(a));if((0,q.isBinaryOperatorType)(e.operator,q.BinaryOperatorType.comma))yield*c,yield*f;else if((0,q.isBinaryOperatorType)(e.operator,q.BinaryOperatorType.normal))yield*(0,se.evaluateNormalBinaryOperator)(e.operator,c,f);else if((0,q.isBinaryOperatorType)(e.operator,q.BinaryOperatorType.boolean))yield*(0,se.evaluateBooleanOperator)(e.operator,c,f);else if((0,q.isBinaryOperatorType)(e.operator,q.BinaryOperatorType.alternative))yield*(0,se.evaluateAlternativeOperator)(c,f);else if((0,q.isBinaryOperatorType)(e.operator,q.BinaryOperatorType.assignment))if(e.operator==="|="){let h=a.value;for(let g of(0,p.generatePaths)(c)){let v;for(let b of this.evaluate(e.right,(0,p.single)((0,p.createItem)((0,zn.getPath)(a.value,g))))){v=(0,p.deepClone)(b.value);break}h=(0,Kn.setPath)(h,g,v)}yield(0,p.createItem)(h)}else e.operator==="="?yield*(0,se.evaluateSimpleAssignment)(a,c,f):yield*(0,se.evaluateArithmeticUpdateAssignment)(e.operator,a,c,f);else throw new Q.JqEvaluateError(`Unexpected operator ${e.operator}`)}break;case"def":{let a=this.extend();a.setVar(e.name,e),yield*a.evaluate(e.next,r);break}case"str":for(let a of r)if(e.interpolated){let c=e.parts.map(f=>typeof f=="string"?[f]:Array.from(this.evaluate(f,(0,p.single)(a))).map(h=>(0,pr.applyFormat)(e.format,(0,p.toString)(h.value)))).reverse();for(let f of(0,oe.generateCombinations)(c))yield(0,p.createItem)(f.reverse().join(""))}else yield(0,p.createItem)(e.value);break;case"num":case"bool":case"null":for(let a of r)yield(0,p.createItem)(e.value);break;case"format":for(let a of r)yield(0,p.createItem)((0,pr.applyFormat)(e,(0,p.toString)(a.value)));break;case"filter":for(let a of r){let c=Vn.Parser.getFilterArity(e.name),f=this.getVar(e.name);if((0,Jn.isNativeFilter)(f.value)){let h=[];for(let g=0;g<c;g++){let v=e.args[g];h.push(Array.from(this.evaluate(v,(0,p.single)(a))))}for(let g of(0,oe.generateCombinations)(h))yield*f.value(a,...g)}else{let h=[];for(let g=0;g<c;g++){let v=f.value.args[g],b=e.args[g];switch(v.type){case"varArg":h.push((0,p.collectValues)(this.evaluate(b,(0,p.single)(a))));break;case"filterArg":let k={type:"def",name:v.name,args:[],body:b};h.push([k]);break}}for(let g of(0,oe.generateCombinations)(h)){let v=(i=(n=f.scope)===null||n===void 0?void 0:n.extend())!==null&&i!==void 0?i:new t;for(let b=0;b<c;b++){let k=f.value.args[b];v.setVar(k.name,g[b],this)}yield*v.evaluate(f.value.body,(0,p.single)(a))}}}break;case"if":for(let a of r){let c=[this.evaluateConditions(e.cond,(0,p.single)(a))],f=[e.then];if(c[0].includes(!1)&&e.elifs){for(let b of e.elifs)if(c.push(this.evaluateConditions(b.cond,(0,p.single)(a))),f.push(b.then),!c[c.length-1].includes(!1))break}e.else&&f.push(e.else);let h=[],g=b=>f[b]?(h[b]||(h[b]=Array.from(this.evaluate(f[b],(0,p.single)(a)))),h[b]):[];function*v(b){if(c[b])for(let k of c[b])k?yield*g(b):yield*v(b+1);else yield*g(b)}yield*v(0)}break;case"try":for(let a of r)try{for(let c of this.evaluate(e.body,(0,p.single)(a)))yield c}catch(c){if(c instanceof ae)throw c;e.catch&&(yield*this.evaluate(e.catch,(0,p.single)((0,p.createItem)(c.message))))}break;case"reduce":yield*this.evaluateForeach(Object.assign(Object.assign({},e),{type:"foreach"}),r,!0);break;case"var":for(let a of r)yield(0,p.createItem)(this.getVarValue(e.name));break;case"varDeclaration":for(let a of r)for(let c of this.evaluate(e.expr,(0,p.single)(a))){let f=new Set(t.extractVariableNames(e.destructuring));for(let h=0;h<e.destructuring.length;h++){let g=e.destructuring[h];try{for(let v of this.destructureValue(c.value,g)){let b=this.extend();for(let k of f)b.setVar(k,null);for(let[k,V]of Object.entries(v))b.setVar(k,V);yield*b.evaluate(e.next,(0,p.single)(a))}break}catch(v){if(h+1>=e.destructuring.length)throw v}}}break;case"foreach":yield*this.evaluateForeach(e,r);break;case"label":try{yield*this.evaluate(e.next,r)}catch(a){if(a instanceof ae){if(a.value!==e.value)throw a;break}else throw a}break;case"break":throw new ae(e.value);case"unary":let{operator:d,type:w}=e;if(e.operator==="-"){for(let a of r)for(let c of this.evaluate(e.expr,(0,p.single)(a)))yield(0,p.createItem)(-c.value);break}throw(0,tt.notImplementedError)(`${w}:${d}`);case"index":for(let a of r)for(let c of this.evaluate(e.expr,(0,p.single)(a)))if(typeof e.index=="string")yield(0,p.createItem)((0,p.access)(c.value,e.index),[...c.path,e.index]);else for(let f of this.evaluate(e.index,(0,p.single)(a)))yield(0,p.createItem)((0,p.access)(c.value,f.value),[...c.path,f.value]);break;case"slice":for(let a of r){let c=e.from?Array.from(this.evaluate(e.from,(0,p.single)(a))):[void 0],f=e.to?Array.from(this.evaluate(e.to,(0,p.single)(a))):[void 0];for(let h of this.evaluate(e.expr,(0,p.single)(a))){if(!(0,p.typeIsOneOf)(h.value,p.Type.array,p.Type.string,p.Type.null))throw(0,tt.cannotSliceError)(h.value);for(let g of c){if(g!==void 0&&(0,p.typeOf)(g.value)!==p.Type.number)throw dr();for(let v of f){if(v!==void 0&&(0,p.typeOf)(v.value)!==p.Type.number)throw dr();let b=(0,p.createSliceAccessor)((s=g?.value)!==null&&s!==void 0?s:null,(o=v?.value)!==null&&o!==void 0?o:null);yield(0,p.createItem)((0,p.access)(h.value,b),[...h.path,b])}}}}break;case"iterator":for(let a of r)for(let c of this.evaluate(e.expr,(0,p.single)(a)))switch((0,p.typeOf)(c.value)){case"array":for(let f=0;f<c.value.length;f++)yield(0,p.createItem)(c.value[f],[...c.path,f]);break;case"object":for(let[f,h]of Object.entries(c.value))yield(0,p.createItem)(h,[...c.path,f]);break;default:throw Rn(c.value)}break;case"array":for(let a of r)e.expr?yield(0,p.createItem)((0,p.collectValues)(this.evaluate(e.expr,(0,p.single)(a)))):yield(0,p.createItem)([]);break;case"object":for(let a of r)yield*(0,p.generateItems)((0,Bn.generateObjects)(e.entries.map(({key:c,value:f})=>[typeof c=="string"?[c]:(0,p.collectValues)(this.evaluate(c,(0,p.single)(a))),f===void 0?[a.value[c]]:(0,p.collectValues)(this.evaluate(f,(0,p.single)(a)))])));break;case"recursiveDescent":for(let a of r)yield*(0,p.generateItems)((0,p.recursiveDescent)(a.value));break}}static*extractVariableNames(e){for(let r of e)switch(r.type){case"var":yield r.name;break;case"arrayDestructuring":{for(let n of r.destructuring)yield*t.extractVariableNames([n]);break}case"objectDestructuring":for(let n of r.entries)n.destructuring?yield*t.extractVariableNames([n.destructuring]):yield n.key.name;break}}*destructureValue(e,r){switch(r.type){case"var":yield{[r.name]:e};break;case"arrayDestructuring":{if((0,p.typeOf)(e)!=="array")throw new Q.JqEvaluateError(`${(0,p.typeOf)(e)} cannot be destructured as an array`);let i=r.destructuring.map((s,o)=>Array.from(this.destructureValue(e[o],r.destructuring[o])));for(let s of(0,oe.generateCombinations)(i))yield Object.assign({},...s);break}case"objectDestructuring":if((0,p.typeOf)(e)!=="object")throw new Q.JqEvaluateError(`${(0,p.typeOf)(e)} cannot be destructured as an object`);let n=r.entries.map(i=>{if(i.destructuring)return typeof i.key=="string"?Array.from(this.destructureValue(e[i.key],i.destructuring)):(0,p.collectValues)(this.evaluate(i.key,(0,p.single)((0,p.createItem)(e)))).map(o=>Array.from(this.destructureValue(e[o],i.destructuring))).flat();{let s=i.key.name,o=i.key.name.substring(1),d=e[o];return[{[s]:d}]}});for(let i of(0,oe.generateCombinations)(n))yield Object.assign({},...i.reverse());break}}}});var mr=_(Ne=>{"use strict";Object.defineProperty(Ne,"__esModule",{value:!0});Ne.jqTemplateTag=void 0;var Ln=K(),Un=nt();function Gn(t){let e=t.join(""),r=(0,Ln.parse)(e);return n=>(0,Un.evaluate)(r,n)}Ne.jqTemplateTag=Gn});var et=_(j=>{"use strict";Object.defineProperty(j,"__esModule",{value:!0});j.jq=j.evaluate=j.print=j.parse=j.format=void 0;var yr=(jt(),kr(Ot));yr.__exportStar(St(),j);yr.__exportStar(P(),j);var Zn=At();Object.defineProperty(j,"format",{enumerable:!0,get:function(){return Zn.format}});var Xn=K();Object.defineProperty(j,"parse",{enumerable:!0,get:function(){return Xn.parse}});var Hn=Ke();Object.defineProperty(j,"print",{enumerable:!0,get:function(){return Hn.print}});var Yn=nt();Object.defineProperty(j,"evaluate",{enumerable:!0,get:function(){return Yn.evaluate}});var Qn=mr();Object.defineProperty(j,"jq",{enumerable:!0,get:function(){return Qn.jqTemplateTag}})});var ei=Er(et());window.jq=ei;

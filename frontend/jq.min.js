var Bs=Object.create;var Xe=Object.defineProperty;var Vs=Object.getOwnPropertyDescriptor;var Js=Object.getOwnPropertyNames;var Ks=Object.getPrototypeOf,zs=Object.prototype.hasOwnProperty;var Rs=(t,e)=>()=>(t&&(e=t(t=0)),e);var E=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Ws=(t,e)=>{for(var r in e)Xe(t,r,{get:e[r],enumerable:!0})},Fr=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of Js(e))!zs.call(t,s)&&s!==r&&Xe(t,s,{get:()=>e[s],enumerable:!(n=Vs(e,s))||n.enumerable});return t};var Ls=(t,e,r)=>(r=t!=null?Bs(Ks(t)):{},Fr(e||!t||!t.__esModule?Xe(r,"default",{value:t,enumerable:!0}):r,t)),Mr=t=>Fr(Xe({},"__esModule",{value:!0}),t);var Zt={};Ws(Zt,{__addDisposableResource:()=>on,__assign:()=>He,__asyncDelegator:()=>Hr,__asyncGenerator:()=>Xr,__asyncValues:()=>Yr,__await:()=>Ee,__awaiter:()=>Rr,__classPrivateFieldGet:()=>rn,__classPrivateFieldIn:()=>sn,__classPrivateFieldSet:()=>nn,__createBinding:()=>Qe,__decorate:()=>Jr,__disposeResources:()=>an,__esDecorate:()=>Us,__exportStar:()=>Lr,__extends:()=>Br,__generator:()=>Wr,__importDefault:()=>tn,__importStar:()=>en,__makeTemplateObject:()=>Qr,__metadata:()=>zr,__param:()=>Kr,__propKey:()=>Gs,__read:()=>Ut,__rest:()=>Vr,__runInitializers:()=>Zs,__setFunctionName:()=>Xs,__spread:()=>Ur,__spreadArray:()=>Gr,__spreadArrays:()=>Zr,__values:()=>Ye,default:()=>Qs});function Br(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Lt(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}function Vr(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r}function Jr(t,e,r,n){var s=arguments.length,i=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(t,e,r,n);else for(var g=t.length-1;g>=0;g--)(o=t[g])&&(i=(s<3?o(i):s>3?o(e,r,i):o(e,r))||i);return s>3&&i&&Object.defineProperty(e,r,i),i}function Kr(t,e){return function(r,n){e(r,n,t)}}function Us(t,e,r,n,s,i){function o(Z){if(Z!==void 0&&typeof Z!="function")throw new TypeError("Function expected");return Z}for(var g=n.kind,_=g==="getter"?"get":g==="setter"?"set":"value",a=!e&&t?n.static?t:t.prototype:null,l=e||(a?Object.getOwnPropertyDescriptor(a,n.name):{}),u,f=!1,b=r.length-1;b>=0;b--){var w={};for(var v in n)w[v]=v==="access"?{}:n[v];for(var v in n.access)w.access[v]=n.access[v];w.addInitializer=function(Z){if(f)throw new TypeError("Cannot add initializers after decoration has completed");i.push(o(Z||null))};var P=(0,r[b])(g==="accessor"?{get:l.get,set:l.set}:l[_],w);if(g==="accessor"){if(P===void 0)continue;if(P===null||typeof P!="object")throw new TypeError("Object expected");(u=o(P.get))&&(l.get=u),(u=o(P.set))&&(l.set=u),(u=o(P.init))&&s.unshift(u)}else(u=o(P))&&(g==="field"?s.unshift(u):l[_]=u)}a&&Object.defineProperty(a,n.name,l),f=!0}function Zs(t,e,r){for(var n=arguments.length>2,s=0;s<e.length;s++)r=n?e[s].call(t,r):e[s].call(t);return n?r:void 0}function Gs(t){return typeof t=="symbol"?t:"".concat(t)}function Xs(t,e,r){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(t,"name",{configurable:!0,value:r?"".concat(r," ",e):e})}function zr(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Rr(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function g(l){try{a(n.next(l))}catch(u){o(u)}}function _(l){try{a(n.throw(l))}catch(u){o(u)}}function a(l){l.done?i(l.value):s(l.value).then(g,_)}a((n=n.apply(t,e||[])).next())})}function Wr(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function g(a){return function(l){return _([a,l])}}function _(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(r=0)),r;)try{if(n=1,s&&(i=a[0]&2?s.return:a[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,a[1])).done)return i;switch(s=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,s=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(l){a=[6,l],s=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}}function Lr(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&Qe(e,t,r)}function Ye(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ut(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),s,i=[],o;try{for(;(e===void 0||e-- >0)&&!(s=n.next()).done;)i.push(s.value)}catch(g){o={error:g}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return i}function Ur(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Ut(arguments[e]));return t}function Zr(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),s=0,e=0;e<r;e++)for(var i=arguments[e],o=0,g=i.length;o<g;o++,s++)n[s]=i[o];return n}function Gr(t,e,r){if(r||arguments.length===2)for(var n=0,s=e.length,i;n<s;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return t.concat(i||Array.prototype.slice.call(e))}function Ee(t){return this instanceof Ee?(this.v=t,this):new Ee(t)}function Xr(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),s,i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(f){n[f]&&(s[f]=function(b){return new Promise(function(w,v){i.push([f,b,w,v])>1||g(f,b)})})}function g(f,b){try{_(n[f](b))}catch(w){u(i[0][3],w)}}function _(f){f.value instanceof Ee?Promise.resolve(f.value.v).then(a,l):u(i[0][2],f)}function a(f){g("next",f)}function l(f){g("throw",f)}function u(f,b){f(b),i.shift(),i.length&&g(i[0][0],i[0][1])}}function Hr(t){var e,r;return e={},n("next"),n("throw",function(s){throw s}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(s,i){e[s]=t[s]?function(o){return(r=!r)?{value:Ee(t[s](o)),done:!1}:i?i(o):o}:i}}function Yr(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Ye=="function"?Ye(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(i){r[i]=t[i]&&function(o){return new Promise(function(g,_){o=t[i](o),s(g,_,o.done,o.value)})}}function s(i,o,g,_){Promise.resolve(_).then(function(a){i({value:a,done:g})},o)}}function Qr(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function en(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Qe(e,t,r);return Hs(e,t),e}function tn(t){return t&&t.__esModule?t:{default:t}}function rn(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)}function nn(t,e,r,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(t,r):s?s.value=r:e.set(t,r),r}function sn(t,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof t=="function"?e===t:t.has(e)}function on(t,e,r){if(e!=null){if(typeof e!="object")throw new TypeError("Object expected.");var n;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=e[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=e[Symbol.dispose]}if(typeof n!="function")throw new TypeError("Object not disposable.");t.stack.push({value:e,dispose:n,async:r})}else r&&t.stack.push({async:!0});return e}function an(t){function e(n){t.error=t.hasError?new Ys(n,t.error,"An error was suppressed during disposal."):n,t.hasError=!0}function r(){for(;t.stack.length;){var n=t.stack.pop();try{var s=n.dispose&&n.dispose.call(n.value);if(n.async)return Promise.resolve(s).then(r,function(i){return e(i),r()})}catch(i){e(i)}}if(t.hasError)throw t.error}return r()}var Lt,He,Qe,Hs,Ys,Qs,Gt=Rs(()=>{Lt=function(t,e){return Lt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(r[s]=n[s])},Lt(t,e)};He=function(){return He=Object.assign||function(e){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},He.apply(this,arguments)};Qe=Object.create?function(t,e,r,n){n===void 0&&(n=r);var s=Object.getOwnPropertyDescriptor(e,r);(!s||("get"in s?!e.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,s)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]};Hs=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e};Ys=typeof SuppressedError=="function"?SuppressedError:function(t,e,r){var n=new Error(r);return n.name="SuppressedError",n.error=t,n.suppressed=e,n};Qs={__extends:Br,__assign:He,__rest:Vr,__decorate:Jr,__param:Kr,__metadata:zr,__awaiter:Rr,__generator:Wr,__createBinding:Qe,__exportStar:Lr,__values:Ye,__read:Ut,__spread:Ur,__spreadArrays:Zr,__spreadArray:Gr,__await:Ee,__asyncGenerator:Xr,__asyncDelegator:Hr,__asyncValues:Yr,__makeTemplateObject:Qr,__importStar:en,__importDefault:tn,__classPrivateFieldGet:rn,__classPrivateFieldSet:nn,__classPrivateFieldIn:sn,__addDisposableResource:on,__disposeResources:an}});var un=E(ln=>{"use strict";Object.defineProperty(ln,"__esModule",{value:!0})});var V=E(N=>{"use strict";Object.defineProperty(N,"__esModule",{value:!0});N.NotImplementedError=N.JqArgumentError=N.JqEvaluateError=N.JqPrintError=N.JqParseError=N.JqError=void 0;var _e=class extends Error{};N.JqError=_e;var Xt=class extends _e{};N.JqParseError=Xt;var Ht=class extends _e{};N.JqPrintError=Ht;var Ne=class extends _e{};N.JqEvaluateError=Ne;var Yt=class extends Ne{};N.JqArgumentError=Yt;var Qt=class extends Ne{};N.NotImplementedError=Qt});var cn=E(et=>{"use strict";Object.defineProperty(et,"__esModule",{value:!0});et.Tokenizer=void 0;var ue=class t{constructor(e){this.input=e,this.current=null,this.interpolationContexts=[]}next(){let e=this.current;return this.current=null,e||this.readNext()}peek(){return this.current||(this.current=this.readNext())}eof(){return this.peek()===null}croak(e){return this.input.restore(),this.input.croak(e)}toArray(){let e=[];for(;!this.eof();)e.push(this.next());return e}readNext(){if(this.readWhile(t.isWhitespace),this.input.snapshot(),this.input.eof())return null;let e=this.input.peek();if(this.interpolationContextJustExited())return this.interpolationContexts.pop(),this.readString();if(e==="#")return this.skipComment(),this.readNext();if(t.isDigit(e))return this.readNumber();if(e=='"')return this.input.next(),this.readString();if(t.isIdentStart(e))return this.readIdent();if(t.isPuncChar(e))return this.readPunc();if(t.isOpChar(e))return this.readOp();throw this.croak(`Can't handle character: ${e}`)}readWhile(e){let r="";for(;!this.input.eof()&&e(this.input.peek());)r+=this.input.next();return r}skipComment(){this.readWhile(e=>e!==`
`)}readIdent(){let e=this.readWhile(t.isIdentChar);return e==="null"?{type:"null",value:null}:e==="true"?{type:"bool",value:!0}:e==="false"?{type:"bool",value:!1}:{type:t.keywords.has(e)?"kw":e.charAt(0)==="@"?"format":e.charAt(0)==="$"?"var":"ident",value:e}}interpolationContextJustExited(){return this.interpolationContexts[this.interpolationContexts.length-1]===0}updateInterpolationContext(e){let r=this.interpolationContexts.length;r!==0&&(e==="("?this.interpolationContexts[r-1]++:e===")"&&this.interpolationContexts[r-1]--)}readPunc(){let e=this.input.next();if(e=="\\"){if(this.input.peek()!=="(")throw this.croak(`Can't handle character: ${this.input.peek()}`);e+=this.input.next(),this.interpolationContexts.push(1)}else this.updateInterpolationContext(e);return{type:"punc",value:e}}readOp(){let e=this.input.next();return t.operators.has(e+this.input.peek()+this.input.peek(1))?e+=this.input.next()+this.input.next():t.operators.has(e+this.input.peek())&&(e+=this.input.next()),{type:"op",value:e}}readString(){let e=!1,r="";for(;!this.input.eof()&&!(this.input.peek()=="\\"&&this.input.peek(1)==="(");){let n=this.input.next();if(e)r+=this.getEscaped(n);else if(n=="\\")e=!0;else{if(n=='"')break;r+=n}}return{type:"str",value:r}}readNumber(){let e=!1;return{type:"num",value:Number(this.readWhile(r=>r==="."?e?!1:(e=!0,!0):t.isDigit(r)))}}static isWhitespace(e){return` 	
`.indexOf(e)>=0}static isOpChar(e){return".=!|+-*/%?<>,".indexOf(e)>=0}static isPuncChar(e){return"()[]{}:;\\".indexOf(e)>=0}static isDigit(e){return/[0-9]/.test(e)}static isIdentStart(e){return/[a-zA-Z@$_]/.test(e)}static isIdentChar(e){return t.isIdentStart(e)||/[0-9]/.test(e)}getEscaped(e){let r=e;if(!t.escapeCharacters[r])throw this.croak(`Can't parse an escape character: ${e}`);return t.escapeCharacters[r]}static stringifyTokenType(e){return this.tokenTypeToString[e]}static stringifyToken(e){return e===null?"EOF":["null","bool","value"].includes(e.type)?`${this.tokenTypeToString[e.type]}: ${e.value}`:`${this.tokenTypeToString[e.type]}: "${e.value}"`}};et.Tokenizer=ue;ue.tokenTypeToString={punc:"punctuation",op:"operator",ident:"identifier",kw:"keyword",format:"format",var:"variable",str:"string",null:"null",bool:"boolean",num:"number"};ue.escapeCharacters={b:"\b",f:"\f",n:`
`,r:"\r",t:"	",v:"\v","'":"'",'"':'"',"\\":"\\"};ue.keywords=new Set(["__loc__","and","as","break","catch","def","elif","else","end","foreach","if","import","include","label","module","modulemeta","not","or","reduce","then","try"]);ue.operators=new Set(["!=","%","%=","*","*=","+","+=",",","-","-=",".","..","/","//","//=","/=","<","<=","=","==",">",">=","?","?//","|","|="])});var pn=E(tt=>{"use strict";Object.defineProperty(tt,"__esModule",{value:!0});tt.InputStream=void 0;var ei=V(),er=class{constructor(e){this.input=e,this.state={pos:0,line:1,col:0,lineStart:0},this.prev={pos:0,line:1,col:0,lineStart:0}}next(){let e=this.input.charAt(this.state.pos++);return e==`
`?(this.state.line++,this.state.col=0,this.state.lineStart=this.state.pos):this.state.col++,e}peek(e=0){return this.input.charAt(this.state.pos+e)}eof(){return this.peek()==""}croak(e){return new ei.JqParseError(`${e} (${this.state.line}:${this.state.col})

${this.getLine()}
${this.getErrorPointer()}`)}snapshot(){this.prev=Object.assign({},this.state)}restore(){this.state=Object.assign({},this.prev)}getLine(){let e=0;for(;![`
`,""].includes(this.input.charAt(this.state.pos+e));)e++;return this.input.substring(this.state.lineStart,this.state.pos+e)}getErrorPointer(){let e="";for(let r=0;r<this.state.col;r++)e+="-";return e+="^",e}};tt.InputStream=er});var ce=E(ke=>{"use strict";Object.defineProperty(ke,"__esModule",{value:!0});ke.parse=ke.Parser=void 0;var Ce=cn(),ti=pn(),De=class t{constructor(e){this.input=e}static getPrecedence(e){return t.precedence[e]}static normalizeBinaryAst(e){return e.right.type==="binary"&&this.getPrecedence(e.operator)===this.getPrecedence(e.right.operator)?this.normalizeBinaryAst({type:"binary",left:this.normalizeBinaryAst({type:"binary",left:e.left,operator:e.operator,right:e.right.left}),operator:e.right.operator,right:e.right.right.type==="binary"?this.normalizeBinaryAst(e.right.right):e.right.right}):e}static getFilterName(e,r){return`${e}/${r}`}static getFilterIdent(e){return e.split("/")[0]}static getFilterArity(e){return Number(e.split("/")[1])}parse(){return this.parseTopLevel()}unexpected(){return this.input.croak(`Unexpected ${Ce.Tokenizer.stringifyToken(this.input.peek())}`)}expected(e,r){let n=this.input.peek();return this.input.croak(`Expected ${r?Ce.Tokenizer.stringifyToken({type:e,value:r}):Ce.Tokenizer.stringifyTokenType(e)}, received ${Ce.Tokenizer.stringifyToken(n)}`)}is(e,r){let n=this.input.peek();return(n&&n.type===e&&(!r||r===n.value)||null)&&n}skip(e,r){if(this.is(e,r))return this.input.next();throw this.expected(e,r)}isKw(e){return this.is("kw",e)}isVar(e){return this.is("var",e)}isIdent(e){return this.is("ident",e)}isFormat(e){return this.is("format",e)}isPunc(e){return this.is("punc",e)}isOp(e){return this.is("op",e)}isBool(e){return this.is("bool",e)}isStr(e){return this.is("str",e)}isNum(e){return this.is("num",e)}isNull(){return this.is("null")}skipPunc(e){return this.skip("punc",e)}skipKw(e){return this.skip("kw",e)}skipVar(e){return this.skip("var",e)}skipFormat(e){return this.skip("format",e)}skipIdent(e){return this.skip("ident",e)}skipOp(e){return this.skip("op",e)}skipBool(e){return this.skip("bool",e)}skipStr(e){return this.skip("str",e)}skipNum(e){return this.skip("num",e)}skipNull(){return this.skip("null")}parseTopLevel(){let e;if(this.input.eof()||(e=this.parseExpression()),!this.input.eof())throw this.unexpected();return{type:"root",expr:e}}parseDef(){this.skipKw("def");let e=this.skipIdent().value,r=this.isPunc("(")?this.delimited("(",")",";",()=>this.parseArgName()):[],n=t.getFilterName(e,r.length);this.skipPunc(":");let s=this.parseExpression();this.skipPunc(";");let i={type:"def",name:n,args:r,body:s};return this.input.eof()||(i.next=this.parseExpression()),i}delimited(e,r,n,s,i=0,o,g){this.skipPunc(e);let _=[],a=!0,l=0;for(;(l<i||!this.input.eof()&&!this.isPunc(r)&&(!o||l<o))&&(a||(typeof n=="string"?this.skipPunc(n):this.skipOp(n.value)),!(g&&this.isPunc(r)));)_.push(s()),a=!1,l++;return g&&(typeof n=="string"?this.isPunc(n)&&this.skipPunc(n):this.isOp(n.value)&&this.skipOp(n.value)),this.skipPunc(r),_}parseArgName(){let e=this.input.next();switch(e?.type){case"ident":return{type:"filterArg",name:t.getFilterName(e.value,0)};case"var":return{type:"varArg",name:e.value}}throw this.input.croak("Expecting argument name")}parseExpression(e){return this.maybeBinary(this.parseAtomOrControlStructure(),0,e)}maybeShortTry(e){let r=e();if(this.isOp("?")){this.skipOp("?");let n={type:"try",short:!0,body:r};return this.atomMaybe(()=>n)}return r}parseAtomOrControlStructure(){return this.isKw("label")?this.parseLabel():this.isKw("break")?this.parseBreak():this.isKw("try")?this.parseTry():this.isKw("if")?this.parseIf():this.isKw("reduce")?this.parseReduce():this.isKw("foreach")?this.parseForeach():this.parseAtom(!0)}parseAtom(e){if(this.isKw("def"))return this.parseDef();if(this.isOp("-"))return{type:"unary",operator:this.skipOp("-").value,expr:this.parseAtomOrControlStructure()};let r=()=>this.atomMaybe(()=>{if(this.isPunc("(")){this.input.next();let n=this.parseExpression();return this.skipPunc(")"),n}if(this.isOp("."))return this.parseIdentity();if(this.isOp(".."))return this.parseRecursiveDescent();if(this.isPunc("["))return this.parseArray();if(this.isPunc("{"))return this.parseObject();if(this.isVar())return this.parseVar();if(this.isIdent()||this.isKw("not"))return this.parseFilter();if(this.isFormat())return this.parseFormat();if(this.isStr())return this.parseStr();if(this.isNum()||this.isBool()||this.isNull())return this.input.next();throw this.unexpected()});return e?this.maybeVariable(r):r()}maybeBinary(e,r=0,n=[]){let s=this.isOp()||this.isKw("and")||this.isKw("or");if(s&&!n.includes(s.value)){let i=t.getPrecedence(s.value);if(i>r)return this.input.next(),this.maybeBinary(t.normalizeBinaryAst({type:"binary",operator:s.value,left:e,right:this.maybeBinary(this.parseAtomOrControlStructure(),i,n)}),r,n)}return e}parseIdentity(){return this.skipOp("."),{type:"identity"}}parseRecursiveDescent(){return this.skipOp(".."),{type:"recursiveDescent"}}atomMaybe(e){return this.maybeShortTry(()=>this.maybeBracketIndex(()=>this.maybeSimpleIndex(e)))}maybeVariable(e){let r=e();if(this.isKw("as")){this.skipKw("as");let n=[this.parseDestructuring()];for(;this.isOp("?//");)this.skipOp("?//"),n.push(this.parseDestructuring());this.skipOp("|");let s=this.parseExpression();return{type:"varDeclaration",expr:r,destructuring:n,next:s}}return r}parseDestructuring(){return this.isPunc("[")?this.parseArrayDestructuring():this.isPunc("{")?this.parseObjectDestructuring():this.parseVar()}parseArrayDestructuring(){return{type:"arrayDestructuring",destructuring:this.delimited("[","]",{type:"op",value:","},()=>this.parseDestructuring())}}parseObjectDestructuring(){return{type:"objectDestructuring",entries:this.delimited("{","}",{type:"op",value:","},()=>{if(this.isVar())return{key:this.parseVar()};let e;return this.isIdent()?e=this.skipIdent().value:this.isPunc("(")?(this.skipPunc("("),e=this.parseExpression(),this.skipPunc(")")):e=this.parseStr(),this.skipPunc(":"),{key:e,destructuring:this.parseDestructuring()}})}}maybeBracketIndex(e){let r=e();if(this.isPunc("[")){let n;if(this.skipPunc("["),this.isPunc("]"))n={type:"iterator",expr:r};else{let s=this.isPunc(":")?void 0:this.parseExpression();if(this.isPunc(":")){this.skipPunc(":");let i=this.isPunc("]")?void 0:this.parseExpression();n={type:"slice",expr:r,from:s,to:i}}else n={type:"index",expr:r,index:s}}return this.skipPunc("]"),this.atomMaybe(()=>n)}return r}maybeSimpleIndex(e){let r=e();if(r.type!=="identity"&&this.isOp(".")&&this.skipOp("."),this.isStr()||this.isIdent()){let n={type:"index",expr:r,index:this.isStr()?this.parseStr():this.skipIdent().value};return this.atomMaybe(()=>n)}return r}parseVar(){return{type:"var",name:this.skipVar().value}}parseFilter(){let e=this.isKw("not")?this.skipKw().value:this.skipIdent().value,r=this.isPunc("(")?this.delimited("(",")",";",()=>this.parseExpression()):[];return{type:"filter",name:t.getFilterName(e,r.length),args:r}}parseFormat(){let r={type:"format",name:this.skipFormat().value};return this.isStr()?this.parseStr(r):r}parseArray(){if(this.skipPunc("["),this.isPunc("]"))return this.skipPunc("]"),{type:"array"};let e=this.parseExpression();return this.skipPunc("]"),{type:"array",expr:e}}parseObject(){return{type:"object",entries:this.delimited("{","}",{type:"op",value:","},()=>this.parseEntry(),void 0,void 0,!0)}}parseEntry(){let e;if(this.isIdent()||this.isKw()){if(e=this.isIdent()?this.skipIdent().value:this.skipKw().value,!this.isPunc(":"))return{key:e}}else if(this.isPunc("("))this.skipPunc("("),e=this.parseExpression(),this.skipPunc(")");else if(this.isStr())e=this.parseStr();else throw this.unexpected();this.skipPunc(":");let r=this.parseExpression([","]);return{key:e,value:r}}parseStr(e){let r=this.skipStr(),n;if(this.isPunc("\\(")){let s=[r.value];for(;this.isPunc("\\(");)s.push(this.parseInterpolation()),s.push(this.skipStr().value);n={type:"str",interpolated:!0,parts:s.filter(i=>i!=="")}}else n={type:"str",interpolated:!1,value:r.value};return e&&(n.format=e),n}parseInterpolation(){this.skipPunc("\\(");let e=this.parseExpression();return this.skipPunc(")"),e}parseIf(){this.skipKw("if");let e=this.parseExpression();this.skipKw("then");let r=this.parseExpression(),n=[];for(;this.isKw("elif");){this.skipKw("elif");let i=this.parseExpression();this.skipKw("then");let o=this.parseExpression();n.push({cond:i,then:o})}let s;return this.isKw("else")&&(this.skipKw("else"),s=this.parseExpression()),this.skipKw("end"),{type:"if",cond:e,then:r,elifs:n.length>0?n:void 0,else:s}}parseTry(){this.skipKw("try");let e=this.parseExpression(),r;return this.isKw("catch")&&(this.skipKw("catch"),r=this.parseExpression()),{type:"try",short:!1,body:e,catch:r}}parseLabel(){this.skipKw("label");let e=this.skipVar().value;this.skipOp("|");let r=this.parseExpression();return{type:"label",value:e,next:r}}parseBreak(){return this.skipKw("break"),{type:"break",value:this.skipVar().value}}parseReduce(){this.skipKw("reduce");let e=this.parseAtom(!1);this.skipKw("as");let r=this.skipVar().value,n=this.delimited("(",")",";",()=>this.parseExpression(),2,2);return{type:"reduce",expr:e,var:r,init:n[0],update:n[1]}}parseForeach(){this.skipKw("foreach");let e=this.parseAtom(!1);this.skipKw("as");let r=this.skipVar().value,n=this.delimited("(",")",";",()=>this.parseExpression(),2,3);return{type:"foreach",expr:e,var:r,init:n[0],update:n[1],extract:n[2]}}};ke.Parser=De;De.precedence={"|":1,",":2,"//":3,"=":4,"|=":4,"+=":4,"-=":4,"*=":4,"/=":4,"%=":4,"//=":4,or:5,and:6,"==":7,"!=":7,"<":7,">":7,"<=":7,">=":7,"+":8,"-":8,"*":9,"/":9,"%":9,"?//":10};function ri(t){return new De(new Ce.Tokenizer(new ti.InputStream(t))).parse()}ke.parse=ri});var tr=E(nt=>{"use strict";Object.defineProperty(nt,"__esModule",{value:!0});nt.print=void 0;var pe=ce(),ni=V();function si(t){return new rt().root(t)}nt.print=si;var rt=class t{constructor(){this.indent=0}root(e){return e.expr?this.expression(e.expr,!1):""}def(e){return`def ${pe.Parser.getFilterIdent(e.name)}${e.args.length>0?this.delimited("(",")","; ",e.args,r=>this.arg(r),!1):""}: ${this.expression(e.body,!1)};${e.next?" "+this.expression(e.next,!1):""}`}filterArg(e){return pe.Parser.getFilterIdent(e.name)}varArg(e){return e.name}identity(e){return"."}num(e){return JSON.stringify(e.value)}str(e){let r=e.format?this.format(e.format)+" ":"";return e.interpolated?r+'"'+e.parts.map(n=>{if(typeof n=="string"){let s=JSON.stringify(n);return s.substring(1,s.length-1)}else return`\\(${this.expression(n)})`}).join("")+'"':r+JSON.stringify(e.value)}bool(e){return JSON.stringify(e.value)}null(e){return JSON.stringify(e.value)}format(e){return e.name}filter(e){return`${pe.Parser.getFilterIdent(e.name)}${e.args.length>0?this.delimited("(",")",";",e.args,r=>this.expression(r,!1)):""}`}if(e){var r;return`if ${this.expression(e.cond)}${this.tab()}then ${this.expression(e.then)}${((r=e.elifs)!==null&&r!==void 0?r:[]).map(n=>{let s=`${this.br()}elif ${this.expression(n.cond)}${this.tab()}then ${this.expression(n.then)}`;return this.shiftTab(),s}).join("")}${e.else?`${this.br()}else ${this.expression(e.else)}`:""}${this.shiftTab()}end`}try(e){return e.short?`${this.expression(e.body)}?`:`try ${this.expression(e.body)}${e.catch?` catch ${this.expression(e.catch)}`:""}`}label(e){return`label ${e.value} | ${this.expression(e.next,!1)}`}break(e){return`break ${e.value}`}reduce(e){return`reduce ${this.expression(e.expr)} as ${e.var} (${this.tab()}${this.expression(e.init,!1)};${this.br()}${this.expression(e.update,!1)}${this.shiftTab()})`}foreach(e){return`foreach ${this.expression(e.expr)} as ${e.var} (${this.tab()}${this.expression(e.init,!1)};${this.br()}${this.expression(e.update,!1)}${e.extract?`;${this.br()}`+this.expression(e.extract,!1):""}${this.shiftTab()})`}binary(e){let r=this.expression(e.left,e.left.type==="binary"?pe.Parser.getPrecedence(e.left.operator)<pe.Parser.getPrecedence(e.operator):this.needsBrackets(e.left)),n=this.expression(e.right,e.right.type==="binary"?pe.Parser.getPrecedence(e.right.operator)<pe.Parser.getPrecedence(e.operator):this.needsBrackets(e.right));return`${r}${e.operator===","?"":" "}${e.operator} ${n}`}unary(e){return`${e.operator}${e.expr.type!=="num"?" ":""}${this.expression(e.expr)}`}index(e){return`${this.expression(e.expr)}${typeof e.index=="string"?`${e.expr.type==="identity"?"":"."}${e.index}`:`[${this.expression(e.index,!1)}]`}`}slice(e){return`${this.expression(e.expr)}[${e.from?this.expression(e.from,!1):""}:${e.to?this.expression(e.to,!1):""}]`}iterator(e){return`${this.expression(e.expr)}[]`}array(e){return`[${e.expr?this.expression(e.expr,!1):""}]`}object(e){return e.entries.length===0?"{}":`{${this.tab()}${this.delimited("","",`,${this.br()}`,e.entries,r=>this.objectEntry(r))},${this.shiftTab()}}`}var(e){return`${e.name}`}varDeclaration(e){return`${this.expression(e.expr,this.varDeclarationNeedsBrackets(e.expr))} as ${e.destructuring.map(r=>this.destructuring(r)).join(" ?// ")} | ${this.expression(e.next,!1)}`}arrayDestructuring(e){return this.delimited("[ "," ]",", ",e.destructuring,r=>this.destructuring(r))}objectDestructuring(e){return this.delimited("{ "," }",", ",e.entries,r=>this.objectDestructuringEntry(r),!1)}recursiveDescent(e){return".."}expression(e,r=this.needsBrackets(e)){switch(e.type){case"binary":return this.brackets(this.binary(e),r);default:return this.brackets(this.atom(e),r)}}atom(e){switch(e.type){case"def":return this.def(e);case"identity":return this.identity(e);case"num":return this.num(e);case"str":return this.str(e);case"bool":return this.bool(e);case"null":return this.null(e);case"format":return this.format(e);case"filter":return this.filter(e);case"if":return this.if(e);case"try":return this.try(e);case"reduce":return this.reduce(e);case"var":return this.var(e);case"varDeclaration":return this.varDeclaration(e);case"foreach":return this.foreach(e);case"label":return this.label(e);case"break":return this.break(e);case"unary":return this.unary(e);case"index":return this.index(e);case"slice":return this.slice(e);case"iterator":return this.iterator(e);case"array":return this.array(e);case"object":return this.object(e);case"recursiveDescent":return this.recursiveDescent(e);default:throw new ni.JqPrintError(`Unknown ast node: ${e.type}`)}}delimited(e,r,n,s,i,o){return`${e}${s.map(i).join(n)}${o&&s.length>0?n:""}${r}`}arg(e){switch(e.type){case"filterArg":return this.filterArg(e);case"varArg":return this.varArg(e)}}objectEntry(e){return`${this.objectEntryKey(e.key)}${e.value?`: ${this.expression(e.value,this.objectValueNeedsBrackets(e.value))}`:""}`}objectDestructuringEntry(e){return e.destructuring===void 0?this.var(e.key):`${this.objectEntryKey(e.key)}: ${this.destructuring(e.destructuring)}`}objectEntryKey(e){return typeof e=="string"?e:this.expression(e,e.type!=="str")}destructuring(e){switch(e.type){case"var":return this.var(e);case"arrayDestructuring":return this.arrayDestructuring(e);case"objectDestructuring":return this.objectDestructuring(e)}}brackets(e,r){return r?`(${e})`:e}needsBrackets(e){let r=["identity","num","str","bool","null","format","filter","var","index","slice","iterator","array","object","recursiveDescent","unary","label","break","if","reduce","foreach"];return!(e.type==="try"&&e.short||r.includes(e.type))}objectValueNeedsBrackets(e){let r=["identity","num","str","bool","null","format","filter","var","index","slice","iterator","array","object","recursiveDescent"];return!(e.type==="try"&&e.short||(e.type==="unary"?e.expr.type==="num":r.includes(e.type)))}varDeclarationNeedsBrackets(e){let r=["identity","num","str","bool","null","format","filter","var","index","slice","iterator","array","object","recursiveDescent"];return!(e.type==="try"&&e.short||r.includes(e.type))}br(){let e=`
`;for(let r=0;r<this.indent;r++)e+=t.INDENT;return e}tab(){return this.indent++,this.br()}shiftTab(){return this.indent--,this.br()}};rt.INDENT="  "});var fn=E(st=>{"use strict";Object.defineProperty(st,"__esModule",{value:!0});st.format=void 0;var ii=ce(),oi=tr(),ai=t=>(0,oi.print)((0,ii.parse)(t));st.format=ai});var Fe=E(R=>{"use strict";Object.defineProperty(R,"__esModule",{value:!0});R.cannotSliceError=R.cannotIndexError=R.notImplementedError=R.notDefinedError=void 0;var it=V(),rr=G();function li(t){return new it.JqEvaluateError(`'${t}' is not defined`)}R.notDefinedError=li;function ui(t){return new it.NotImplementedError(`Feature '${t}' is not implemented`)}R.notImplementedError=ui;function ci(t,e){return new it.JqEvaluateError(`Cannot index ${(0,rr.typeOf)(t)} with ${(0,rr.typeOf)(e)}`)}R.cannotIndexError=ci;function pi(t){return new it.JqEvaluateError(`Cannot slice ${(0,rr.typeOf)(t)}`)}R.cannotSliceError=pi});var lt=E(at=>{"use strict";Object.defineProperty(at,"__esModule",{value:!0});at.compare=void 0;var ne=G(),hn={null:0,boolean:1,number:2,string:3,array:4,object:5};function fi(t,e){return hn[t]-hn[e]}function ot(t,e){var r,n;let s=(0,ne.typeOf)(t),i=fi(s,(0,ne.typeOf)(e));if(i!==0)return i;switch(s){case ne.Type.null:return 0;case ne.Type.boolean:case ne.Type.number:return t-e;case ne.Type.string:for(let u=0;u<Math.max(t.length,e.length);u++){let f=(r=t.codePointAt(u))!==null&&r!==void 0?r:-1,b=(n=e.codePointAt(u))!==null&&n!==void 0?n:-1,w=f-b;if(w!==0)return w}return 0;case ne.Type.array:for(let u=0;u<Math.max(t.length,e.length);u++){if(t[u]===void 0)return-1;if(e[u]===void 0)return 1;let f=ot(t[u],e[u]);if(f!==0)return f}return 0;case ne.Type.object:let o=Object.keys(t).sort(),g=Object.keys(e).sort(),_=ot(o,g);if(_!==0)return _;let a=o.map(u=>t[u]),l=g.map(u=>e[u]);return ot(a,l)}}at.compare=ot});var G=E(h=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0});h.transformRegExpMatch=h.sort=h.has=h.keys=h.assertString=h.assertNumber=h.range=h.delPaths=h.getChildPaths=h.shallowClone=h.deepClone=h.deepMerge=h.resolveNormalizedSliceAccessor=h.normalizeLeadingSliceAccessors=h.normalizeSliceAccessor=h.normalizeArrayIndex=h.access=h.indices=h.toString=h.recursiveDescent=h.repeatString=h.isTrue=h.isPaths=h.isPath=h.many=h.single=h.someOfType=h.typeIsOneOf=h.typesMatchCommutative=h.typesMatch=h.typesEqual=h.isAtom=h.typeOf=h.Type=h.collectValues=h.generatePaths=h.generateValues=h.generateItems=h.createItem=h.isSliceAccessor=h.createSliceAccessor=void 0;var he=V(),nr=Fe(),dn=lt();function hi(t,e){return{start:t,end:e}}h.createSliceAccessor=hi;function X(t){return t&&(t.start===null||Number.isInteger(t.start))&&(t.end===null||Number.isInteger(t.end))}h.isSliceAccessor=X;function mn(t,e=[]){return{value:t,path:e}}h.createItem=mn;function*di(t){for(let e of t)yield mn(e)}h.generateItems=di;function*yn(t){for(let e of t)yield e.value}h.generateValues=yn;function*mi(t){for(let e of t)yield e.path}h.generatePaths=mi;function yi(t){return Array.from(yn(t))}h.collectValues=yi;var k;(function(t){t.null="null",t.boolean="boolean",t.number="number",t.string="string",t.array="array",t.object="object"})(k=h.Type||(h.Type={}));function A(t){return Array.isArray(t)?k.array:t===null?k.null:typeof t}h.typeOf=A;function gi(t){let e=A(t);return e!=="array"&&e!=="object"}h.isAtom=gi;function bi(t,e){return A(t)===A(e)}h.typesEqual=bi;function H(t,e,r,n=r){return A(t)===r&&A(e)===n}h.typesMatch=H;function vi(t,e,r,n){return H(t,e,r,n)||H(t,e,n,r)}h.typesMatchCommutative=vi;function Me(t,...e){return e.some(r=>A(t)===r)}h.typeIsOneOf=Me;function wi(t,...e){return e.some(r=>A(r)===t)}h.someOfType=wi;function*$i(t){yield t}h.single=$i;function*xi(t){yield*t}h.many=xi;function gn(t){return Array.isArray(t)&&t.every(e=>{switch(typeof e){case"string":return!0;case"number":return Number.isInteger(e);case"object":return X(e);default:return!1}})}h.isPath=gn;function Ei(t){return Array.isArray(t)&&t.every(e=>gn(e))}h.isPaths=Ei;function _i(t){return t!==null&&t!==!1}h.isTrue=_i;function ki(t,e){if(e<=0)return null;let r="";for(let n=0;n<Math.floor(e);n++)r+=t;return r}h.repeatString=ki;function*sr(t){if(yield t,A(t)==="object")for(let e of Object.values(t))yield*sr(e);else if(A(t)==="array")for(let e of t)yield*sr(e)}h.recursiveDescent=sr;function Ii(t){switch(A(t)){case k.null:return"null";case k.boolean:case k.number:return t.toString();case k.string:return t;case k.array:case k.object:return JSON.stringify(t)}}h.toString=Ii;function bn(t,e){let r=[];for(let n=0;n<t.length;n++)for(let s=0;s<e.length&&(0,dn.compare)(t[n+s],e[s])===0;s++)s+1===e.length&&r.push(n);return r}h.indices=bn;function vn(t,e){var r,n,s,i;if(H(e,t,k.number,k.array))return(r=t[ut(t.length,e)])!==null&&r!==void 0?r:null;if(H(e,t,k.string,k.object))return(n=t[e])!==null&&n!==void 0?n:null;if(H(e,t,k.array,k.array))return bn(t,e);if(A(t)===k.null&&(Me(e,k.number,k.string)||X(e)))return null;if(Me(t,k.array,k.string)&&X(e))return t.slice((s=e.start)!==null&&s!==void 0?s:void 0,(i=e.end)!==null&&i!==void 0?i:void 0);throw X(e)?(0,nr.cannotSliceError)(t):(0,nr.cannotIndexError)(t,e)}h.access=vn;function ut(t,e){return e<0?t+e:e}h.normalizeArrayIndex=ut;function ct(t,e){let{start:r,end:n}=e,s=Math.max(0,Math.min(ut(t,n??t),t));return{start:Math.max(0,Math.min(ut(t,r??0),s)),end:s}}h.normalizeSliceAccessor=ct;function wn(t,e){if(!X(e[0]))return e;let r=1,n=ct(t,e[0]);for(;X(e[r]);){t=n.end-n.start;let s=ct(t,e[r]);n={start:n.start+s.start,end:n.start+s.end},r++}if(r<e.length){let s=e[r];if(typeof s!="number")throw(0,nr.cannotIndexError)([],s);return[n.start+s,...e.slice(r+1)]}else return[n]}h.normalizeLeadingSliceAccessors=wn;function $n(t){let e=[];for(let r=t.start;r<t.end;r++)e.push(r);return e}h.resolveNormalizedSliceAccessor=$n;function xn(t,e){if(H(t,e,k.object,k.object)){let r=new Set(Object.keys(t).concat(Object.keys(e))),n=[];for(let s of r)n.push([s,xn(t[s],e[s])]);return Object.fromEntries(n)}else return e===void 0?t:e}h.deepMerge=xn;function ir(t){switch(A(t)){case k.null:case k.boolean:case k.number:case k.string:return t;case k.array:return t.map(ir);case k.object:return Object.fromEntries(Object.entries(t).map(ir))}}h.deepClone=ir;function En(t){switch(A(t)){case k.null:case k.boolean:case k.number:case k.string:return t;case k.array:return[...t];case k.object:return Object.assign({},t)}}h.shallowClone=En;function _n(t){let e={};for(let r of t.filter(n=>n.length>1)){let n=r[0];if(X(n))throw new he.JqEvaluateError("getChildPaths: Cannot handle paths that are longer than 1, and start in a slice accessor");n in e||(e[n]=[]),e[n].push(r.slice(1))}return e}h.getChildPaths=_n;function kn(t,e){if(e.length===0)return t;let r=A(t);if(Me(t,k.array,k.object)){let n=En(t),s=e.map(i=>wn(A(t)===k.array?t.length:0,i));for(let i of s){if(i.length!==1)continue;let o=i[0];if(vn(n,o),X(o)){let g=ct(t.length,o);for(let _ of $n(g))delete n[_]}else delete n[o]}r===k.array&&(n=n.filter(i=>i!==void 0));for(let[i,o]of Object.entries(_n(s)))i in n&&(n[i]=kn(n[i],o));return n}else throw new he.JqEvaluateError(`Cannot delete fields from ${r}`)}h.delPaths=kn;function*In(t,e,r){let n,s,i;e!==void 0&&r!==void 0?(n=fe(t),s=fe(e),i=fe(r)):e!==void 0?(n=fe(t),s=fe(e),i=1):(n=0,s=fe(t),i=1);for(let o=n;o<s;o+=i)yield o}h.range=In;function fe(t){if(A(t)!==k.number)throw new he.JqEvaluateError(`Got ${A(t)}, number expected`);return t}h.assertNumber=fe;function Oi(t){if(A(t)!==k.string)throw new he.JqEvaluateError(`Got ${A(t)}, string expected`);return t}h.assertString=Oi;function ji(t){if(!Me(t,k.array,k.object))throw new he.JqEvaluateError(`${A(t)} has no keys`);return A(t)===k.array?Array.from(In(t.length)):Object.keys(t)}h.keys=ji;function Pi(t,e){if(!H(t,e,k.array,k.number)&&!H(t,e,k.object,k.string))throw new he.JqEvaluateError(`Cannot check whether ${A(t)} has a ${A(e)} key`);return e in t}h.has=Pi;function Si(t){return t.sort(dn.compare)}h.sort=Si;function qi(t){let e=t.indices;if(t.index===void 0||e===void 0)throw new he.JqEvaluateError("RegExp match item transformation error");return{offset:t.index,length:t[0].length,string:t[0],captures:t.slice(1).map((n,s)=>({offset:e[s+1][0],length:n.length,string:n,name:null}))}}h.transformRegExpMatch=qi});var or=E(pt=>{"use strict";Object.defineProperty(pt,"__esModule",{value:!0});pt.setPath=void 0;var J=G(),On=V();function jn(t,e,r){if(e.length===0)return r;let n=(0,J.typeOf)(t),s=(0,J.normalizeLeadingSliceAccessors)(n===J.Type.array?t.length:0,e),i=s[0],o=t==null?(0,J.typeOf)(i)===J.Type.string?{}:[]:(0,J.shallowClone)(t);if((0,J.access)(o,i),s.length===1)if((0,J.isSliceAccessor)(i)){if((0,J.typeOf)(r)!==J.Type.array)throw new On.JqEvaluateError("An array slice can only be assigned an array");o.splice(i.start,i.end-i.start,...r)}else o[i]=r;else{if((0,J.isSliceAccessor)(i))throw new On.JqEvaluateError("setPath: Leading slice accessors are not normalized");o[i]=jn(o[i],s.slice(1),r)}return o}pt.setPath=jn});var Sn=E(Ie=>{"use strict";Object.defineProperty(Ie,"__esModule",{value:!0});Ie.combineIterators=Ie.nestedIterators=void 0;function*Pn(t,e){let r=!0,n=[];for(let s of t){let i=r?e:n;yield[s,function*(){for(let o of i)r&&n.push(o),yield o}()],r=!1}}Ie.nestedIterators=Pn;function*Ai(t,e){for(let[r,n]of Pn(t,e))for(let s of n)yield[r,s]}Ie.combineIterators=Ai});var ar=E(ft=>{"use strict";Object.defineProperty(ft,"__esModule",{value:!0});ft.getPath=void 0;var se=G(),Ti=V();function qn(t,e){var r;if(e.length===0)return t;let n=(0,se.typeOf)(t),s=(0,se.normalizeLeadingSliceAccessors)(n===se.Type.array?t.length:0,e),i=s[0];if(t==null&&(t=(0,se.typeOf)(i)===se.Type.string?{}:[]),(0,se.access)(t,i),s.length===1)return(0,se.isSliceAccessor)(i)?t.slice(i.start,i.end):(r=t[i])!==null&&r!==void 0?r:null;if((0,se.isSliceAccessor)(i))throw new Ti.JqEvaluateError("getPath: Leading slice accessors are not normalized");return qn(t[i],s.slice(1))}ft.getPath=qn});var lr=E(Y=>{"use strict";Object.defineProperty(Y,"__esModule",{value:!0});Y.isBinaryOperatorType=Y.typeOfBinaryOperator=Y.BinaryOperatorType=void 0;var S;(function(t){t[t.normal=0]="normal",t[t.assignment=1]="assignment",t[t.boolean=2]="boolean",t[t.pipe=3]="pipe",t[t.comma=4]="comma",t[t.alternative=5]="alternative",t[t.destructuringAlternative=6]="destructuringAlternative"})(S=Y.BinaryOperatorType||(Y.BinaryOperatorType={}));var Ni={"|":S.pipe,",":S.comma,"//":S.alternative,"=":S.assignment,"|=":S.assignment,"+=":S.assignment,"-=":S.assignment,"*=":S.assignment,"/=":S.assignment,"%=":S.assignment,"//=":S.assignment,or:S.boolean,and:S.boolean,"==":S.normal,"!=":S.normal,"<":S.normal,">":S.normal,"<=":S.normal,">=":S.normal,"+":S.normal,"-":S.normal,"*":S.normal,"/":S.normal,"%":S.normal,"?//":S.destructuringAlternative};function An(t){return Ni[t]}Y.typeOfBinaryOperator=An;function Ci(t,e){return An(t)===e}Y.isBinaryOperatorType=Ci});var Dn=E(C=>{"use strict";Object.defineProperty(C,"__esModule",{value:!0});C.evaluateAlternativeOperator=C.evaluateNormalBinaryOperator=C.evaluateBooleanOperator=C.evaluateArithmeticUpdateAssignment=C.evaluateSimpleAssignment=C.applyNormalBinaryOperator=void 0;var $=G(),de=lt(),ht=V(),Cn=or(),ur=Sn(),Di=ar(),Tn=lr();function me(t,e,r){return new ht.JqEvaluateError(`Operator ${t} cannot be applied to ${(0,$.typeOf)(e)} and ${(0,$.typeOf)(r)}`)}function Fi(t){return new ht.JqEvaluateError(`applyBinary: Cannot apply operator '${t}'`)}function Nn(){return new ht.JqEvaluateError("Division by zero")}function cr(t,e,r){switch(t){case"==":return(0,de.compare)(e,r)===0;case"!=":return(0,de.compare)(e,r)!==0;case"<":return(0,de.compare)(e,r)<0;case">":return(0,de.compare)(e,r)>0;case"<=":return(0,de.compare)(e,r)<=0;case">=":return(0,de.compare)(e,r)>=0;case"+":if((0,$.someOfType)($.Type.null,e,r))return(0,$.typeOf)(e)===$.Type.null?r:e;if(!(0,$.typesEqual)(e,r))throw me(t,e,r);switch((0,$.typeOf)(e)){case $.Type.string:case $.Type.number:return e+r;case $.Type.array:return[...e,...r];case $.Type.object:return Object.assign(Object.assign({},e),r);default:throw me(t,e,r)}case"-":if(!(0,$.typesEqual)(e,r))throw me(t,e,r);switch((0,$.typeOf)(e)){case $.Type.number:return e-r;case $.Type.array:return e.filter(n=>!r.some(s=>(0,de.compare)(n,s)===0));default:throw me(t,e,r)}case"*":if((0,$.typesMatch)(e,r,$.Type.number))return e*r;if((0,$.typesMatchCommutative)(e,r,$.Type.string,$.Type.number)){let n=(0,$.typeOf)(e)===$.Type.string?e:r,s=(0,$.typeOf)(e)===$.Type.number?e:r;return(0,$.repeatString)(n,s)}else if((0,$.typesMatch)(e,r,$.Type.object))return(0,$.deepMerge)(e,r);throw me(t,e,r);case"/":if((0,$.typesMatch)(e,r,$.Type.number)){if(r===0)throw Nn();return e/r}else if((0,$.typesMatch)(e,r,$.Type.string))return e.split(r);throw me(t,e,r);case"%":if((0,$.typesMatch)(e,r,$.Type.number)){if(Math.floor(r)===0)throw Nn();return Math.floor(e)%Math.floor(r)}throw me(t,e,r);default:throw Fi(t)}}C.applyNormalBinaryOperator=cr;function*Mi(t,e,r){for(let[n,s]of(0,ur.nestedIterators)((0,$.generateValues)(r),(0,$.generatePaths)(e))){let i=t.value;for(let o of s)i=(0,Cn.setPath)(i,o,(0,$.deepClone)(n));yield(0,$.createItem)(i)}}C.evaluateSimpleAssignment=Mi;function*Bi(t,e,r,n){for(let[s,i]of(0,ur.nestedIterators)((0,$.generateValues)(n),(0,$.generatePaths)(r))){let o=e.value;for(let g of i){let _=t.slice(0,-1),a=(0,Di.getPath)(o,g);o=(0,Cn.setPath)(o,g,(0,Tn.isBinaryOperatorType)(_,Tn.BinaryOperatorType.alternative)?Ki(a,s):cr(_,a,s))}yield(0,$.createItem)(o)}}C.evaluateArithmeticUpdateAssignment=Bi;function*Vi(t,e,r){if(t!=="and"&&t!=="or")throw new ht.JqEvaluateError(`evaluateBooleanOperator: Unexpected operator '${t}'`);let n=!0,s=[];for(let i of e){let o=n?r:s;if(t==="and"&&!(0,$.isTrue)(i.value)){yield(0,$.createItem)(!1);continue}else if(t==="or"&&(0,$.isTrue)(i.value)){yield(0,$.createItem)(!0);continue}for(let g of o)n&&s.push(g),yield(0,$.createItem)((0,$.isTrue)(g.value));n=!1}}C.evaluateBooleanOperator=Vi;function*Ji(t,e,r){for(let[n,s]of(0,ur.combineIterators)(r,e))yield(0,$.createItem)(cr(t,s.value,n.value))}C.evaluateNormalBinaryOperator=Ji;function Ki(t,e){return(0,$.isTrue)(t)?t:e}function*zi(t,e){let r=!1;for(let n of t)(0,$.isTrue)(n.value)&&(yield n,r=!0);r||(yield*e)}C.evaluateAlternativeOperator=zi});var pr=E(dt=>{"use strict";Object.defineProperty(dt,"__esModule",{value:!0});dt.generateCombinations=void 0;function*Ri(t){let e=t.map(r=>0);do yield Wi(t,e);while(Li(t,e))}dt.generateCombinations=Ri;function Wi(t,e){return e.map((r,n)=>t[n][r])}function Li(t,e){for(let r=e.length-1;r>=0;r--){if(e[r]++,e[r]<t[r].length)return!0;e[r]=0}return!1}});var Fn=E(mt=>{"use strict";Object.defineProperty(mt,"__esModule",{value:!0});mt.generateObjects=void 0;var Ui=pr();function*Zi(t){let e=t.flat();for(let r of(0,Ui.generateCombinations)(e))yield Gi(r)}mt.generateObjects=Zi;function Gi(t){let e=t.reduce((r,n,s)=>(s%2===0?r.push([n]):r[r.length-1].push(n),r),[]);return Object.fromEntries(e)}});var Bn=E(yt=>{"use strict";Object.defineProperty(yt,"__esModule",{value:!0});yt.applyFormat=void 0;var ie=Fe(),Mn={"@text"(t){throw(0,ie.notImplementedError)("@text")},"@json"(t){throw(0,ie.notImplementedError)("@json")},"@html"(t){throw(0,ie.notImplementedError)("@html")},"@uri"(t){throw(0,ie.notImplementedError)("@uri")},"@csv"(t){throw(0,ie.notImplementedError)("@csv")},"@tsv"(t){throw(0,ie.notImplementedError)("@tsv")},"@sh"(t){throw(0,ie.notImplementedError)("@sh")},"@base64"(t){return btoa(t)},"@base64d"(t){return atob(t)}};function Xi(t,e){if(t===void 0)return e;if(!Mn[t.name])throw(0,ie.notDefinedError)(t.name);return Mn[t.name](e)}yt.applyFormat=Xi});var fr=E(Oe=>{"use strict";Object.defineProperty(Oe,"__esModule",{value:!0});Oe.isNativeFilter=Oe.wrapBareNativeFilters=void 0;var Vn=G();function Hi(t){return Object.fromEntries(Object.entries(t).map(([e,r])=>[e,(n,...s)=>(0,Vn.generateItems)(r(n.value,...(0,Vn.collectValues)(s)))]))}Oe.wrapBareNativeFilters=Hi;function Yi(t){return typeof t=="function"}Oe.isNativeFilter=Yi});var Kn=E(Jn=>{"use strict";Object.defineProperty(Jn,"__esModule",{value:!0})});var K=E(D=>{"use strict";Object.defineProperty(D,"__esModule",{value:!0});D.NotImplementedError=D.JqArgumentError=D.JqEvaluateError=D.JqPrintError=D.JqParseError=D.JqError=void 0;var je=class extends Error{};D.JqError=je;var hr=class extends je{};D.JqParseError=hr;var dr=class extends je{};D.JqPrintError=dr;var Be=class extends je{};D.JqEvaluateError=Be;var mr=class extends Be{};D.JqArgumentError=mr;var yr=class extends Be{};D.NotImplementedError=yr});var zn=E(gt=>{"use strict";Object.defineProperty(gt,"__esModule",{value:!0});gt.Tokenizer=void 0;var ye=class t{constructor(e){this.input=e,this.current=null,this.interpolationContexts=[]}next(){let e=this.current;return this.current=null,e||this.readNext()}peek(){return this.current||(this.current=this.readNext())}eof(){return this.peek()===null}croak(e){return this.input.restore(),this.input.croak(e)}toArray(){let e=[];for(;!this.eof();)e.push(this.next());return e}readNext(){if(this.readWhile(t.isWhitespace),this.input.snapshot(),this.input.eof())return null;let e=this.input.peek();if(this.interpolationContextJustExited())return this.interpolationContexts.pop(),this.readString();if(e==="#")return this.skipComment(),this.readNext();if(t.isDigit(e))return this.readNumber();if(e=='"')return this.input.next(),this.readString();if(t.isIdentStart(e))return this.readIdent();if(t.isPuncChar(e))return this.readPunc();if(t.isOpChar(e))return this.readOp();throw this.croak(`Can't handle character: ${e}`)}readWhile(e){let r="";for(;!this.input.eof()&&e(this.input.peek());)r+=this.input.next();return r}skipComment(){this.readWhile(e=>e!==`
`)}readIdent(){let e=this.readWhile(t.isIdentChar);return e==="null"?{type:"null",value:null}:e==="true"?{type:"bool",value:!0}:e==="false"?{type:"bool",value:!1}:{type:t.keywords.has(e)?"kw":e.charAt(0)==="@"?"format":e.charAt(0)==="$"?"var":"ident",value:e}}interpolationContextJustExited(){return this.interpolationContexts[this.interpolationContexts.length-1]===0}updateInterpolationContext(e){let r=this.interpolationContexts.length;r!==0&&(e==="("?this.interpolationContexts[r-1]++:e===")"&&this.interpolationContexts[r-1]--)}readPunc(){let e=this.input.next();if(e=="\\"){if(this.input.peek()!=="(")throw this.croak(`Can't handle character: ${this.input.peek()}`);e+=this.input.next(),this.interpolationContexts.push(1)}else this.updateInterpolationContext(e);return{type:"punc",value:e}}readOp(){let e=this.input.next();return t.operators.has(e+this.input.peek()+this.input.peek(1))?e+=this.input.next()+this.input.next():t.operators.has(e+this.input.peek())&&(e+=this.input.next()),{type:"op",value:e}}readString(){let e=!1,r="";for(;!this.input.eof()&&!(this.input.peek()=="\\"&&this.input.peek(1)==="(");){let n=this.input.next();if(e)r+=this.getEscaped(n);else if(n=="\\")e=!0;else{if(n=='"')break;r+=n}}return{type:"str",value:r}}readNumber(){let e=!1;return{type:"num",value:Number(this.readWhile(r=>r==="."?e?!1:(e=!0,!0):t.isDigit(r)))}}static isWhitespace(e){return` 	
`.indexOf(e)>=0}static isOpChar(e){return".=!|+-*/%?<>,".indexOf(e)>=0}static isPuncChar(e){return"()[]{}:;\\".indexOf(e)>=0}static isDigit(e){return/[0-9]/.test(e)}static isIdentStart(e){return/[a-zA-Z@$_]/.test(e)}static isIdentChar(e){return t.isIdentStart(e)||/[0-9]/.test(e)}getEscaped(e){let r=e;if(!t.escapeCharacters[r])throw this.croak(`Can't parse an escape character: ${e}`);return t.escapeCharacters[r]}static stringifyTokenType(e){return this.tokenTypeToString[e]}static stringifyToken(e){return e===null?"EOF":["null","bool","value"].includes(e.type)?`${this.tokenTypeToString[e.type]}: ${e.value}`:`${this.tokenTypeToString[e.type]}: "${e.value}"`}};gt.Tokenizer=ye;ye.tokenTypeToString={punc:"punctuation",op:"operator",ident:"identifier",kw:"keyword",format:"format",var:"variable",str:"string",null:"null",bool:"boolean",num:"number"};ye.escapeCharacters={b:"\b",f:"\f",n:`
`,r:"\r",t:"	",v:"\v","'":"'",'"':'"',"\\":"\\"};ye.keywords=new Set(["__loc__","and","as","break","catch","def","elif","else","end","foreach","if","import","include","label","module","modulemeta","not","or","reduce","then","try"]);ye.operators=new Set(["!=","%","%=","*","*=","+","+=",",","-","-=",".","..","/","//","//=","/=","<","<=","=","==",">",">=","?","?//","|","|="])});var Rn=E(bt=>{"use strict";Object.defineProperty(bt,"__esModule",{value:!0});bt.InputStream=void 0;var Qi=K(),gr=class{constructor(e){this.input=e,this.state={pos:0,line:1,col:0,lineStart:0},this.prev={pos:0,line:1,col:0,lineStart:0}}next(){let e=this.input.charAt(this.state.pos++);return e==`
`?(this.state.line++,this.state.col=0,this.state.lineStart=this.state.pos):this.state.col++,e}peek(e=0){return this.input.charAt(this.state.pos+e)}eof(){return this.peek()==""}croak(e){return new Qi.JqParseError(`${e} (${this.state.line}:${this.state.col})

${this.getLine()}
${this.getErrorPointer()}`)}snapshot(){this.prev=Object.assign({},this.state)}restore(){this.state=Object.assign({},this.prev)}getLine(){let e=0;for(;![`
`,""].includes(this.input.charAt(this.state.pos+e));)e++;return this.input.substring(this.state.lineStart,this.state.pos+e)}getErrorPointer(){let e="";for(let r=0;r<this.state.col;r++)e+="-";return e+="^",e}};bt.InputStream=gr});var ge=E(Pe=>{"use strict";Object.defineProperty(Pe,"__esModule",{value:!0});Pe.parse=Pe.Parser=void 0;var Ve=zn(),eo=Rn(),Je=class t{constructor(e){this.input=e}static getPrecedence(e){return t.precedence[e]}static normalizeBinaryAst(e){return e.right.type==="binary"&&this.getPrecedence(e.operator)===this.getPrecedence(e.right.operator)?this.normalizeBinaryAst({type:"binary",left:this.normalizeBinaryAst({type:"binary",left:e.left,operator:e.operator,right:e.right.left}),operator:e.right.operator,right:e.right.right.type==="binary"?this.normalizeBinaryAst(e.right.right):e.right.right}):e}static getFilterName(e,r){return`${e}/${r}`}static getFilterIdent(e){return e.split("/")[0]}static getFilterArity(e){return Number(e.split("/")[1])}parse(){return this.parseTopLevel()}unexpected(){return this.input.croak(`Unexpected ${Ve.Tokenizer.stringifyToken(this.input.peek())}`)}expected(e,r){let n=this.input.peek();return this.input.croak(`Expected ${r?Ve.Tokenizer.stringifyToken({type:e,value:r}):Ve.Tokenizer.stringifyTokenType(e)}, received ${Ve.Tokenizer.stringifyToken(n)}`)}is(e,r){let n=this.input.peek();return(n&&n.type===e&&(!r||r===n.value)||null)&&n}skip(e,r){if(this.is(e,r))return this.input.next();throw this.expected(e,r)}isKw(e){return this.is("kw",e)}isVar(e){return this.is("var",e)}isIdent(e){return this.is("ident",e)}isFormat(e){return this.is("format",e)}isPunc(e){return this.is("punc",e)}isOp(e){return this.is("op",e)}isBool(e){return this.is("bool",e)}isStr(e){return this.is("str",e)}isNum(e){return this.is("num",e)}isNull(){return this.is("null")}skipPunc(e){return this.skip("punc",e)}skipKw(e){return this.skip("kw",e)}skipVar(e){return this.skip("var",e)}skipFormat(e){return this.skip("format",e)}skipIdent(e){return this.skip("ident",e)}skipOp(e){return this.skip("op",e)}skipBool(e){return this.skip("bool",e)}skipStr(e){return this.skip("str",e)}skipNum(e){return this.skip("num",e)}skipNull(){return this.skip("null")}parseTopLevel(){let e;if(this.input.eof()||(e=this.parseExpression()),!this.input.eof())throw this.unexpected();return{type:"root",expr:e}}parseDef(){this.skipKw("def");let e=this.skipIdent().value,r=this.isPunc("(")?this.delimited("(",")",";",()=>this.parseArgName()):[],n=t.getFilterName(e,r.length);this.skipPunc(":");let s=this.parseExpression();this.skipPunc(";");let i={type:"def",name:n,args:r,body:s};return this.input.eof()||(i.next=this.parseExpression()),i}delimited(e,r,n,s,i=0,o,g){this.skipPunc(e);let _=[],a=!0,l=0;for(;(l<i||!this.input.eof()&&!this.isPunc(r)&&(!o||l<o))&&(a||(typeof n=="string"?this.skipPunc(n):this.skipOp(n.value)),!(g&&this.isPunc(r)));)_.push(s()),a=!1,l++;return g&&(typeof n=="string"?this.isPunc(n)&&this.skipPunc(n):this.isOp(n.value)&&this.skipOp(n.value)),this.skipPunc(r),_}parseArgName(){let e=this.input.next();switch(e?.type){case"ident":return{type:"filterArg",name:t.getFilterName(e.value,0)};case"var":return{type:"varArg",name:e.value}}throw this.input.croak("Expecting argument name")}parseExpression(e){return this.maybeBinary(this.parseAtomOrControlStructure(),0,e)}maybeShortTry(e){let r=e();if(this.isOp("?")){this.skipOp("?");let n={type:"try",short:!0,body:r};return this.atomMaybe(()=>n)}return r}parseAtomOrControlStructure(){return this.isKw("label")?this.parseLabel():this.isKw("break")?this.parseBreak():this.isKw("try")?this.parseTry():this.isKw("if")?this.parseIf():this.isKw("reduce")?this.parseReduce():this.isKw("foreach")?this.parseForeach():this.parseAtom(!0)}parseAtom(e){if(this.isKw("def"))return this.parseDef();if(this.isOp("-"))return{type:"unary",operator:this.skipOp("-").value,expr:this.parseAtomOrControlStructure()};let r=()=>this.atomMaybe(()=>{if(this.isPunc("(")){this.input.next();let n=this.parseExpression();return this.skipPunc(")"),n}if(this.isOp("."))return this.parseIdentity();if(this.isOp(".."))return this.parseRecursiveDescent();if(this.isPunc("["))return this.parseArray();if(this.isPunc("{"))return this.parseObject();if(this.isVar())return this.parseVar();if(this.isIdent()||this.isKw("not"))return this.parseFilter();if(this.isFormat())return this.parseFormat();if(this.isStr())return this.parseStr();if(this.isNum()||this.isBool()||this.isNull())return this.input.next();throw this.unexpected()});return e?this.maybeVariable(r):r()}maybeBinary(e,r=0,n=[]){let s=this.isOp()||this.isKw("and")||this.isKw("or");if(s&&!n.includes(s.value)){let i=t.getPrecedence(s.value);if(i>r)return this.input.next(),this.maybeBinary(t.normalizeBinaryAst({type:"binary",operator:s.value,left:e,right:this.maybeBinary(this.parseAtomOrControlStructure(),i,n)}),r,n)}return e}parseIdentity(){return this.skipOp("."),{type:"identity"}}parseRecursiveDescent(){return this.skipOp(".."),{type:"recursiveDescent"}}atomMaybe(e){return this.maybeShortTry(()=>this.maybeBracketIndex(()=>this.maybeSimpleIndex(e)))}maybeVariable(e){let r=e();if(this.isKw("as")){this.skipKw("as");let n=[this.parseDestructuring()];for(;this.isOp("?//");)this.skipOp("?//"),n.push(this.parseDestructuring());this.skipOp("|");let s=this.parseExpression();return{type:"varDeclaration",expr:r,destructuring:n,next:s}}return r}parseDestructuring(){return this.isPunc("[")?this.parseArrayDestructuring():this.isPunc("{")?this.parseObjectDestructuring():this.parseVar()}parseArrayDestructuring(){return{type:"arrayDestructuring",destructuring:this.delimited("[","]",{type:"op",value:","},()=>this.parseDestructuring())}}parseObjectDestructuring(){return{type:"objectDestructuring",entries:this.delimited("{","}",{type:"op",value:","},()=>{if(this.isVar())return{key:this.parseVar()};let e;return this.isIdent()?e=this.skipIdent().value:this.isPunc("(")?(this.skipPunc("("),e=this.parseExpression(),this.skipPunc(")")):e=this.parseStr(),this.skipPunc(":"),{key:e,destructuring:this.parseDestructuring()}})}}maybeBracketIndex(e){let r=e();if(this.isPunc("[")){let n;if(this.skipPunc("["),this.isPunc("]"))n={type:"iterator",expr:r};else{let s=this.isPunc(":")?void 0:this.parseExpression();if(this.isPunc(":")){this.skipPunc(":");let i=this.isPunc("]")?void 0:this.parseExpression();n={type:"slice",expr:r,from:s,to:i}}else n={type:"index",expr:r,index:s}}return this.skipPunc("]"),this.atomMaybe(()=>n)}return r}maybeSimpleIndex(e){let r=e();if(r.type!=="identity"&&this.isOp(".")&&this.skipOp("."),this.isStr()||this.isIdent()){let n={type:"index",expr:r,index:this.isStr()?this.parseStr():this.skipIdent().value};return this.atomMaybe(()=>n)}return r}parseVar(){return{type:"var",name:this.skipVar().value}}parseFilter(){let e=this.isKw("not")?this.skipKw().value:this.skipIdent().value,r=this.isPunc("(")?this.delimited("(",")",";",()=>this.parseExpression()):[];return{type:"filter",name:t.getFilterName(e,r.length),args:r}}parseFormat(){let r={type:"format",name:this.skipFormat().value};return this.isStr()?this.parseStr(r):r}parseArray(){if(this.skipPunc("["),this.isPunc("]"))return this.skipPunc("]"),{type:"array"};let e=this.parseExpression();return this.skipPunc("]"),{type:"array",expr:e}}parseObject(){return{type:"object",entries:this.delimited("{","}",{type:"op",value:","},()=>this.parseEntry(),void 0,void 0,!0)}}parseEntry(){let e;if(this.isIdent()||this.isKw()){if(e=this.isIdent()?this.skipIdent().value:this.skipKw().value,!this.isPunc(":"))return{key:e}}else if(this.isPunc("("))this.skipPunc("("),e=this.parseExpression(),this.skipPunc(")");else if(this.isStr())e=this.parseStr();else throw this.unexpected();this.skipPunc(":");let r=this.parseExpression([","]);return{key:e,value:r}}parseStr(e){let r=this.skipStr(),n;if(this.isPunc("\\(")){let s=[r.value];for(;this.isPunc("\\(");)s.push(this.parseInterpolation()),s.push(this.skipStr().value);n={type:"str",interpolated:!0,parts:s.filter(i=>i!=="")}}else n={type:"str",interpolated:!1,value:r.value};return e&&(n.format=e),n}parseInterpolation(){this.skipPunc("\\(");let e=this.parseExpression();return this.skipPunc(")"),e}parseIf(){this.skipKw("if");let e=this.parseExpression();this.skipKw("then");let r=this.parseExpression(),n=[];for(;this.isKw("elif");){this.skipKw("elif");let i=this.parseExpression();this.skipKw("then");let o=this.parseExpression();n.push({cond:i,then:o})}let s;return this.isKw("else")&&(this.skipKw("else"),s=this.parseExpression()),this.skipKw("end"),{type:"if",cond:e,then:r,elifs:n.length>0?n:void 0,else:s}}parseTry(){this.skipKw("try");let e=this.parseExpression(),r;return this.isKw("catch")&&(this.skipKw("catch"),r=this.parseExpression()),{type:"try",short:!1,body:e,catch:r}}parseLabel(){this.skipKw("label");let e=this.skipVar().value;this.skipOp("|");let r=this.parseExpression();return{type:"label",value:e,next:r}}parseBreak(){return this.skipKw("break"),{type:"break",value:this.skipVar().value}}parseReduce(){this.skipKw("reduce");let e=this.parseAtom(!1);this.skipKw("as");let r=this.skipVar().value,n=this.delimited("(",")",";",()=>this.parseExpression(),2,2);return{type:"reduce",expr:e,var:r,init:n[0],update:n[1]}}parseForeach(){this.skipKw("foreach");let e=this.parseAtom(!1);this.skipKw("as");let r=this.skipVar().value,n=this.delimited("(",")",";",()=>this.parseExpression(),2,3);return{type:"foreach",expr:e,var:r,init:n[0],update:n[1],extract:n[2]}}};Pe.Parser=Je;Je.precedence={"|":1,",":2,"//":3,"=":4,"|=":4,"+=":4,"-=":4,"*=":4,"/=":4,"%=":4,"//=":4,or:5,and:6,"==":7,"!=":7,"<":7,">":7,"<=":7,">=":7,"+":8,"-":8,"*":9,"/":9,"%":9,"?//":10};function to(t){return new Je(new Ve.Tokenizer(new eo.InputStream(t))).parse()}Pe.parse=to});var br=E(wt=>{"use strict";Object.defineProperty(wt,"__esModule",{value:!0});wt.print=void 0;var be=ge(),ro=K();function no(t){return new vt().root(t)}wt.print=no;var vt=class t{constructor(){this.indent=0}root(e){return e.expr?this.expression(e.expr,!1):""}def(e){return`def ${be.Parser.getFilterIdent(e.name)}${e.args.length>0?this.delimited("(",")","; ",e.args,r=>this.arg(r),!1):""}: ${this.expression(e.body,!1)};${e.next?" "+this.expression(e.next,!1):""}`}filterArg(e){return be.Parser.getFilterIdent(e.name)}varArg(e){return e.name}identity(e){return"."}num(e){return JSON.stringify(e.value)}str(e){let r=e.format?this.format(e.format)+" ":"";return e.interpolated?r+'"'+e.parts.map(n=>{if(typeof n=="string"){let s=JSON.stringify(n);return s.substring(1,s.length-1)}else return`\\(${this.expression(n)})`}).join("")+'"':r+JSON.stringify(e.value)}bool(e){return JSON.stringify(e.value)}null(e){return JSON.stringify(e.value)}format(e){return e.name}filter(e){return`${be.Parser.getFilterIdent(e.name)}${e.args.length>0?this.delimited("(",")",";",e.args,r=>this.expression(r,!1)):""}`}if(e){var r;return`if ${this.expression(e.cond)}${this.tab()}then ${this.expression(e.then)}${((r=e.elifs)!==null&&r!==void 0?r:[]).map(n=>{let s=`${this.br()}elif ${this.expression(n.cond)}${this.tab()}then ${this.expression(n.then)}`;return this.shiftTab(),s}).join("")}${e.else?`${this.br()}else ${this.expression(e.else)}`:""}${this.shiftTab()}end`}try(e){return e.short?`${this.expression(e.body)}?`:`try ${this.expression(e.body)}${e.catch?` catch ${this.expression(e.catch)}`:""}`}label(e){return`label ${e.value} | ${this.expression(e.next,!1)}`}break(e){return`break ${e.value}`}reduce(e){return`reduce ${this.expression(e.expr)} as ${e.var} (${this.tab()}${this.expression(e.init,!1)};${this.br()}${this.expression(e.update,!1)}${this.shiftTab()})`}foreach(e){return`foreach ${this.expression(e.expr)} as ${e.var} (${this.tab()}${this.expression(e.init,!1)};${this.br()}${this.expression(e.update,!1)}${e.extract?`;${this.br()}`+this.expression(e.extract,!1):""}${this.shiftTab()})`}binary(e){let r=this.expression(e.left,e.left.type==="binary"?be.Parser.getPrecedence(e.left.operator)<be.Parser.getPrecedence(e.operator):this.needsBrackets(e.left)),n=this.expression(e.right,e.right.type==="binary"?be.Parser.getPrecedence(e.right.operator)<be.Parser.getPrecedence(e.operator):this.needsBrackets(e.right));return`${r}${e.operator===","?"":" "}${e.operator} ${n}`}unary(e){return`${e.operator}${e.expr.type!=="num"?" ":""}${this.expression(e.expr)}`}index(e){return`${this.expression(e.expr)}${typeof e.index=="string"?`${e.expr.type==="identity"?"":"."}${e.index}`:`[${this.expression(e.index,!1)}]`}`}slice(e){return`${this.expression(e.expr)}[${e.from?this.expression(e.from,!1):""}:${e.to?this.expression(e.to,!1):""}]`}iterator(e){return`${this.expression(e.expr)}[]`}array(e){return`[${e.expr?this.expression(e.expr,!1):""}]`}object(e){return e.entries.length===0?"{}":`{${this.tab()}${this.delimited("","",`,${this.br()}`,e.entries,r=>this.objectEntry(r))},${this.shiftTab()}}`}var(e){return`${e.name}`}varDeclaration(e){return`${this.expression(e.expr,this.varDeclarationNeedsBrackets(e.expr))} as ${e.destructuring.map(r=>this.destructuring(r)).join(" ?// ")} | ${this.expression(e.next,!1)}`}arrayDestructuring(e){return this.delimited("[ "," ]",", ",e.destructuring,r=>this.destructuring(r))}objectDestructuring(e){return this.delimited("{ "," }",", ",e.entries,r=>this.objectDestructuringEntry(r),!1)}recursiveDescent(e){return".."}expression(e,r=this.needsBrackets(e)){switch(e.type){case"binary":return this.brackets(this.binary(e),r);default:return this.brackets(this.atom(e),r)}}atom(e){switch(e.type){case"def":return this.def(e);case"identity":return this.identity(e);case"num":return this.num(e);case"str":return this.str(e);case"bool":return this.bool(e);case"null":return this.null(e);case"format":return this.format(e);case"filter":return this.filter(e);case"if":return this.if(e);case"try":return this.try(e);case"reduce":return this.reduce(e);case"var":return this.var(e);case"varDeclaration":return this.varDeclaration(e);case"foreach":return this.foreach(e);case"label":return this.label(e);case"break":return this.break(e);case"unary":return this.unary(e);case"index":return this.index(e);case"slice":return this.slice(e);case"iterator":return this.iterator(e);case"array":return this.array(e);case"object":return this.object(e);case"recursiveDescent":return this.recursiveDescent(e);default:throw new ro.JqPrintError(`Unknown ast node: ${e.type}`)}}delimited(e,r,n,s,i,o){return`${e}${s.map(i).join(n)}${o&&s.length>0?n:""}${r}`}arg(e){switch(e.type){case"filterArg":return this.filterArg(e);case"varArg":return this.varArg(e)}}objectEntry(e){return`${this.objectEntryKey(e.key)}${e.value?`: ${this.expression(e.value,this.objectValueNeedsBrackets(e.value))}`:""}`}objectDestructuringEntry(e){return e.destructuring===void 0?this.var(e.key):`${this.objectEntryKey(e.key)}: ${this.destructuring(e.destructuring)}`}objectEntryKey(e){return typeof e=="string"?e:this.expression(e,e.type!=="str")}destructuring(e){switch(e.type){case"var":return this.var(e);case"arrayDestructuring":return this.arrayDestructuring(e);case"objectDestructuring":return this.objectDestructuring(e)}}brackets(e,r){return r?`(${e})`:e}needsBrackets(e){let r=["identity","num","str","bool","null","format","filter","var","index","slice","iterator","array","object","recursiveDescent","unary","label","break","if","reduce","foreach"];return!(e.type==="try"&&e.short||r.includes(e.type))}objectValueNeedsBrackets(e){let r=["identity","num","str","bool","null","format","filter","var","index","slice","iterator","array","object","recursiveDescent"];return!(e.type==="try"&&e.short||(e.type==="unary"?e.expr.type==="num":r.includes(e.type)))}varDeclarationNeedsBrackets(e){let r=["identity","num","str","bool","null","format","filter","var","index","slice","iterator","array","object","recursiveDescent"];return!(e.type==="try"&&e.short||r.includes(e.type))}br(){let e=`
`;for(let r=0;r<this.indent;r++)e+=t.INDENT;return e}tab(){return this.indent++,this.br()}shiftTab(){return this.indent--,this.br()}};vt.INDENT="  "});var Wn=E($t=>{"use strict";Object.defineProperty($t,"__esModule",{value:!0});$t.format=void 0;var so=ge(),io=br(),oo=t=>(0,io.print)((0,so.parse)(t));$t.format=oo});var Ke=E(W=>{"use strict";Object.defineProperty(W,"__esModule",{value:!0});W.cannotSliceError=W.cannotIndexError=W.notImplementedError=W.notDefinedError=void 0;var xt=K(),vr=Q();function ao(t){return new xt.JqEvaluateError(`'${t}' is not defined`)}W.notDefinedError=ao;function lo(t){return new xt.NotImplementedError(`Feature '${t}' is not implemented`)}W.notImplementedError=lo;function uo(t,e){return new xt.JqEvaluateError(`Cannot index ${(0,vr.typeOf)(t)} with ${(0,vr.typeOf)(e)}`)}W.cannotIndexError=uo;function co(t){return new xt.JqEvaluateError(`Cannot slice ${(0,vr.typeOf)(t)}`)}W.cannotSliceError=co});var kt=E(_t=>{"use strict";Object.defineProperty(_t,"__esModule",{value:!0});_t.compare=void 0;var oe=Q(),Ln={null:0,boolean:1,number:2,string:3,array:4,object:5};function po(t,e){return Ln[t]-Ln[e]}function Et(t,e){var r,n;let s=(0,oe.typeOf)(t),i=po(s,(0,oe.typeOf)(e));if(i!==0)return i;switch(s){case oe.Type.null:return 0;case oe.Type.boolean:case oe.Type.number:return t-e;case oe.Type.string:for(let u=0;u<Math.max(t.length,e.length);u++){let f=(r=t.codePointAt(u))!==null&&r!==void 0?r:-1,b=(n=e.codePointAt(u))!==null&&n!==void 0?n:-1,w=f-b;if(w!==0)return w}return 0;case oe.Type.array:for(let u=0;u<Math.max(t.length,e.length);u++){if(t[u]===void 0)return-1;if(e[u]===void 0)return 1;let f=Et(t[u],e[u]);if(f!==0)return f}return 0;case oe.Type.object:let o=Object.keys(t).sort(),g=Object.keys(e).sort(),_=Et(o,g);if(_!==0)return _;let a=o.map(u=>t[u]),l=g.map(u=>e[u]);return Et(a,l)}}_t.compare=Et});var Q=E(d=>{"use strict";Object.defineProperty(d,"__esModule",{value:!0});d.transformRegExpMatch=d.sort=d.has=d.keys=d.assertString=d.assertNumber=d.range=d.delPaths=d.getChildPaths=d.shallowClone=d.deepClone=d.deepMerge=d.resolveNormalizedSliceAccessor=d.normalizeLeadingSliceAccessors=d.normalizeSliceAccessor=d.normalizeArrayIndex=d.access=d.indices=d.toString=d.recursiveDescent=d.repeatString=d.isTrue=d.isPaths=d.isPath=d.many=d.single=d.someOfType=d.typeIsOneOf=d.typesMatchCommutative=d.typesMatch=d.typesEqual=d.isAtom=d.typeOf=d.Type=d.collectValues=d.generatePaths=d.generateValues=d.generateItems=d.createItem=d.isSliceAccessor=d.createSliceAccessor=void 0;var we=K(),wr=Ke(),Un=kt();function fo(t,e){return{start:t,end:e}}d.createSliceAccessor=fo;function ee(t){return t&&(t.start===null||Number.isInteger(t.start))&&(t.end===null||Number.isInteger(t.end))}d.isSliceAccessor=ee;function Zn(t,e=[]){return{value:t,path:e}}d.createItem=Zn;function*ho(t){for(let e of t)yield Zn(e)}d.generateItems=ho;function*Gn(t){for(let e of t)yield e.value}d.generateValues=Gn;function*mo(t){for(let e of t)yield e.path}d.generatePaths=mo;function yo(t){return Array.from(Gn(t))}d.collectValues=yo;var I;(function(t){t.null="null",t.boolean="boolean",t.number="number",t.string="string",t.array="array",t.object="object"})(I=d.Type||(d.Type={}));function T(t){return Array.isArray(t)?I.array:t===null?I.null:typeof t}d.typeOf=T;function go(t){let e=T(t);return e!=="array"&&e!=="object"}d.isAtom=go;function bo(t,e){return T(t)===T(e)}d.typesEqual=bo;function te(t,e,r,n=r){return T(t)===r&&T(e)===n}d.typesMatch=te;function vo(t,e,r,n){return te(t,e,r,n)||te(t,e,n,r)}d.typesMatchCommutative=vo;function ze(t,...e){return e.some(r=>T(t)===r)}d.typeIsOneOf=ze;function wo(t,...e){return e.some(r=>T(r)===t)}d.someOfType=wo;function*$o(t){yield t}d.single=$o;function*xo(t){yield*t}d.many=xo;function Xn(t){return Array.isArray(t)&&t.every(e=>{switch(typeof e){case"string":return!0;case"number":return Number.isInteger(e);case"object":return ee(e);default:return!1}})}d.isPath=Xn;function Eo(t){return Array.isArray(t)&&t.every(e=>Xn(e))}d.isPaths=Eo;function _o(t){return t!==null&&t!==!1}d.isTrue=_o;function ko(t,e){if(e<=0)return null;let r="";for(let n=0;n<Math.floor(e);n++)r+=t;return r}d.repeatString=ko;function*$r(t){if(yield t,T(t)==="object")for(let e of Object.values(t))yield*$r(e);else if(T(t)==="array")for(let e of t)yield*$r(e)}d.recursiveDescent=$r;function Io(t){switch(T(t)){case I.null:return"null";case I.boolean:case I.number:return t.toString();case I.string:return t;case I.array:case I.object:return JSON.stringify(t)}}d.toString=Io;function Hn(t,e){let r=[];for(let n=0;n<t.length;n++)for(let s=0;s<e.length&&(0,Un.compare)(t[n+s],e[s])===0;s++)s+1===e.length&&r.push(n);return r}d.indices=Hn;function Yn(t,e){var r,n,s,i;if(te(e,t,I.number,I.array))return(r=t[It(t.length,e)])!==null&&r!==void 0?r:null;if(te(e,t,I.string,I.object))return(n=t[e])!==null&&n!==void 0?n:null;if(te(e,t,I.array,I.array))return Hn(t,e);if(T(t)===I.null&&(ze(e,I.number,I.string)||ee(e)))return null;if(ze(t,I.array,I.string)&&ee(e))return t.slice((s=e.start)!==null&&s!==void 0?s:void 0,(i=e.end)!==null&&i!==void 0?i:void 0);throw ee(e)?(0,wr.cannotSliceError)(t):(0,wr.cannotIndexError)(t,e)}d.access=Yn;function It(t,e){return e<0?t+e:e}d.normalizeArrayIndex=It;function Ot(t,e){let{start:r,end:n}=e,s=Math.max(0,Math.min(It(t,n??t),t));return{start:Math.max(0,Math.min(It(t,r??0),s)),end:s}}d.normalizeSliceAccessor=Ot;function Qn(t,e){if(!ee(e[0]))return e;let r=1,n=Ot(t,e[0]);for(;ee(e[r]);){t=n.end-n.start;let s=Ot(t,e[r]);n={start:n.start+s.start,end:n.start+s.end},r++}if(r<e.length){let s=e[r];if(typeof s!="number")throw(0,wr.cannotIndexError)([],s);return[n.start+s,...e.slice(r+1)]}else return[n]}d.normalizeLeadingSliceAccessors=Qn;function es(t){let e=[];for(let r=t.start;r<t.end;r++)e.push(r);return e}d.resolveNormalizedSliceAccessor=es;function ts(t,e){if(te(t,e,I.object,I.object)){let r=new Set(Object.keys(t).concat(Object.keys(e))),n=[];for(let s of r)n.push([s,ts(t[s],e[s])]);return Object.fromEntries(n)}else return e===void 0?t:e}d.deepMerge=ts;function xr(t){switch(T(t)){case I.null:case I.boolean:case I.number:case I.string:return t;case I.array:return t.map(xr);case I.object:return Object.fromEntries(Object.entries(t).map(xr))}}d.deepClone=xr;function rs(t){switch(T(t)){case I.null:case I.boolean:case I.number:case I.string:return t;case I.array:return[...t];case I.object:return Object.assign({},t)}}d.shallowClone=rs;function ns(t){let e={};for(let r of t.filter(n=>n.length>1)){let n=r[0];if(ee(n))throw new we.JqEvaluateError("getChildPaths: Cannot handle paths that are longer than 1, and start in a slice accessor");n in e||(e[n]=[]),e[n].push(r.slice(1))}return e}d.getChildPaths=ns;function ss(t,e){if(e.length===0)return t;let r=T(t);if(ze(t,I.array,I.object)){let n=rs(t),s=e.map(i=>Qn(T(t)===I.array?t.length:0,i));for(let i of s){if(i.length!==1)continue;let o=i[0];if(Yn(n,o),ee(o)){let g=Ot(t.length,o);for(let _ of es(g))delete n[_]}else delete n[o]}r===I.array&&(n=n.filter(i=>i!==void 0));for(let[i,o]of Object.entries(ns(s)))i in n&&(n[i]=ss(n[i],o));return n}else throw new we.JqEvaluateError(`Cannot delete fields from ${r}`)}d.delPaths=ss;function*is(t,e,r){let n,s,i;e!==void 0&&r!==void 0?(n=ve(t),s=ve(e),i=ve(r)):e!==void 0?(n=ve(t),s=ve(e),i=1):(n=0,s=ve(t),i=1);for(let o=n;o<s;o+=i)yield o}d.range=is;function ve(t){if(T(t)!==I.number)throw new we.JqEvaluateError(`Got ${T(t)}, number expected`);return t}d.assertNumber=ve;function Oo(t){if(T(t)!==I.string)throw new we.JqEvaluateError(`Got ${T(t)}, string expected`);return t}d.assertString=Oo;function jo(t){if(!ze(t,I.array,I.object))throw new we.JqEvaluateError(`${T(t)} has no keys`);return T(t)===I.array?Array.from(is(t.length)):Object.keys(t)}d.keys=jo;function Po(t,e){if(!te(t,e,I.array,I.number)&&!te(t,e,I.object,I.string))throw new we.JqEvaluateError(`Cannot check whether ${T(t)} has a ${T(e)} key`);return e in t}d.has=Po;function So(t){return t.sort(Un.compare)}d.sort=So;function qo(t){let e=t.indices;if(t.index===void 0||e===void 0)throw new we.JqEvaluateError("RegExp match item transformation error");return{offset:t.index,length:t[0].length,string:t[0],captures:t.slice(1).map((n,s)=>({offset:e[s+1][0],length:n.length,string:n,name:null}))}}d.transformRegExpMatch=qo});var Er=E(jt=>{"use strict";Object.defineProperty(jt,"__esModule",{value:!0});jt.setPath=void 0;var z=Q(),os=K();function as(t,e,r){if(e.length===0)return r;let n=(0,z.typeOf)(t),s=(0,z.normalizeLeadingSliceAccessors)(n===z.Type.array?t.length:0,e),i=s[0],o=t==null?(0,z.typeOf)(i)===z.Type.string?{}:[]:(0,z.shallowClone)(t);if((0,z.access)(o,i),s.length===1)if((0,z.isSliceAccessor)(i)){if((0,z.typeOf)(r)!==z.Type.array)throw new os.JqEvaluateError("An array slice can only be assigned an array");o.splice(i.start,i.end-i.start,...r)}else o[i]=r;else{if((0,z.isSliceAccessor)(i))throw new os.JqEvaluateError("setPath: Leading slice accessors are not normalized");o[i]=as(o[i],s.slice(1),r)}return o}jt.setPath=as});var us=E(Se=>{"use strict";Object.defineProperty(Se,"__esModule",{value:!0});Se.combineIterators=Se.nestedIterators=void 0;function*ls(t,e){let r=!0,n=[];for(let s of t){let i=r?e:n;yield[s,function*(){for(let o of i)r&&n.push(o),yield o}()],r=!1}}Se.nestedIterators=ls;function*Ao(t,e){for(let[r,n]of ls(t,e))for(let s of n)yield[r,s]}Se.combineIterators=Ao});var _r=E(Pt=>{"use strict";Object.defineProperty(Pt,"__esModule",{value:!0});Pt.getPath=void 0;var ae=Q(),To=K();function cs(t,e){var r;if(e.length===0)return t;let n=(0,ae.typeOf)(t),s=(0,ae.normalizeLeadingSliceAccessors)(n===ae.Type.array?t.length:0,e),i=s[0];if(t==null&&(t=(0,ae.typeOf)(i)===ae.Type.string?{}:[]),(0,ae.access)(t,i),s.length===1)return(0,ae.isSliceAccessor)(i)?t.slice(i.start,i.end):(r=t[i])!==null&&r!==void 0?r:null;if((0,ae.isSliceAccessor)(i))throw new To.JqEvaluateError("getPath: Leading slice accessors are not normalized");return cs(t[i],s.slice(1))}Pt.getPath=cs});var kr=E(re=>{"use strict";Object.defineProperty(re,"__esModule",{value:!0});re.isBinaryOperatorType=re.typeOfBinaryOperator=re.BinaryOperatorType=void 0;var q;(function(t){t[t.normal=0]="normal",t[t.assignment=1]="assignment",t[t.boolean=2]="boolean",t[t.pipe=3]="pipe",t[t.comma=4]="comma",t[t.alternative=5]="alternative",t[t.destructuringAlternative=6]="destructuringAlternative"})(q=re.BinaryOperatorType||(re.BinaryOperatorType={}));var No={"|":q.pipe,",":q.comma,"//":q.alternative,"=":q.assignment,"|=":q.assignment,"+=":q.assignment,"-=":q.assignment,"*=":q.assignment,"/=":q.assignment,"%=":q.assignment,"//=":q.assignment,or:q.boolean,and:q.boolean,"==":q.normal,"!=":q.normal,"<":q.normal,">":q.normal,"<=":q.normal,">=":q.normal,"+":q.normal,"-":q.normal,"*":q.normal,"/":q.normal,"%":q.normal,"?//":q.destructuringAlternative};function ps(t){return No[t]}re.typeOfBinaryOperator=ps;function Co(t,e){return ps(t)===e}re.isBinaryOperatorType=Co});var ms=E(F=>{"use strict";Object.defineProperty(F,"__esModule",{value:!0});F.evaluateAlternativeOperator=F.evaluateNormalBinaryOperator=F.evaluateBooleanOperator=F.evaluateArithmeticUpdateAssignment=F.evaluateSimpleAssignment=F.applyNormalBinaryOperator=void 0;var x=Q(),$e=kt(),St=K(),ds=Er(),Ir=us(),Do=_r(),fs=kr();function xe(t,e,r){return new St.JqEvaluateError(`Operator ${t} cannot be applied to ${(0,x.typeOf)(e)} and ${(0,x.typeOf)(r)}`)}function Fo(t){return new St.JqEvaluateError(`applyBinary: Cannot apply operator '${t}'`)}function hs(){return new St.JqEvaluateError("Division by zero")}function Or(t,e,r){switch(t){case"==":return(0,$e.compare)(e,r)===0;case"!=":return(0,$e.compare)(e,r)!==0;case"<":return(0,$e.compare)(e,r)<0;case">":return(0,$e.compare)(e,r)>0;case"<=":return(0,$e.compare)(e,r)<=0;case">=":return(0,$e.compare)(e,r)>=0;case"+":if((0,x.someOfType)(x.Type.null,e,r))return(0,x.typeOf)(e)===x.Type.null?r:e;if(!(0,x.typesEqual)(e,r))throw xe(t,e,r);switch((0,x.typeOf)(e)){case x.Type.string:case x.Type.number:return e+r;case x.Type.array:return[...e,...r];case x.Type.object:return Object.assign(Object.assign({},e),r);default:throw xe(t,e,r)}case"-":if(!(0,x.typesEqual)(e,r))throw xe(t,e,r);switch((0,x.typeOf)(e)){case x.Type.number:return e-r;case x.Type.array:return e.filter(n=>!r.some(s=>(0,$e.compare)(n,s)===0));default:throw xe(t,e,r)}case"*":if((0,x.typesMatch)(e,r,x.Type.number))return e*r;if((0,x.typesMatchCommutative)(e,r,x.Type.string,x.Type.number)){let n=(0,x.typeOf)(e)===x.Type.string?e:r,s=(0,x.typeOf)(e)===x.Type.number?e:r;return(0,x.repeatString)(n,s)}else if((0,x.typesMatch)(e,r,x.Type.object))return(0,x.deepMerge)(e,r);throw xe(t,e,r);case"/":if((0,x.typesMatch)(e,r,x.Type.number)){if(r===0)throw hs();return e/r}else if((0,x.typesMatch)(e,r,x.Type.string))return e.split(r);throw xe(t,e,r);case"%":if((0,x.typesMatch)(e,r,x.Type.number)){if(Math.floor(r)===0)throw hs();return Math.floor(e)%Math.floor(r)}throw xe(t,e,r);default:throw Fo(t)}}F.applyNormalBinaryOperator=Or;function*Mo(t,e,r){for(let[n,s]of(0,Ir.nestedIterators)((0,x.generateValues)(r),(0,x.generatePaths)(e))){let i=t.value;for(let o of s)i=(0,ds.setPath)(i,o,(0,x.deepClone)(n));yield(0,x.createItem)(i)}}F.evaluateSimpleAssignment=Mo;function*Bo(t,e,r,n){for(let[s,i]of(0,Ir.nestedIterators)((0,x.generateValues)(n),(0,x.generatePaths)(r))){let o=e.value;for(let g of i){let _=t.slice(0,-1),a=(0,Do.getPath)(o,g);o=(0,ds.setPath)(o,g,(0,fs.isBinaryOperatorType)(_,fs.BinaryOperatorType.alternative)?Ko(a,s):Or(_,a,s))}yield(0,x.createItem)(o)}}F.evaluateArithmeticUpdateAssignment=Bo;function*Vo(t,e,r){if(t!=="and"&&t!=="or")throw new St.JqEvaluateError(`evaluateBooleanOperator: Unexpected operator '${t}'`);let n=!0,s=[];for(let i of e){let o=n?r:s;if(t==="and"&&!(0,x.isTrue)(i.value)){yield(0,x.createItem)(!1);continue}else if(t==="or"&&(0,x.isTrue)(i.value)){yield(0,x.createItem)(!0);continue}for(let g of o)n&&s.push(g),yield(0,x.createItem)((0,x.isTrue)(g.value));n=!1}}F.evaluateBooleanOperator=Vo;function*Jo(t,e,r){for(let[n,s]of(0,Ir.combineIterators)(r,e))yield(0,x.createItem)(Or(t,s.value,n.value))}F.evaluateNormalBinaryOperator=Jo;function Ko(t,e){return(0,x.isTrue)(t)?t:e}function*zo(t,e){let r=!1;for(let n of t)(0,x.isTrue)(n.value)&&(yield n,r=!0);r||(yield*e)}F.evaluateAlternativeOperator=zo});var jr=E(qt=>{"use strict";Object.defineProperty(qt,"__esModule",{value:!0});qt.generateCombinations=void 0;function*Ro(t){let e=t.map(r=>0);do yield Wo(t,e);while(Lo(t,e))}qt.generateCombinations=Ro;function Wo(t,e){return e.map((r,n)=>t[n][r])}function Lo(t,e){for(let r=e.length-1;r>=0;r--){if(e[r]++,e[r]<t[r].length)return!0;e[r]=0}return!1}});var ys=E(At=>{"use strict";Object.defineProperty(At,"__esModule",{value:!0});At.generateObjects=void 0;var Uo=jr();function*Zo(t){let e=t.flat();for(let r of(0,Uo.generateCombinations)(e))yield Go(r)}At.generateObjects=Zo;function Go(t){let e=t.reduce((r,n,s)=>(s%2===0?r.push([n]):r[r.length-1].push(n),r),[]);return Object.fromEntries(e)}});var bs=E(Tt=>{"use strict";Object.defineProperty(Tt,"__esModule",{value:!0});Tt.applyFormat=void 0;var le=Ke(),gs={"@text"(t){throw(0,le.notImplementedError)("@text")},"@json"(t){throw(0,le.notImplementedError)("@json")},"@html"(t){throw(0,le.notImplementedError)("@html")},"@uri"(t){throw(0,le.notImplementedError)("@uri")},"@csv"(t){throw(0,le.notImplementedError)("@csv")},"@tsv"(t){throw(0,le.notImplementedError)("@tsv")},"@sh"(t){throw(0,le.notImplementedError)("@sh")},"@base64"(t){return btoa(t)},"@base64d"(t){return atob(t)}};function Xo(t,e){if(t===void 0)return e;if(!gs[t.name])throw(0,le.notDefinedError)(t.name);return gs[t.name](e)}Tt.applyFormat=Xo});var Pr=E(qe=>{"use strict";Object.defineProperty(qe,"__esModule",{value:!0});qe.isNativeFilter=qe.wrapBareNativeFilters=void 0;var vs=Q();function Ho(t){return Object.fromEntries(Object.entries(t).map(([e,r])=>[e,(n,...s)=>(0,vs.generateItems)(r(n.value,...(0,vs.collectValues)(s)))]))}qe.wrapBareNativeFilters=Ho;function Yo(t){return typeof t=="function"}qe.isNativeFilter=Yo});var ws=E(Ct=>{"use strict";Object.defineProperty(Ct,"__esModule",{value:!0});Ct.builtinNativeFilters=void 0;var O=Q(),Qo=Pr(),c=Ke(),Nt=kt(),ea=Sr();Ct.builtinNativeFilters=Object.assign({*"path/1"(t,e){yield(0,O.createItem)(e.path)}},(0,Qo.wrapBareNativeFilters)({*"_group_by_impl/1"(t,e){let r=t.map((o,g)=>({value:o,ref:e[g]})).sort((o,g)=>(0,Nt.compare)(o.ref,g.ref)),n=-1,s=[],i=[];for(let o of r)(n===-1||(0,Nt.compare)(s[n],o.ref))&&(s.push(o.ref),i.push([]),n++),i[n].push(o.value);yield i},*"_match_impl/3"(t,e,r,n){let s=(0,O.assertString)(t),i=new RegExp(e,(r??"")+"d");if(r&&r.includes("g")){let o=Array.from(s.matchAll(i));n?yield o.length!==0:yield o.map(O.transformRegExpMatch)}else{let o=s.match(i);n?yield!!o:o&&(yield[(0,O.transformRegExpMatch)(o)])}},*"_max_by_impl/1"(){throw(0,c.notImplementedError)("_max_by_impl/1")},*"_min_by_impl/1"(){throw(0,c.notImplementedError)("_min_by_impl/1")},*"_sort_by_impl/1"(t,e){yield t.map((r,n)=>({item:r,ref:e[n]})).sort(Nt.compare).map(({item:r})=>r)},*"_strindices/1"(t,e){yield(0,O.indices)(t,e)},*"acos/0"(){throw(0,c.notImplementedError)("acos/0")},*"acosh/0"(){throw(0,c.notImplementedError)("acosh/0")},*"asin/0"(){throw(0,c.notImplementedError)("asin/0")},*"asinh/0"(){throw(0,c.notImplementedError)("asinh/0")},*"atan/0"(){throw(0,c.notImplementedError)("atan/0")},*"atan2/2"(){throw(0,c.notImplementedError)("atan2/2")},*"atanh/0"(){throw(0,c.notImplementedError)("atanh/0")},*"builtins/0"(){throw(0,c.notImplementedError)("builtins/0")},*"cbrt/0"(){throw(0,c.notImplementedError)("cbrt/0")},*"ceil/0"(){throw(0,c.notImplementedError)("ceil/0")},*"contains/1"(){throw(0,c.notImplementedError)("contains/1")},*"copysign/2"(){throw(0,c.notImplementedError)("copysign/2")},*"cos/0"(){throw(0,c.notImplementedError)("cos/0")},*"cosh/0"(){throw(0,c.notImplementedError)("cosh/0")},*"debug/0"(){throw(0,c.notImplementedError)("debug/0")},*"delpaths/1"(t,e){if(!(0,O.isPaths)(e))throw new ea.JqArgumentError("Expected an array of paths");yield(0,O.delPaths)(t,e)},*"drem/2"(){throw(0,c.notImplementedError)("drem/2")},*"empty/0"(){},*"endswith/1"(t,e){(0,O.assertString)(t),(0,O.assertString)(e),yield t.endsWith(e)},*"env/0"(){throw(0,c.notImplementedError)("env/0")},*"erf/0"(){throw(0,c.notImplementedError)("erf/0")},*"erfc/0"(){throw(0,c.notImplementedError)("erfc/0")},*"error/0"(){throw(0,c.notImplementedError)("error/0")},*"exp/0"(){throw(0,c.notImplementedError)("exp/0")},*"exp10/0"(){throw(0,c.notImplementedError)("exp10/0")},*"exp2/0"(){throw(0,c.notImplementedError)("exp2/0")},*"explode/0"(){throw(0,c.notImplementedError)("explode/0")},*"expm1/0"(){throw(0,c.notImplementedError)("expm1/0")},*"fabs/0"(){throw(0,c.notImplementedError)("fabs/0")},*"fdim/2"(){throw(0,c.notImplementedError)("fdim/2")},*"floor/0"(){throw(0,c.notImplementedError)("floor/0")},*"fma/3"(){throw(0,c.notImplementedError)("fma/3")},*"fmax/2"(){throw(0,c.notImplementedError)("fmax/2")},*"fmin/2"(){throw(0,c.notImplementedError)("fmin/2")},*"fmod/2"(){throw(0,c.notImplementedError)("fmod/2")},*"format/1"(){throw(0,c.notImplementedError)("format/1")},*"frexp/0"(){throw(0,c.notImplementedError)("frexp/0")},*"fromjson/0"(){throw(0,c.notImplementedError)("fromjson/0")},*"gamma/0"(){throw(0,c.notImplementedError)("gamma/0")},*"get_jq_origin/0"(){throw(0,c.notImplementedError)("get_jq_origin/0")},*"get_prog_origin/0"(){throw(0,c.notImplementedError)("get_prog_origin/0")},*"get_search_list/0"(){throw(0,c.notImplementedError)("get_search_list/0")},*"getpath/1"(){throw(0,c.notImplementedError)("getpath/1")},*"gmtime/0"(){throw(0,c.notImplementedError)("gmtime/0")},*"halt/0"(){throw(0,c.notImplementedError)("halt/0")},*"halt_error/1"(){throw(0,c.notImplementedError)("halt_error/1")},*"has/1"(t,e){yield(0,O.has)(t,e)},*"hypot/2"(){throw(0,c.notImplementedError)("hypot/2")},*"implode/0"(){throw(0,c.notImplementedError)("implode/0")},*"infinite/0"(){throw(0,c.notImplementedError)("infinite/0")},*"input/0"(){throw(0,c.notImplementedError)("input/0")},*"input_filename/0"(){throw(0,c.notImplementedError)("input_filename/0")},*"input_line_number/0"(){throw(0,c.notImplementedError)("input_line_number/0")},*"isinfinite/0"(){throw(0,c.notImplementedError)("isinfinite/0")},*"isnan/0"(){throw(0,c.notImplementedError)("isnan/0")},*"isnormal/0"(){throw(0,c.notImplementedError)("isnormal/0")},*"j0/0"(){throw(0,c.notImplementedError)("j0/0")},*"j1/0"(){throw(0,c.notImplementedError)("j1/0")},*"jn/2"(){throw(0,c.notImplementedError)("jn/2")},*"keys/0"(t){yield(0,O.sort)((0,O.keys)(t))},*"keys_unsorted/0"(t){yield(0,O.keys)(t)},*"ldexp/2"(){throw(0,c.notImplementedError)("ldexp/2")},*"length/0"(t){let e=(0,O.typeOf)(t);switch((0,O.typeOf)(t)){case O.Type.null:yield 0;break;case O.Type.string:case O.Type.array:yield t.length;break;case O.Type.object:yield Object.keys(t).length;break;case O.Type.boolean:case O.Type.number:default:throw Error(`${e} has no length`)}},*"lgamma/0"(){throw(0,c.notImplementedError)("lgamma/0")},*"lgamma_r/0"(){throw(0,c.notImplementedError)("lgamma_r/0")},*"localtime/0"(){throw(0,c.notImplementedError)("localtime/0")},*"log/0"(){throw(0,c.notImplementedError)("log/0")},*"log10/0"(){throw(0,c.notImplementedError)("log10/0")},*"log1p/0"(){throw(0,c.notImplementedError)("log1p/0")},*"log2/0"(){throw(0,c.notImplementedError)("log2/0")},*"logb/0"(){throw(0,c.notImplementedError)("logb/0")},*"ltrimstr/1"(){throw(0,c.notImplementedError)("ltrimstr/1")},*"max/0"(){throw(0,c.notImplementedError)("max/0")},*"min/0"(){throw(0,c.notImplementedError)("min/0")},*"mktime/0"(){throw(0,c.notImplementedError)("mktime/0")},*"modf/0"(){throw(0,c.notImplementedError)("modf/0")},*"modulemeta/0"(){throw(0,c.notImplementedError)("modulemeta/0")},*"nan/0"(){throw(0,c.notImplementedError)("nan/0")},*"nearbyint/0"(){throw(0,c.notImplementedError)("nearbyint/0")},*"nextafter/2"(){throw(0,c.notImplementedError)("nextafter/2")},*"nexttoward/2"(){throw(0,c.notImplementedError)("nexttoward/2")},*"not/0"(t){yield!(0,O.isTrue)(t)},*"now/0"(){throw(0,c.notImplementedError)("now/0")},*"pow/2"(){throw(0,c.notImplementedError)("pow/2")},*"pow10/0"(){throw(0,c.notImplementedError)("pow10/0")},*"range/2"(t,e,r){yield*(0,O.range)(e,r)},*"remainder/2"(){throw(0,c.notImplementedError)("remainder/2")},*"rint/0"(){throw(0,c.notImplementedError)("rint/0")},*"round/0"(t){yield Math.round((0,O.assertNumber)(t))},*"rtrimstr/1"(){throw(0,c.notImplementedError)("rtrimstr/1")},*"scalars_or_empty/0"(){throw(0,c.notImplementedError)("scalars_or_empty/0")},*"scalb/2"(){throw(0,c.notImplementedError)("scalb/2")},*"scalbln/2"(){throw(0,c.notImplementedError)("scalbln/2")},*"setpath/2"(){throw(0,c.notImplementedError)("setpath/2")},*"significand/0"(){throw(0,c.notImplementedError)("significand/0")},*"sin/0"(){throw(0,c.notImplementedError)("sin/0")},*"sinh/0"(){throw(0,c.notImplementedError)("sinh/0")},*"sort/0"(t){yield t.sort(Nt.compare)},*"split/1"(t,e){yield(0,O.assertString)(t).split((0,O.assertString)(e))},*"sqrt/0"(){throw(0,c.notImplementedError)("sqrt/0")},*"startswith/1"(t,e){(0,O.assertString)(t),(0,O.assertString)(e),yield t.startsWith(e)},*"stderr/0"(){throw(0,c.notImplementedError)("stderr/0")},*"strflocaltime/1"(){throw(0,c.notImplementedError)("strflocaltime/1")},*"strftime/1"(){throw(0,c.notImplementedError)("strftime/1")},*"strptime/1"(){throw(0,c.notImplementedError)("strptime/1")},*"tan/0"(){throw(0,c.notImplementedError)("tan/0")},*"tanh/0"(){throw(0,c.notImplementedError)("tanh/0")},*"tgamma/0"(){throw(0,c.notImplementedError)("tgamma/0")},*"tojson/0"(){throw(0,c.notImplementedError)("tojson/0")},*"tonumber/0"(){throw(0,c.notImplementedError)("tonumber/0")},*"tostring/0"(t){yield(0,O.toString)(t)},*"trunc/0"(){throw(0,c.notImplementedError)("trunc/0")},*"type/0"(t){yield(0,O.typeOf)(t)},*"utf8bytelength/0"(){throw(0,c.notImplementedError)("utf8bytelength/0")},*"y0/0"(){throw(0,c.notImplementedError)("y0/0")},*"y1/0"(){throw(0,c.notImplementedError)("y1/0")},*"yn/2"(){throw(0,c.notImplementedError)("yn/2")}}))});var $s=E(Dt=>{"use strict";Object.defineProperty(Dt,"__esModule",{value:!0});Dt.parseBuiltinJqFilters=void 0;var ta=ge(),ra=K();function na(t){let e={},r=(0,ta.parse)(t).expr;for(;r;){if(r.type!=="def")throw new ra.JqEvaluateError("Could not parse the built-in jq filters");e[r.name]=r,r=r.next}return e}Dt.parseBuiltinJqFilters=na});var xs=E(Ft=>{"use strict";Object.defineProperty(Ft,"__esModule",{value:!0});Ft.builtinJqFilters=void 0;var sa=$s();Ft.builtinJqFilters=(0,sa.parseBuiltinJqFilters)(`
def halt_error: halt_error(5);
def error(msg): msg|error;
def map(f): [.[] | f];
def select(f): if f then . else empty end;
def sort_by(f): _sort_by_impl(map([f]));
def group_by(f): _group_by_impl(map([f]));
def unique: group_by(.) | map(.[0]);
def unique_by(f): group_by(f) | map(.[0]);
def max_by(f): _max_by_impl(map([f]));
def min_by(f): _min_by_impl(map([f]));
def add: reduce .[] as $x (null; . + $x);
def del(f): delpaths([path(f)]);
def _assign(paths; $value): reduce path(paths) as $p (.; setpath($p; $value));
def _modify(paths; update):
    reduce path(paths) as $p (.;
        . as $dot
      | null
      | label $out
      | ($dot | getpath($p)) as $v
      | (
          (   $v
            | update
            | (., break $out) as $v
            | $dot
            | setpath($p; $v)
          ),
          (
              $dot
            | delpaths([$p])
          )
        )
    );
def map_values(f): .[] |= f;

# recurse
def recurse(f): def r: ., (f | r); r;
def recurse(f; cond): def r: ., (f | select(cond) | r); r;
def recurse: recurse(.[]?);
def recurse_down: recurse;

def to_entries: [keys_unsorted[] as $k | {key: $k, value: .[$k]}];
def from_entries: map({(.key // .Key // .name // .Name): (if has("value") then .value else .Value end)}) | add | .//={};
def with_entries(f): to_entries | map(f) | from_entries;
def reverse: [.[length - 1 - range(0;length)]];
def indices($i): if type == "array" and ($i|type) == "array" then .[$i]
  elif type == "array" then .[[$i]]
  elif type == "string" and ($i|type) == "string" then _strindices($i)
  else .[$i] end;
def index($i):   indices($i) | .[0];       # TODO: optimize
def rindex($i):  indices($i) | .[-1:][0];  # TODO: optimize
def paths: path(recurse(if (type|. == "array" or . == "object") then .[] else empty end))|select(length > 0);
def paths(node_filter): . as $dot|paths|select(. as $p|$dot|getpath($p)|node_filter);
def isfinite: type == "number" and (isinfinite | not);
def arrays: select(type == "array");
def objects: select(type == "object");
def iterables: select(type|. == "array" or . == "object");
def booleans: select(type == "boolean");
def numbers: select(type == "number");
def normals: select(isnormal);
def finites: select(isfinite);
def strings: select(type == "string");
def nulls: select(. == null);
def values: select(. != null);
def scalars: select(type|. != "array" and . != "object");
def leaf_paths: paths(scalars);
def join($x): reduce .[] as $i (null;
            (if .==null then "" else .+$x end) +
            ($i | if type=="boolean" or type=="number" then tostring else .//"" end)
        ) // "";
def _flatten($x): reduce .[] as $i ([]; if $i | type == "array" and $x != 0 then . + ($i | _flatten($x-1)) else . + [$i] end);
def flatten($x): if $x < 0 then error("flatten depth must not be negative") else _flatten($x) end;
def flatten: _flatten(-1);
def range($x): range(0;$x);
def fromdateiso8601: strptime("%Y-%m-%dT%H:%M:%SZ")|mktime;
def todateiso8601: strftime("%Y-%m-%dT%H:%M:%SZ");
def fromdate: fromdateiso8601;
def todate: todateiso8601;
def match(re; mode): _match_impl(re; mode; false)|.[];
def match($val): ($val|type) as $vt | if $vt == "string" then match($val; null)
   elif $vt == "array" and ($val | length) > 1 then match($val[0]; $val[1])
   elif $vt == "array" and ($val | length) > 0 then match($val[0]; null)
   else error( $vt + " not a string or array") end;
def test(re; mode): _match_impl(re; mode; true);
def test($val): ($val|type) as $vt | if $vt == "string" then test($val; null)
   elif $vt == "array" and ($val | length) > 1 then test($val[0]; $val[1])
   elif $vt == "array" and ($val | length) > 0 then test($val[0]; null)
   else error( $vt + " not a string or array") end;
def capture(re; mods): match(re; mods) | reduce ( .captures | .[] | select(.name != null) | { (.name) : .string } ) as $pair ({}; . + $pair);
def capture($val): ($val|type) as $vt | if $vt == "string" then capture($val; null)
   elif $vt == "array" and ($val | length) > 1 then capture($val[0]; $val[1])
   elif $vt == "array" and ($val | length) > 0 then capture($val[0]; null)
   else error( $vt + " not a string or array") end;
def scan(re):
  match(re; "g")
  |  if (.captures|length > 0)
      then [ .captures | .[] | .string ]
      else .string
      end ;
#
# If input is an array, then emit a stream of successive subarrays of length n (or less),
# and similarly for strings.
def _nwise(a; $n): if a|length <= $n then a else a[0:$n] , _nwise(a[$n:]; $n) end;
def _nwise($n): _nwise(.; $n);
#
# splits/1 produces a stream; split/1 is retained for backward compatibility.
def splits($re; flags): . as $s
#  # multiple occurrences of "g" are acceptable
  | [ match($re; "g" + flags) | (.offset, .offset + .length) ]
  | [0] + . +[$s|length]
  | _nwise(2)
  | $s[.[0]:.[1] ] ;
def splits($re): splits($re; null);
#
# split emits an array for backward compatibility
def split($re; flags): [ splits($re; flags) ];
#
# If s contains capture variables, then create a capture object and pipe it to s
def sub($re; s):
  . as $in
  | [match($re)]
  | if length == 0 then $in
    else .[0]
    | . as $r
#  # create the "capture" object:
    | reduce ( $r | .captures | .[] | select(.name != null) | { (.name) : .string } ) as $pair
        ({}; . + $pair)
    | $in[0:$r.offset] + s + $in[$r.offset+$r.length:]
    end ;
#
# If s contains capture variables, then create a capture object and pipe it to s
def sub($re; s; flags):
  def subg: [explode[] | select(. != 103)] | implode;
  # "fla" should be flags with all occurrences of g removed; gs should be non-nil if flags has a g
  def sub1(fla; gs):
    def mysub:
      . as $in
      | [match($re; fla)]
      | if length == 0 then $in
        else .[0] as $edit
        | ($edit | .offset + .length) as $len
        # create the "capture" object:
        | reduce ( $edit | .captures | .[] | select(.name != null) | { (.name) : .string } ) as $pair
            ({}; . + $pair)
        | $in[0:$edit.offset]
          + s
          + ($in[$len:] | if length > 0 and gs then mysub else . end)
        end ;
    mysub ;
    (flags | index("g")) as $gs
    | (flags | if $gs then subg else . end) as $fla
    | sub1($fla; $gs);
#
def sub($re; s): sub($re; s; "");
# repeated substitution of re (which may contain named captures)
def gsub($re; s; flags): sub($re; s; flags + "g");
def gsub($re; s): sub($re; s; "g");

########################################################################
# generic iterator/generator
def while(cond; update):
     def _while:
         if cond then ., (update | _while) else empty end;
     _while;
def until(cond; next):
     def _until:
         if cond then . else (next|_until) end;
     _until;
def limit($n; exp):
    if $n > 0 then label $out | foreach exp as $item ($n; .-1; $item, if . <= 0 then break $out else empty end)
    elif $n == 0 then empty
    else exp end;
# range/3, with a \`by\` expression argument
def range($init; $upto; $by):
    if $by > 0 then $init|while(. < $upto; . + $by)
  elif $by < 0 then $init|while(. > $upto; . + $by)
  else empty end;
def first(g): label $out | g | ., break $out;
def isempty(g): first((g|false), true);
def all(generator; condition): isempty(generator|condition and empty);
def any(generator; condition): isempty(generator|condition or empty)|not;
def all(condition): all(.[]; condition);
def any(condition): any(.[]; condition);
def all: all(.[]; .);
def any: any(.[]; .);
def last(g): reduce g as $item (null; $item);
def nth($n; g): if $n < 0 then error("nth doesn't support negative indices") else last(limit($n + 1; g)) end;
def first: .[0];
def last: .[-1];
def nth($n): .[$n];
def combinations:
    if length == 0 then [] else
        .[0][] as $x
          | (.[1:] | combinations) as $y
          | [$x] + $y
    end;
def combinations(n):
    . as $dot
      | [range(n) | $dot]
      | combinations;
# transpose a possibly jagged matrix, quickly;
# rows are padded with nulls so the result is always rectangular.
def transpose:
  if . == [] then []
  else . as $in
  | (map(length) | max) as $max
  | length as $length
  | reduce range(0; $max) as $j
      ([]; . + [reduce range(0;$length) as $i ([]; . + [ $in[$i][$j] ] )] )
  end;
def in(xs): . as $x | xs | has($x);
def inside(xs): . as $x | xs | contains($x);
def repeat(exp):
     def _repeat:
         exp, _repeat;
     _repeat;
def inputs: try repeat(input) catch if .=="break" then empty else error end;
# like ruby's downcase - only characters A to Z are affected
def ascii_downcase:
  explode | map( if 65 <= . and . <= 90 then . + 32  else . end) | implode;
# like ruby's upcase - only characters a to z are affected
def ascii_upcase:
  explode | map( if 97 <= . and . <= 122 then . - 32  else . end) | implode;

# Streaming utilities
def truncate_stream(stream):
  . as $n | null | stream | . as $input | if (.[0]|length) > $n then setpath([0];$input[0][$n:]) else empty end;
def fromstream(i): {x: null, e: false} as $init |
  # .x = object being built; .e = emit and reset state
  foreach i as $i ($init
  ; if .e then $init else . end
  | if $i|length == 2
    then setpath(["e"]; $i[0]|length==0) | setpath(["x"]+$i[0]; $i[1])
    else setpath(["e"]; $i[0]|length==1) end
  ; if .e then .x else empty end);
def tostream:
  path(def r: (.[]?|r), .; r) as $p |
  getpath($p) |
  reduce path(.[]?) as $q ([$p, .]; [$p+$q]);


# Assuming the input array is sorted, bsearch/1 returns
# the index of the target if the target is in the input array; and otherwise
#  (-1 - ix), where ix is the insertion point that would leave the array sorted.
# If the input is not sorted, bsearch will terminate but with irrelevant results.
def bsearch($target):
  if length == 0 then -1
  elif length == 1 then
     if $target == .[0] then 0 elif $target < .[0] then -1 else -2 end
  else . as $in
    # state variable: [start, end, answer]
    # where start and end are the upper and lower offsets to use.
    | [0, length-1, null]
    | until( .[0] > .[1] ;
             if .[2] != null then (.[1] = -1)               # i.e. break
             else
               ( ( (.[1] + .[0]) / 2 ) | floor ) as $mid
               | $in[$mid] as $monkey
               | if $monkey == $target  then (.[2] = $mid)   # success
                 elif .[0] == .[1]     then (.[1] = -1)     # failure
                 elif $monkey < $target then (.[0] = ($mid + 1))
                 else (.[1] = ($mid - 1))
                 end
             end )
    | if .[2] == null then          # compute the insertion point
         if $in[ .[0] ] < $target then (-2 -.[0])
         else (-1 -.[0])
         end
      else .[2]
      end
  end;

# Apply f to composite entities recursively, and to atoms
def walk(f):
  . as $in
  | if type == "object" then
      reduce keys_unsorted[] as $key
        ( {}; . + { ($key):  ($in[$key] | walk(f)) } ) | f
  elif type == "array" then map( walk(f) ) | f
  else f
  end;

# SQL-ish operators here:
def INDEX(stream; idx_expr):
  reduce stream as $row ({}; .[$row|idx_expr|tostring] = $row);
def INDEX(idx_expr): INDEX(.[]; idx_expr);
def JOIN($idx; idx_expr):
  [.[] | [., $idx[idx_expr]]];
def JOIN($idx; stream; idx_expr):
  stream | [., $idx[idx_expr]];
def JOIN($idx; stream; idx_expr; join_expr):
  stream | [., $idx[idx_expr]] | join_expr;
def IN(s): any(s == .; .);
def IN(src; s): any(src == s; .);
`)});var Tr=E(Mt=>{"use strict";Object.defineProperty(Mt,"__esModule",{value:!0});Mt.evaluate=void 0;var Re=ms(),m=Q(),ia=ys(),We=jr(),Ae=K(),Es=bs(),_s=ws(),oa=ge(),aa=Pr(),qr=Ke(),ks=xs(),la=Er(),L=kr(),ua=_r();function ca(t){let e=(0,m.isAtom)(t)?` "${t}"`:"";return new Ae.JqEvaluateError(`${(0,m.typeOf)(t)}${e} is not iterable`)}function Is(){return new Ae.JqEvaluateError("Array slice indices must be numbers")}var Le=class extends Ae.JqEvaluateError{constructor(e){super(`Label ${e} is not defined`),this.value=e}};function*pa(t,e){let r=new Ar;yield*(0,m.generateValues)(r.evaluate(t.expr,(0,m.generateItems)(e)))}Mt.evaluate=pa;var Ar=class t{constructor(e=null){this.parent=e,this.vars=Object.create(this.parent?this.parent.vars:null)}extend(){return new t(this)}getVar(e){if(e in this.vars)return this.vars[e];if(e in ks.builtinJqFilters)return{scope:null,value:ks.builtinJqFilters[e]};if(e in _s.builtinNativeFilters)return{scope:null,value:_s.builtinNativeFilters[e]};throw(0,qr.notDefinedError)(e)}setVar(e,r,n=this){this.vars[e]={scope:n,value:r}}getVarValue(e){return this.getVar(e).value}evaluateConditions(e,r){return Array.from(this.evaluate(e,r)).map(n=>(0,m.isTrue)(n.value))}*evaluateForeach(e,r,n=!1){for(let s of r){let i=!0,o=[];for(let g of this.evaluate(e.init,(0,m.single)(s))){let _=g,a=i?this.evaluate(e.expr,(0,m.single)(s)):o;for(let l of a){let u=this.extend();u.setVar(e.var,l.value);let f=!0;for(let b of u.evaluate(e.update,(0,m.single)(_)))f=!1,_=b,n||(e.extract?yield*u.evaluate(e.extract,(0,m.single)(b)):yield b);f&&(_=(0,m.createItem)(null)),i&&o.push(l)}i=!1,n&&(yield _)}}}*evaluate(e,r){var n,s,i,o;if(e===void 0){yield*r;return}switch(e.type){case"identity":yield*r;break;case"binary":if(e.type==="binary"&&e.operator==="|"){yield*this.evaluate(e.right,this.evaluate(e.left,r));break}for(let a of r){let l=this.evaluate(e.left,(0,m.single)(a)),u=this.evaluate(e.right,(0,m.single)(a));if((0,L.isBinaryOperatorType)(e.operator,L.BinaryOperatorType.comma))yield*l,yield*u;else if((0,L.isBinaryOperatorType)(e.operator,L.BinaryOperatorType.normal))yield*(0,Re.evaluateNormalBinaryOperator)(e.operator,l,u);else if((0,L.isBinaryOperatorType)(e.operator,L.BinaryOperatorType.boolean))yield*(0,Re.evaluateBooleanOperator)(e.operator,l,u);else if((0,L.isBinaryOperatorType)(e.operator,L.BinaryOperatorType.alternative))yield*(0,Re.evaluateAlternativeOperator)(l,u);else if((0,L.isBinaryOperatorType)(e.operator,L.BinaryOperatorType.assignment))if(e.operator==="|="){let f=a.value;for(let b of(0,m.generatePaths)(l)){let w;for(let v of this.evaluate(e.right,(0,m.single)((0,m.createItem)((0,ua.getPath)(a.value,b))))){w=(0,m.deepClone)(v.value);break}f=(0,la.setPath)(f,b,w)}yield(0,m.createItem)(f)}else e.operator==="="?yield*(0,Re.evaluateSimpleAssignment)(a,l,u):yield*(0,Re.evaluateArithmeticUpdateAssignment)(e.operator,a,l,u);else throw new Ae.JqEvaluateError(`Unexpected operator ${e.operator}`)}break;case"def":{let a=this.extend();a.setVar(e.name,e),yield*a.evaluate(e.next,r);break}case"str":for(let a of r)if(e.interpolated){let l=e.parts.map(u=>typeof u=="string"?[u]:Array.from(this.evaluate(u,(0,m.single)(a))).map(f=>(0,Es.applyFormat)(e.format,(0,m.toString)(f.value)))).reverse();for(let u of(0,We.generateCombinations)(l))yield(0,m.createItem)(u.reverse().join(""))}else yield(0,m.createItem)(e.value);break;case"num":case"bool":case"null":for(let a of r)yield(0,m.createItem)(e.value);break;case"format":for(let a of r)yield(0,m.createItem)((0,Es.applyFormat)(e,(0,m.toString)(a.value)));break;case"filter":for(let a of r){let l=oa.Parser.getFilterArity(e.name),u=this.getVar(e.name);if((0,aa.isNativeFilter)(u.value)){let f=[];for(let b=0;b<l;b++){let w=e.args[b];f.push(Array.from(this.evaluate(w,(0,m.single)((0,m.createItem)(a.value)))))}for(let b of(0,We.generateCombinations)(f))yield*u.value(a,...b)}else{let f=[];for(let b=0;b<l;b++){let w=u.value.args[b],v=e.args[b];switch(w.type){case"varArg":f.push((0,m.collectValues)(this.evaluate(v,(0,m.single)(a))));break;case"filterArg":let P={type:"def",name:w.name,args:[],body:v};f.push([P]);break}}for(let b of(0,We.generateCombinations)(f)){let w=(s=(n=u.scope)===null||n===void 0?void 0:n.extend())!==null&&s!==void 0?s:new t;for(let v=0;v<l;v++){let P=u.value.args[v];w.setVar(P.name,b[v],this)}yield*w.evaluate(u.value.body,(0,m.single)(a))}}}break;case"if":for(let a of r){let l=[this.evaluateConditions(e.cond,(0,m.single)(a))],u=[e.then];if(l[0].includes(!1)&&e.elifs){for(let v of e.elifs)if(l.push(this.evaluateConditions(v.cond,(0,m.single)(a))),u.push(v.then),!l[l.length-1].includes(!1))break}e.else&&u.push(e.else);let f=[],b=v=>u[v]?(f[v]||(f[v]=Array.from(this.evaluate(u[v],(0,m.single)(a)))),f[v]):[];function*w(v){if(l[v])for(let P of l[v])P?yield*b(v):yield*w(v+1);else yield*b(v)}yield*w(0)}break;case"try":for(let a of r)try{for(let l of this.evaluate(e.body,(0,m.single)(a)))yield l}catch(l){if(l instanceof Le)throw l;e.catch&&(yield*this.evaluate(e.catch,(0,m.single)((0,m.createItem)(l.message))))}break;case"reduce":yield*this.evaluateForeach(Object.assign(Object.assign({},e),{type:"foreach"}),r,!0);break;case"var":for(let a of r)yield(0,m.createItem)(this.getVarValue(e.name));break;case"varDeclaration":for(let a of r)for(let l of this.evaluate(e.expr,(0,m.single)(a))){let u=new Set(t.extractVariableNames(e.destructuring));for(let f=0;f<e.destructuring.length;f++){let b=e.destructuring[f];try{for(let w of this.destructureValue(l.value,b)){let v=this.extend();for(let P of u)v.setVar(P,null);for(let[P,Z]of Object.entries(w))v.setVar(P,Z);yield*v.evaluate(e.next,(0,m.single)(a))}break}catch(w){if(f+1>=e.destructuring.length)throw w}}}break;case"foreach":yield*this.evaluateForeach(e,r);break;case"label":try{yield*this.evaluate(e.next,r)}catch(a){if(a instanceof Le){if(a.value!==e.value)throw a;break}else throw a}break;case"break":throw new Le(e.value);case"unary":let{operator:g,type:_}=e;if(e.operator==="-"){for(let a of r)for(let l of this.evaluate(e.expr,(0,m.single)(a)))yield(0,m.createItem)(-l.value);break}throw(0,qr.notImplementedError)(`${_}:${g}`);case"index":for(let a of r)for(let l of this.evaluate(e.expr,(0,m.single)(a)))if(typeof e.index=="string")yield(0,m.createItem)((0,m.access)(l.value,e.index),[...l.path,e.index]);else for(let u of this.evaluate(e.index,(0,m.single)(a)))yield(0,m.createItem)((0,m.access)(l.value,u.value),[...l.path,u.value]);break;case"slice":for(let a of r){let l=e.from?Array.from(this.evaluate(e.from,(0,m.single)(a))):[void 0],u=e.to?Array.from(this.evaluate(e.to,(0,m.single)(a))):[void 0];for(let f of this.evaluate(e.expr,(0,m.single)(a))){if(!(0,m.typeIsOneOf)(f.value,m.Type.array,m.Type.string,m.Type.null))throw(0,qr.cannotSliceError)(f.value);for(let b of l){if(b!==void 0&&(0,m.typeOf)(b.value)!==m.Type.number)throw Is();for(let w of u){if(w!==void 0&&(0,m.typeOf)(w.value)!==m.Type.number)throw Is();let v=(0,m.createSliceAccessor)((i=b?.value)!==null&&i!==void 0?i:null,(o=w?.value)!==null&&o!==void 0?o:null);yield(0,m.createItem)((0,m.access)(f.value,v),[...f.path,v])}}}}break;case"iterator":for(let a of r)for(let l of this.evaluate(e.expr,(0,m.single)(a)))switch((0,m.typeOf)(l.value)){case"array":for(let u=0;u<l.value.length;u++)yield(0,m.createItem)(l.value[u],[...l.path,u]);break;case"object":for(let[u,f]of Object.entries(l.value))yield(0,m.createItem)(f,[...l.path,u]);break;default:throw ca(l.value)}break;case"array":for(let a of r)e.expr?yield(0,m.createItem)((0,m.collectValues)(this.evaluate(e.expr,(0,m.single)(a)))):yield(0,m.createItem)([]);break;case"object":for(let a of r)yield*(0,m.generateItems)((0,ia.generateObjects)(e.entries.map(({key:l,value:u})=>[typeof l=="string"?[l]:(0,m.collectValues)(this.evaluate(l,(0,m.single)(a))),u===void 0?[a.value[l]]:(0,m.collectValues)(this.evaluate(u,(0,m.single)(a)))])));break;case"recursiveDescent":for(let a of r)yield*(0,m.generateItems)((0,m.recursiveDescent)(a.value));break}}static*extractVariableNames(e){for(let r of e)switch(r.type){case"var":yield r.name;break;case"arrayDestructuring":{for(let n of r.destructuring)yield*t.extractVariableNames([n]);break}case"objectDestructuring":for(let n of r.entries)n.destructuring?yield*t.extractVariableNames([n.destructuring]):yield n.key.name;break}}*destructureValue(e,r){switch(r.type){case"var":yield{[r.name]:e};break;case"arrayDestructuring":{if((0,m.typeOf)(e)!=="array")throw new Ae.JqEvaluateError(`${(0,m.typeOf)(e)} cannot be destructured as an array`);let s=r.destructuring.map((i,o)=>Array.from(this.destructureValue(e[o],r.destructuring[o])));for(let i of(0,We.generateCombinations)(s))yield Object.assign({},...i);break}case"objectDestructuring":if((0,m.typeOf)(e)!=="object")throw new Ae.JqEvaluateError(`${(0,m.typeOf)(e)} cannot be destructured as an object`);let n=r.entries.map(s=>{if(s.destructuring)return typeof s.key=="string"?Array.from(this.destructureValue(e[s.key],s.destructuring)):(0,m.collectValues)(this.evaluate(s.key,(0,m.single)((0,m.createItem)(e)))).map(o=>Array.from(this.destructureValue(e[o],s.destructuring))).flat();{let i=s.key.name,o=s.key.name.substring(1),g=e[o];return[{[i]:g}]}});for(let s of(0,We.generateCombinations)(n))yield Object.assign({},...s.reverse());break}}}});var Os=E(Bt=>{"use strict";Object.defineProperty(Bt,"__esModule",{value:!0});Bt.jqTemplateTag=void 0;var fa=ge(),ha=Tr();function da(t){let e=t.join(""),r=(0,fa.parse)(e);return n=>(0,ha.evaluate)(r,n)}Bt.jqTemplateTag=da});var Sr=E(M=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0});M.jq=M.evaluate=M.print=M.parse=M.format=void 0;var js=(Gt(),Mr(Zt));js.__exportStar(Kn(),M);js.__exportStar(K(),M);var ma=Wn();Object.defineProperty(M,"format",{enumerable:!0,get:function(){return ma.format}});var ya=ge();Object.defineProperty(M,"parse",{enumerable:!0,get:function(){return ya.parse}});var ga=br();Object.defineProperty(M,"print",{enumerable:!0,get:function(){return ga.print}});var ba=Tr();Object.defineProperty(M,"evaluate",{enumerable:!0,get:function(){return ba.evaluate}});var va=Os();Object.defineProperty(M,"jq",{enumerable:!0,get:function(){return va.jqTemplateTag}})});var Ps=E(Jt=>{"use strict";Object.defineProperty(Jt,"__esModule",{value:!0});Jt.builtinNativeFilters=void 0;var j=G(),wa=fr(),p=Fe(),Vt=lt(),$a=Sr();Jt.builtinNativeFilters=Object.assign({*"path/1"(t,e){yield(0,j.createItem)(e.path)}},(0,wa.wrapBareNativeFilters)({*"_group_by_impl/1"(t,e){let r=t.map((o,g)=>({value:o,ref:e[g]})).sort((o,g)=>(0,Vt.compare)(o.ref,g.ref)),n=-1,s=[],i=[];for(let o of r)(n===-1||(0,Vt.compare)(s[n],o.ref))&&(s.push(o.ref),i.push([]),n++),i[n].push(o.value);yield i},*"_match_impl/3"(t,e,r,n){let s=(0,j.assertString)(t),i=new RegExp(e,(r??"")+"d");if(r&&r.includes("g")){let o=Array.from(s.matchAll(i));n?yield o.length!==0:yield o.map(j.transformRegExpMatch)}else{let o=s.match(i);n?yield!!o:o&&(yield[(0,j.transformRegExpMatch)(o)])}},*"_max_by_impl/1"(){throw(0,p.notImplementedError)("_max_by_impl/1")},*"_min_by_impl/1"(){throw(0,p.notImplementedError)("_min_by_impl/1")},*"_sort_by_impl/1"(t,e){yield t.map((r,n)=>({item:r,ref:e[n]})).sort(Vt.compare).map(({item:r})=>r)},*"_strindices/1"(t,e){yield(0,j.indices)(t,e)},*"acos/0"(){throw(0,p.notImplementedError)("acos/0")},*"acosh/0"(){throw(0,p.notImplementedError)("acosh/0")},*"asin/0"(){throw(0,p.notImplementedError)("asin/0")},*"asinh/0"(){throw(0,p.notImplementedError)("asinh/0")},*"atan/0"(){throw(0,p.notImplementedError)("atan/0")},*"atan2/2"(){throw(0,p.notImplementedError)("atan2/2")},*"atanh/0"(){throw(0,p.notImplementedError)("atanh/0")},*"builtins/0"(){throw(0,p.notImplementedError)("builtins/0")},*"cbrt/0"(){throw(0,p.notImplementedError)("cbrt/0")},*"ceil/0"(){throw(0,p.notImplementedError)("ceil/0")},*"contains/1"(){throw(0,p.notImplementedError)("contains/1")},*"copysign/2"(){throw(0,p.notImplementedError)("copysign/2")},*"cos/0"(){throw(0,p.notImplementedError)("cos/0")},*"cosh/0"(){throw(0,p.notImplementedError)("cosh/0")},*"debug/0"(){throw(0,p.notImplementedError)("debug/0")},*"delpaths/1"(t,e){if(!(0,j.isPaths)(e))throw new $a.JqArgumentError("Expected an array of paths");yield(0,j.delPaths)(t,e)},*"drem/2"(){throw(0,p.notImplementedError)("drem/2")},*"empty/0"(){},*"endswith/1"(t,e){(0,j.assertString)(t),(0,j.assertString)(e),yield t.endsWith(e)},*"env/0"(){throw(0,p.notImplementedError)("env/0")},*"erf/0"(){throw(0,p.notImplementedError)("erf/0")},*"erfc/0"(){throw(0,p.notImplementedError)("erfc/0")},*"error/0"(){throw(0,p.notImplementedError)("error/0")},*"exp/0"(){throw(0,p.notImplementedError)("exp/0")},*"exp10/0"(){throw(0,p.notImplementedError)("exp10/0")},*"exp2/0"(){throw(0,p.notImplementedError)("exp2/0")},*"explode/0"(){throw(0,p.notImplementedError)("explode/0")},*"expm1/0"(){throw(0,p.notImplementedError)("expm1/0")},*"fabs/0"(){throw(0,p.notImplementedError)("fabs/0")},*"fdim/2"(){throw(0,p.notImplementedError)("fdim/2")},*"floor/0"(){throw(0,p.notImplementedError)("floor/0")},*"fma/3"(){throw(0,p.notImplementedError)("fma/3")},*"fmax/2"(){throw(0,p.notImplementedError)("fmax/2")},*"fmin/2"(){throw(0,p.notImplementedError)("fmin/2")},*"fmod/2"(){throw(0,p.notImplementedError)("fmod/2")},*"format/1"(){throw(0,p.notImplementedError)("format/1")},*"frexp/0"(){throw(0,p.notImplementedError)("frexp/0")},*"fromjson/0"(){throw(0,p.notImplementedError)("fromjson/0")},*"gamma/0"(){throw(0,p.notImplementedError)("gamma/0")},*"get_jq_origin/0"(){throw(0,p.notImplementedError)("get_jq_origin/0")},*"get_prog_origin/0"(){throw(0,p.notImplementedError)("get_prog_origin/0")},*"get_search_list/0"(){throw(0,p.notImplementedError)("get_search_list/0")},*"getpath/1"(){throw(0,p.notImplementedError)("getpath/1")},*"gmtime/0"(){throw(0,p.notImplementedError)("gmtime/0")},*"halt/0"(){throw(0,p.notImplementedError)("halt/0")},*"halt_error/1"(){throw(0,p.notImplementedError)("halt_error/1")},*"has/1"(t,e){yield(0,j.has)(t,e)},*"hypot/2"(){throw(0,p.notImplementedError)("hypot/2")},*"implode/0"(){throw(0,p.notImplementedError)("implode/0")},*"infinite/0"(){throw(0,p.notImplementedError)("infinite/0")},*"input/0"(){throw(0,p.notImplementedError)("input/0")},*"input_filename/0"(){throw(0,p.notImplementedError)("input_filename/0")},*"input_line_number/0"(){throw(0,p.notImplementedError)("input_line_number/0")},*"isinfinite/0"(){throw(0,p.notImplementedError)("isinfinite/0")},*"isnan/0"(){throw(0,p.notImplementedError)("isnan/0")},*"isnormal/0"(){throw(0,p.notImplementedError)("isnormal/0")},*"j0/0"(){throw(0,p.notImplementedError)("j0/0")},*"j1/0"(){throw(0,p.notImplementedError)("j1/0")},*"jn/2"(){throw(0,p.notImplementedError)("jn/2")},*"keys/0"(t){yield(0,j.sort)((0,j.keys)(t))},*"keys_unsorted/0"(t){yield(0,j.keys)(t)},*"ldexp/2"(){throw(0,p.notImplementedError)("ldexp/2")},*"length/0"(t){let e=(0,j.typeOf)(t);switch((0,j.typeOf)(t)){case j.Type.null:yield 0;break;case j.Type.string:case j.Type.array:yield t.length;break;case j.Type.object:yield Object.keys(t).length;break;case j.Type.boolean:case j.Type.number:default:throw Error(`${e} has no length`)}},*"lgamma/0"(){throw(0,p.notImplementedError)("lgamma/0")},*"lgamma_r/0"(){throw(0,p.notImplementedError)("lgamma_r/0")},*"localtime/0"(){throw(0,p.notImplementedError)("localtime/0")},*"log/0"(){throw(0,p.notImplementedError)("log/0")},*"log10/0"(){throw(0,p.notImplementedError)("log10/0")},*"log1p/0"(){throw(0,p.notImplementedError)("log1p/0")},*"log2/0"(){throw(0,p.notImplementedError)("log2/0")},*"logb/0"(){throw(0,p.notImplementedError)("logb/0")},*"ltrimstr/1"(){throw(0,p.notImplementedError)("ltrimstr/1")},*"max/0"(){throw(0,p.notImplementedError)("max/0")},*"min/0"(){throw(0,p.notImplementedError)("min/0")},*"mktime/0"(){throw(0,p.notImplementedError)("mktime/0")},*"modf/0"(){throw(0,p.notImplementedError)("modf/0")},*"modulemeta/0"(){throw(0,p.notImplementedError)("modulemeta/0")},*"nan/0"(){throw(0,p.notImplementedError)("nan/0")},*"nearbyint/0"(){throw(0,p.notImplementedError)("nearbyint/0")},*"nextafter/2"(){throw(0,p.notImplementedError)("nextafter/2")},*"nexttoward/2"(){throw(0,p.notImplementedError)("nexttoward/2")},*"not/0"(t){yield!(0,j.isTrue)(t)},*"now/0"(){throw(0,p.notImplementedError)("now/0")},*"pow/2"(){throw(0,p.notImplementedError)("pow/2")},*"pow10/0"(){throw(0,p.notImplementedError)("pow10/0")},*"range/2"(t,e,r){yield*(0,j.range)(e,r)},*"remainder/2"(){throw(0,p.notImplementedError)("remainder/2")},*"rint/0"(){throw(0,p.notImplementedError)("rint/0")},*"round/0"(t){yield Math.round((0,j.assertNumber)(t))},*"rtrimstr/1"(){throw(0,p.notImplementedError)("rtrimstr/1")},*"scalars_or_empty/0"(){throw(0,p.notImplementedError)("scalars_or_empty/0")},*"scalb/2"(){throw(0,p.notImplementedError)("scalb/2")},*"scalbln/2"(){throw(0,p.notImplementedError)("scalbln/2")},*"setpath/2"(){throw(0,p.notImplementedError)("setpath/2")},*"significand/0"(){throw(0,p.notImplementedError)("significand/0")},*"sin/0"(){throw(0,p.notImplementedError)("sin/0")},*"sinh/0"(){throw(0,p.notImplementedError)("sinh/0")},*"sort/0"(t){yield t.sort(Vt.compare)},*"split/1"(t,e){yield(0,j.assertString)(t).split((0,j.assertString)(e))},*"sqrt/0"(){throw(0,p.notImplementedError)("sqrt/0")},*"startswith/1"(t,e){(0,j.assertString)(t),(0,j.assertString)(e),yield t.startsWith(e)},*"stderr/0"(){throw(0,p.notImplementedError)("stderr/0")},*"strflocaltime/1"(){throw(0,p.notImplementedError)("strflocaltime/1")},*"strftime/1"(){throw(0,p.notImplementedError)("strftime/1")},*"strptime/1"(){throw(0,p.notImplementedError)("strptime/1")},*"tan/0"(){throw(0,p.notImplementedError)("tan/0")},*"tanh/0"(){throw(0,p.notImplementedError)("tanh/0")},*"tgamma/0"(){throw(0,p.notImplementedError)("tgamma/0")},*"tojson/0"(){throw(0,p.notImplementedError)("tojson/0")},*"tonumber/0"(){throw(0,p.notImplementedError)("tonumber/0")},*"tostring/0"(t){yield(0,j.toString)(t)},*"trunc/0"(){throw(0,p.notImplementedError)("trunc/0")},*"type/0"(t){yield(0,j.typeOf)(t)},*"utf8bytelength/0"(){throw(0,p.notImplementedError)("utf8bytelength/0")},*"y0/0"(){throw(0,p.notImplementedError)("y0/0")},*"y1/0"(){throw(0,p.notImplementedError)("y1/0")},*"yn/2"(){throw(0,p.notImplementedError)("yn/2")}}))});var Ss=E(Kt=>{"use strict";Object.defineProperty(Kt,"__esModule",{value:!0});Kt.parseBuiltinJqFilters=void 0;var xa=ce(),Ea=V();function _a(t){let e={},r=(0,xa.parse)(t).expr;for(;r;){if(r.type!=="def")throw new Ea.JqEvaluateError("Could not parse the built-in jq filters");e[r.name]=r,r=r.next}return e}Kt.parseBuiltinJqFilters=_a});var qs=E(zt=>{"use strict";Object.defineProperty(zt,"__esModule",{value:!0});zt.builtinJqFilters=void 0;var ka=Ss();zt.builtinJqFilters=(0,ka.parseBuiltinJqFilters)(`
def halt_error: halt_error(5);
def error(msg): msg|error;
def map(f): [.[] | f];
def select(f): if f then . else empty end;
def sort_by(f): _sort_by_impl(map([f]));
def group_by(f): _group_by_impl(map([f]));
def unique: group_by(.) | map(.[0]);
def unique_by(f): group_by(f) | map(.[0]);
def max_by(f): _max_by_impl(map([f]));
def min_by(f): _min_by_impl(map([f]));
def add: reduce .[] as $x (null; . + $x);
def del(f): delpaths([path(f)]);
def _assign(paths; $value): reduce path(paths) as $p (.; setpath($p; $value));
def _modify(paths; update):
    reduce path(paths) as $p (.;
        . as $dot
      | null
      | label $out
      | ($dot | getpath($p)) as $v
      | (
          (   $v
            | update
            | (., break $out) as $v
            | $dot
            | setpath($p; $v)
          ),
          (
              $dot
            | delpaths([$p])
          )
        )
    );
def map_values(f): .[] |= f;

# recurse
def recurse(f): def r: ., (f | r); r;
def recurse(f; cond): def r: ., (f | select(cond) | r); r;
def recurse: recurse(.[]?);
def recurse_down: recurse;

def to_entries: [keys_unsorted[] as $k | {key: $k, value: .[$k]}];
def from_entries: map({(.key // .Key // .name // .Name): (if has("value") then .value else .Value end)}) | add | .//={};
def with_entries(f): to_entries | map(f) | from_entries;
def reverse: [.[length - 1 - range(0;length)]];
def indices($i): if type == "array" and ($i|type) == "array" then .[$i]
  elif type == "array" then .[[$i]]
  elif type == "string" and ($i|type) == "string" then _strindices($i)
  else .[$i] end;
def index($i):   indices($i) | .[0];       # TODO: optimize
def rindex($i):  indices($i) | .[-1:][0];  # TODO: optimize
def paths: path(recurse(if (type|. == "array" or . == "object") then .[] else empty end))|select(length > 0);
def paths(node_filter): . as $dot|paths|select(. as $p|$dot|getpath($p)|node_filter);
def isfinite: type == "number" and (isinfinite | not);
def arrays: select(type == "array");
def objects: select(type == "object");
def iterables: select(type|. == "array" or . == "object");
def booleans: select(type == "boolean");
def numbers: select(type == "number");
def normals: select(isnormal);
def finites: select(isfinite);
def strings: select(type == "string");
def nulls: select(. == null);
def values: select(. != null);
def scalars: select(type|. != "array" and . != "object");
def leaf_paths: paths(scalars);
def join($x): reduce .[] as $i (null;
            (if .==null then "" else .+$x end) +
            ($i | if type=="boolean" or type=="number" then tostring else .//"" end)
        ) // "";
def _flatten($x): reduce .[] as $i ([]; if $i | type == "array" and $x != 0 then . + ($i | _flatten($x-1)) else . + [$i] end);
def flatten($x): if $x < 0 then error("flatten depth must not be negative") else _flatten($x) end;
def flatten: _flatten(-1);
def range($x): range(0;$x);
def fromdateiso8601: strptime("%Y-%m-%dT%H:%M:%SZ")|mktime;
def todateiso8601: strftime("%Y-%m-%dT%H:%M:%SZ");
def fromdate: fromdateiso8601;
def todate: todateiso8601;
def match(re; mode): _match_impl(re; mode; false)|.[];
def match($val): ($val|type) as $vt | if $vt == "string" then match($val; null)
   elif $vt == "array" and ($val | length) > 1 then match($val[0]; $val[1])
   elif $vt == "array" and ($val | length) > 0 then match($val[0]; null)
   else error( $vt + " not a string or array") end;
def test(re; mode): _match_impl(re; mode; true);
def test($val): ($val|type) as $vt | if $vt == "string" then test($val; null)
   elif $vt == "array" and ($val | length) > 1 then test($val[0]; $val[1])
   elif $vt == "array" and ($val | length) > 0 then test($val[0]; null)
   else error( $vt + " not a string or array") end;
def capture(re; mods): match(re; mods) | reduce ( .captures | .[] | select(.name != null) | { (.name) : .string } ) as $pair ({}; . + $pair);
def capture($val): ($val|type) as $vt | if $vt == "string" then capture($val; null)
   elif $vt == "array" and ($val | length) > 1 then capture($val[0]; $val[1])
   elif $vt == "array" and ($val | length) > 0 then capture($val[0]; null)
   else error( $vt + " not a string or array") end;
def scan(re):
  match(re; "g")
  |  if (.captures|length > 0)
      then [ .captures | .[] | .string ]
      else .string
      end ;
#
# If input is an array, then emit a stream of successive subarrays of length n (or less),
# and similarly for strings.
def _nwise(a; $n): if a|length <= $n then a else a[0:$n] , _nwise(a[$n:]; $n) end;
def _nwise($n): _nwise(.; $n);
#
# splits/1 produces a stream; split/1 is retained for backward compatibility.
def splits($re; flags): . as $s
#  # multiple occurrences of "g" are acceptable
  | [ match($re; "g" + flags) | (.offset, .offset + .length) ]
  | [0] + . +[$s|length]
  | _nwise(2)
  | $s[.[0]:.[1] ] ;
def splits($re): splits($re; null);
#
# split emits an array for backward compatibility
def split($re; flags): [ splits($re; flags) ];
#
# If s contains capture variables, then create a capture object and pipe it to s
def sub($re; s):
  . as $in
  | [match($re)]
  | if length == 0 then $in
    else .[0]
    | . as $r
#  # create the "capture" object:
    | reduce ( $r | .captures | .[] | select(.name != null) | { (.name) : .string } ) as $pair
        ({}; . + $pair)
    | $in[0:$r.offset] + s + $in[$r.offset+$r.length:]
    end ;
#
# If s contains capture variables, then create a capture object and pipe it to s
def sub($re; s; flags):
  def subg: [explode[] | select(. != 103)] | implode;
  # "fla" should be flags with all occurrences of g removed; gs should be non-nil if flags has a g
  def sub1(fla; gs):
    def mysub:
      . as $in
      | [match($re; fla)]
      | if length == 0 then $in
        else .[0] as $edit
        | ($edit | .offset + .length) as $len
        # create the "capture" object:
        | reduce ( $edit | .captures | .[] | select(.name != null) | { (.name) : .string } ) as $pair
            ({}; . + $pair)
        | $in[0:$edit.offset]
          + s
          + ($in[$len:] | if length > 0 and gs then mysub else . end)
        end ;
    mysub ;
    (flags | index("g")) as $gs
    | (flags | if $gs then subg else . end) as $fla
    | sub1($fla; $gs);
#
def sub($re; s): sub($re; s; "");
# repeated substitution of re (which may contain named captures)
def gsub($re; s; flags): sub($re; s; flags + "g");
def gsub($re; s): sub($re; s; "g");

########################################################################
# generic iterator/generator
def while(cond; update):
     def _while:
         if cond then ., (update | _while) else empty end;
     _while;
def until(cond; next):
     def _until:
         if cond then . else (next|_until) end;
     _until;
def limit($n; exp):
    if $n > 0 then label $out | foreach exp as $item ($n; .-1; $item, if . <= 0 then break $out else empty end)
    elif $n == 0 then empty
    else exp end;
# range/3, with a \`by\` expression argument
def range($init; $upto; $by):
    if $by > 0 then $init|while(. < $upto; . + $by)
  elif $by < 0 then $init|while(. > $upto; . + $by)
  else empty end;
def first(g): label $out | g | ., break $out;
def isempty(g): first((g|false), true);
def all(generator; condition): isempty(generator|condition and empty);
def any(generator; condition): isempty(generator|condition or empty)|not;
def all(condition): all(.[]; condition);
def any(condition): any(.[]; condition);
def all: all(.[]; .);
def any: any(.[]; .);
def last(g): reduce g as $item (null; $item);
def nth($n; g): if $n < 0 then error("nth doesn't support negative indices") else last(limit($n + 1; g)) end;
def first: .[0];
def last: .[-1];
def nth($n): .[$n];
def combinations:
    if length == 0 then [] else
        .[0][] as $x
          | (.[1:] | combinations) as $y
          | [$x] + $y
    end;
def combinations(n):
    . as $dot
      | [range(n) | $dot]
      | combinations;
# transpose a possibly jagged matrix, quickly;
# rows are padded with nulls so the result is always rectangular.
def transpose:
  if . == [] then []
  else . as $in
  | (map(length) | max) as $max
  | length as $length
  | reduce range(0; $max) as $j
      ([]; . + [reduce range(0;$length) as $i ([]; . + [ $in[$i][$j] ] )] )
  end;
def in(xs): . as $x | xs | has($x);
def inside(xs): . as $x | xs | contains($x);
def repeat(exp):
     def _repeat:
         exp, _repeat;
     _repeat;
def inputs: try repeat(input) catch if .=="break" then empty else error end;
# like ruby's downcase - only characters A to Z are affected
def ascii_downcase:
  explode | map( if 65 <= . and . <= 90 then . + 32  else . end) | implode;
# like ruby's upcase - only characters a to z are affected
def ascii_upcase:
  explode | map( if 97 <= . and . <= 122 then . - 32  else . end) | implode;

# Streaming utilities
def truncate_stream(stream):
  . as $n | null | stream | . as $input | if (.[0]|length) > $n then setpath([0];$input[0][$n:]) else empty end;
def fromstream(i): {x: null, e: false} as $init |
  # .x = object being built; .e = emit and reset state
  foreach i as $i ($init
  ; if .e then $init else . end
  | if $i|length == 2
    then setpath(["e"]; $i[0]|length==0) | setpath(["x"]+$i[0]; $i[1])
    else setpath(["e"]; $i[0]|length==1) end
  ; if .e then .x else empty end);
def tostream:
  path(def r: (.[]?|r), .; r) as $p |
  getpath($p) |
  reduce path(.[]?) as $q ([$p, .]; [$p+$q]);


# Assuming the input array is sorted, bsearch/1 returns
# the index of the target if the target is in the input array; and otherwise
#  (-1 - ix), where ix is the insertion point that would leave the array sorted.
# If the input is not sorted, bsearch will terminate but with irrelevant results.
def bsearch($target):
  if length == 0 then -1
  elif length == 1 then
     if $target == .[0] then 0 elif $target < .[0] then -1 else -2 end
  else . as $in
    # state variable: [start, end, answer]
    # where start and end are the upper and lower offsets to use.
    | [0, length-1, null]
    | until( .[0] > .[1] ;
             if .[2] != null then (.[1] = -1)               # i.e. break
             else
               ( ( (.[1] + .[0]) / 2 ) | floor ) as $mid
               | $in[$mid] as $monkey
               | if $monkey == $target  then (.[2] = $mid)   # success
                 elif .[0] == .[1]     then (.[1] = -1)     # failure
                 elif $monkey < $target then (.[0] = ($mid + 1))
                 else (.[1] = ($mid - 1))
                 end
             end )
    | if .[2] == null then          # compute the insertion point
         if $in[ .[0] ] < $target then (-2 -.[0])
         else (-1 -.[0])
         end
      else .[2]
      end
  end;

# Apply f to composite entities recursively, and to atoms
def walk(f):
  . as $in
  | if type == "object" then
      reduce keys_unsorted[] as $key
        ( {}; . + { ($key):  ($in[$key] | walk(f)) } ) | f
  elif type == "array" then map( walk(f) ) | f
  else f
  end;

# SQL-ish operators here:
def INDEX(stream; idx_expr):
  reduce stream as $row ({}; .[$row|idx_expr|tostring] = $row);
def INDEX(idx_expr): INDEX(.[]; idx_expr);
def JOIN($idx; idx_expr):
  [.[] | [., $idx[idx_expr]]];
def JOIN($idx; stream; idx_expr):
  stream | [., $idx[idx_expr]];
def JOIN($idx; stream; idx_expr; join_expr):
  stream | [., $idx[idx_expr]] | join_expr;
def IN(s): any(s == .; .);
def IN(src; s): any(src == s; .);
`)});var Dr=E(Rt=>{"use strict";Object.defineProperty(Rt,"__esModule",{value:!0});Rt.evaluate=void 0;var Ue=Dn(),y=G(),Ia=Fn(),Ze=pr(),Te=V(),As=Bn(),Ts=Ps(),Oa=ce(),ja=fr(),Nr=Fe(),Ns=qs(),Pa=or(),U=lr(),Sa=ar();function qa(t){let e=(0,y.isAtom)(t)?` "${t}"`:"";return new Te.JqEvaluateError(`${(0,y.typeOf)(t)}${e} is not iterable`)}function Cs(){return new Te.JqEvaluateError("Array slice indices must be numbers")}var Ge=class extends Te.JqEvaluateError{constructor(e){super(`Label ${e} is not defined`),this.value=e}};function*Aa(t,e){let r=new Cr;yield*(0,y.generateValues)(r.evaluate(t.expr,(0,y.generateItems)(e)))}Rt.evaluate=Aa;var Cr=class t{constructor(e=null){this.parent=e,this.vars=Object.create(this.parent?this.parent.vars:null)}extend(){return new t(this)}getVar(e){if(e in this.vars)return this.vars[e];if(e in Ns.builtinJqFilters)return{scope:null,value:Ns.builtinJqFilters[e]};if(e in Ts.builtinNativeFilters)return{scope:null,value:Ts.builtinNativeFilters[e]};throw(0,Nr.notDefinedError)(e)}setVar(e,r,n=this){this.vars[e]={scope:n,value:r}}getVarValue(e){return this.getVar(e).value}evaluateConditions(e,r){return Array.from(this.evaluate(e,r)).map(n=>(0,y.isTrue)(n.value))}*evaluateForeach(e,r,n=!1){for(let s of r){let i=!0,o=[];for(let g of this.evaluate(e.init,(0,y.single)(s))){let _=g,a=i?this.evaluate(e.expr,(0,y.single)(s)):o;for(let l of a){let u=this.extend();u.setVar(e.var,l.value);let f=!0;for(let b of u.evaluate(e.update,(0,y.single)(_)))f=!1,_=b,n||(e.extract?yield*u.evaluate(e.extract,(0,y.single)(b)):yield b);f&&(_=(0,y.createItem)(null)),i&&o.push(l)}i=!1,n&&(yield _)}}}*evaluate(e,r){var n,s,i,o;if(e===void 0){yield*r;return}switch(e.type){case"identity":yield*r;break;case"binary":if(e.type==="binary"&&e.operator==="|"){yield*this.evaluate(e.right,this.evaluate(e.left,r));break}for(let a of r){let l=this.evaluate(e.left,(0,y.single)(a)),u=this.evaluate(e.right,(0,y.single)(a));if((0,U.isBinaryOperatorType)(e.operator,U.BinaryOperatorType.comma))yield*l,yield*u;else if((0,U.isBinaryOperatorType)(e.operator,U.BinaryOperatorType.normal))yield*(0,Ue.evaluateNormalBinaryOperator)(e.operator,l,u);else if((0,U.isBinaryOperatorType)(e.operator,U.BinaryOperatorType.boolean))yield*(0,Ue.evaluateBooleanOperator)(e.operator,l,u);else if((0,U.isBinaryOperatorType)(e.operator,U.BinaryOperatorType.alternative))yield*(0,Ue.evaluateAlternativeOperator)(l,u);else if((0,U.isBinaryOperatorType)(e.operator,U.BinaryOperatorType.assignment))if(e.operator==="|="){let f=a.value;for(let b of(0,y.generatePaths)(l)){let w;for(let v of this.evaluate(e.right,(0,y.single)((0,y.createItem)((0,Sa.getPath)(a.value,b))))){w=(0,y.deepClone)(v.value);break}f=(0,Pa.setPath)(f,b,w)}yield(0,y.createItem)(f)}else e.operator==="="?yield*(0,Ue.evaluateSimpleAssignment)(a,l,u):yield*(0,Ue.evaluateArithmeticUpdateAssignment)(e.operator,a,l,u);else throw new Te.JqEvaluateError(`Unexpected operator ${e.operator}`)}break;case"def":{let a=this.extend();a.setVar(e.name,e),yield*a.evaluate(e.next,r);break}case"str":for(let a of r)if(e.interpolated){let l=e.parts.map(u=>typeof u=="string"?[u]:Array.from(this.evaluate(u,(0,y.single)(a))).map(f=>(0,As.applyFormat)(e.format,(0,y.toString)(f.value)))).reverse();for(let u of(0,Ze.generateCombinations)(l))yield(0,y.createItem)(u.reverse().join(""))}else yield(0,y.createItem)(e.value);break;case"num":case"bool":case"null":for(let a of r)yield(0,y.createItem)(e.value);break;case"format":for(let a of r)yield(0,y.createItem)((0,As.applyFormat)(e,(0,y.toString)(a.value)));break;case"filter":for(let a of r){let l=Oa.Parser.getFilterArity(e.name),u=this.getVar(e.name);if((0,ja.isNativeFilter)(u.value)){let f=[];for(let b=0;b<l;b++){let w=e.args[b];f.push(Array.from(this.evaluate(w,(0,y.single)(a))))}for(let b of(0,Ze.generateCombinations)(f))yield*u.value(a,...b)}else{let f=[];for(let b=0;b<l;b++){let w=u.value.args[b],v=e.args[b];switch(w.type){case"varArg":f.push((0,y.collectValues)(this.evaluate(v,(0,y.single)(a))));break;case"filterArg":let P={type:"def",name:w.name,args:[],body:v};f.push([P]);break}}for(let b of(0,Ze.generateCombinations)(f)){let w=(s=(n=u.scope)===null||n===void 0?void 0:n.extend())!==null&&s!==void 0?s:new t;for(let v=0;v<l;v++){let P=u.value.args[v];w.setVar(P.name,b[v],this)}yield*w.evaluate(u.value.body,(0,y.single)(a))}}}break;case"if":for(let a of r){let l=[this.evaluateConditions(e.cond,(0,y.single)(a))],u=[e.then];if(l[0].includes(!1)&&e.elifs){for(let v of e.elifs)if(l.push(this.evaluateConditions(v.cond,(0,y.single)(a))),u.push(v.then),!l[l.length-1].includes(!1))break}e.else&&u.push(e.else);let f=[],b=v=>u[v]?(f[v]||(f[v]=Array.from(this.evaluate(u[v],(0,y.single)(a)))),f[v]):[];function*w(v){if(l[v])for(let P of l[v])P?yield*b(v):yield*w(v+1);else yield*b(v)}yield*w(0)}break;case"try":for(let a of r)try{for(let l of this.evaluate(e.body,(0,y.single)(a)))yield l}catch(l){if(l instanceof Ge)throw l;e.catch&&(yield*this.evaluate(e.catch,(0,y.single)((0,y.createItem)(l.message))))}break;case"reduce":yield*this.evaluateForeach(Object.assign(Object.assign({},e),{type:"foreach"}),r,!0);break;case"var":for(let a of r)yield(0,y.createItem)(this.getVarValue(e.name));break;case"varDeclaration":for(let a of r)for(let l of this.evaluate(e.expr,(0,y.single)(a))){let u=new Set(t.extractVariableNames(e.destructuring));for(let f=0;f<e.destructuring.length;f++){let b=e.destructuring[f];try{for(let w of this.destructureValue(l.value,b)){let v=this.extend();for(let P of u)v.setVar(P,null);for(let[P,Z]of Object.entries(w))v.setVar(P,Z);yield*v.evaluate(e.next,(0,y.single)(a))}break}catch(w){if(f+1>=e.destructuring.length)throw w}}}break;case"foreach":yield*this.evaluateForeach(e,r);break;case"label":try{yield*this.evaluate(e.next,r)}catch(a){if(a instanceof Ge){if(a.value!==e.value)throw a;break}else throw a}break;case"break":throw new Ge(e.value);case"unary":let{operator:g,type:_}=e;if(e.operator==="-"){for(let a of r)for(let l of this.evaluate(e.expr,(0,y.single)(a)))yield(0,y.createItem)(-l.value);break}throw(0,Nr.notImplementedError)(`${_}:${g}`);case"index":for(let a of r)for(let l of this.evaluate(e.expr,(0,y.single)(a)))if(typeof e.index=="string")yield(0,y.createItem)((0,y.access)(l.value,e.index),[...l.path,e.index]);else for(let u of this.evaluate(e.index,(0,y.single)(a)))yield(0,y.createItem)((0,y.access)(l.value,u.value),[...l.path,u.value]);break;case"slice":for(let a of r){let l=e.from?Array.from(this.evaluate(e.from,(0,y.single)(a))):[void 0],u=e.to?Array.from(this.evaluate(e.to,(0,y.single)(a))):[void 0];for(let f of this.evaluate(e.expr,(0,y.single)(a))){if(!(0,y.typeIsOneOf)(f.value,y.Type.array,y.Type.string,y.Type.null))throw(0,Nr.cannotSliceError)(f.value);for(let b of l){if(b!==void 0&&(0,y.typeOf)(b.value)!==y.Type.number)throw Cs();for(let w of u){if(w!==void 0&&(0,y.typeOf)(w.value)!==y.Type.number)throw Cs();let v=(0,y.createSliceAccessor)((i=b?.value)!==null&&i!==void 0?i:null,(o=w?.value)!==null&&o!==void 0?o:null);yield(0,y.createItem)((0,y.access)(f.value,v),[...f.path,v])}}}}break;case"iterator":for(let a of r)for(let l of this.evaluate(e.expr,(0,y.single)(a)))switch((0,y.typeOf)(l.value)){case"array":for(let u=0;u<l.value.length;u++)yield(0,y.createItem)(l.value[u],[...l.path,u]);break;case"object":for(let[u,f]of Object.entries(l.value))yield(0,y.createItem)(f,[...l.path,u]);break;default:throw qa(l.value)}break;case"array":for(let a of r)e.expr?yield(0,y.createItem)((0,y.collectValues)(this.evaluate(e.expr,(0,y.single)(a)))):yield(0,y.createItem)([]);break;case"object":for(let a of r)yield*(0,y.generateItems)((0,Ia.generateObjects)(e.entries.map(({key:l,value:u})=>[typeof l=="string"?[l]:(0,y.collectValues)(this.evaluate(l,(0,y.single)(a))),u===void 0?[a.value[l]]:(0,y.collectValues)(this.evaluate(u,(0,y.single)(a)))])));break;case"recursiveDescent":for(let a of r)yield*(0,y.generateItems)((0,y.recursiveDescent)(a.value));break}}static*extractVariableNames(e){for(let r of e)switch(r.type){case"var":yield r.name;break;case"arrayDestructuring":{for(let n of r.destructuring)yield*t.extractVariableNames([n]);break}case"objectDestructuring":for(let n of r.entries)n.destructuring?yield*t.extractVariableNames([n.destructuring]):yield n.key.name;break}}*destructureValue(e,r){switch(r.type){case"var":yield{[r.name]:e};break;case"arrayDestructuring":{if((0,y.typeOf)(e)!=="array")throw new Te.JqEvaluateError(`${(0,y.typeOf)(e)} cannot be destructured as an array`);let s=r.destructuring.map((i,o)=>Array.from(this.destructureValue(e[o],r.destructuring[o])));for(let i of(0,Ze.generateCombinations)(s))yield Object.assign({},...i);break}case"objectDestructuring":if((0,y.typeOf)(e)!=="object")throw new Te.JqEvaluateError(`${(0,y.typeOf)(e)} cannot be destructured as an object`);let n=r.entries.map(s=>{if(s.destructuring)return typeof s.key=="string"?Array.from(this.destructureValue(e[s.key],s.destructuring)):(0,y.collectValues)(this.evaluate(s.key,(0,y.single)((0,y.createItem)(e)))).map(o=>Array.from(this.destructureValue(e[o],s.destructuring))).flat();{let i=s.key.name,o=s.key.name.substring(1),g=e[o];return[{[i]:g}]}});for(let s of(0,Ze.generateCombinations)(n))yield Object.assign({},...s.reverse());break}}}});var Ds=E(Wt=>{"use strict";Object.defineProperty(Wt,"__esModule",{value:!0});Wt.jqTemplateTag=void 0;var Ta=ce(),Na=Dr();function Ca(t){let e=t.join(""),r=(0,Ta.parse)(e);return n=>(0,Na.evaluate)(r,n)}Wt.jqTemplateTag=Ca});var Ms=E(B=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0});B.jq=B.evaluate=B.print=B.parse=B.format=void 0;var Fs=(Gt(),Mr(Zt));Fs.__exportStar(un(),B);Fs.__exportStar(V(),B);var Da=fn();Object.defineProperty(B,"format",{enumerable:!0,get:function(){return Da.format}});var Fa=ce();Object.defineProperty(B,"parse",{enumerable:!0,get:function(){return Fa.parse}});var Ma=tr();Object.defineProperty(B,"print",{enumerable:!0,get:function(){return Ma.print}});var Ba=Dr();Object.defineProperty(B,"evaluate",{enumerable:!0,get:function(){return Ba.evaluate}});var Va=Ds();Object.defineProperty(B,"jq",{enumerable:!0,get:function(){return Va.jqTemplateTag}})});var Ja=Ls(Ms());window.jq=Ja;
